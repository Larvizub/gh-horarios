"use strict";(self.webpackChunkcostaricacc_horarios=self.webpackChunkcostaricacc_horarios||[]).push([[979],{6581:(e,o,a)=>{a.d(o,{A1:()=>t,Kj:()=>s,VF:()=>n,hu:()=>r,yQ:()=>i});const t=["Planeaci\xf3n de Eventos","Gesti\xf3n de la Protecci\xf3n","\xc1reas & Sostenibilidad","Gastronom\xeda","Infraestructura","Financiero","Oficina de Atenci\xf3n al Expositor","Practicantes/Crosstraining","Talento Humano","Calidad","Sistemas","Mercadeo y Ventas","Compras","Gerencia de Operaciones","Gerencia General","UDEI"],r=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"],n=["descanso","vacaciones","feriado","permiso","dia-brigada","fuera-oficina","incapacidad-enfermedad","incapacidad-accidente"],i={dia1:"Lunes",dia2:"Martes",dia3:"Mi\xe9rcoles",dia4:"Jueves",dia5:"Viernes",dia6:"S\xe1bado",dia7:"Domingo"},s={personalizado:"Presencial",teletrabajo:"Teletrabajo",cambio:"Cambio",descanso:"Descanso",vacaciones:"Vacaciones",feriado:"Feriado",permiso:"Permiso","tarde-libre":"Tarde Libre","dia-brigada":"Brigada","fuera-oficina":"Fuera de Oficina","viaje-trabajo":"Viaje de Trabajo","incapacidad-enfermedad":"Incapacidad por Enfermedad","incapacidad-accidente":"Incapacidad por Accidente","tele-presencial":"Teletrabajo & Presencial"}},6984:(e,o,a)=>{a.d(o,{FW:()=>p,MJ:()=>c,MO:()=>u,Nf:()=>s,RK:()=>t,VO:()=>l,bW:()=>i,gg:()=>r,m:()=>m,qK:()=>d});const t={OPERATIVO:"Operativo",CONFIANZA:"Confianza"},r={ADMINISTRADOR:"Administrador",MODIFICADOR:"Modificador",VISOR:"Visor"},n={[t.OPERATIVO]:48,[t.CONFIANZA]:72},i=e=>n[e]||n[t.OPERATIVO],s=e=>{const o=i(e);return"Los empleados de tipo ".concat(e," tienen un l\xedmite de ").concat(o," horas semanales.")},c=e=>"Talento Humano"===(null===e||void 0===e?void 0:e.departamento),d=e=>(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),l=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||((null===e||void 0===e?void 0:e.rol)===r.MODIFICADOR||(null===e||void 0===e?void 0:e.rol)===r.VISOR?!o||(null===e||void 0===e?void 0:e.departamento)===(null===o||void 0===o?void 0:o.departamento):"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email))},p=e=>(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),m=e=>{switch(e){case r.ADMINISTRADOR:return"error";case r.MODIFICADOR:return"warning";case r.VISOR:return"info";default:return"default"}},u=e=>{switch(e){case r.ADMINISTRADOR:return"Puede realizar todos los cambios en la plataforma";case r.MODIFICADOR:return"Puede modificar horarios de su departamento";case r.VISOR:return"Solo puede ver horarios, sin modificaciones";default:return"Sin rol espec\xedfico asignado"}}},9360:(e,o,a)=>{a.r(o),a.d(o,{default:()=>ye});var t=a(6832),r=a(2660),n=a(6857),i=a(3106),s=a(4550),c=a(6984),d=a(8621),l=a(21),p=a(122),m=a(2735),u=a(2384),h=a(6121),x=a(8229),A=a(4184),f=a(2250),b=a(6647),g=a(7237),j=a(5515),v=a(2260),y=a(1411),I=a(2729),w=a(4909),_=a(6534),S=a(1608),O=a(769),D=a(2757),F=a(2184),C=a(2768),M=a(1919),T=a(5755),R=a(279),N=a(3840),k=a(9977),P=a(7767),z=a(798),E=a(7327),V=a(9239),W=a(3562),H=a(3870),J=a(7765),L=a(3009),B=a(6019),G=a(5376),K=a(9686),U=a(9147),q=a(7735),Z=a(2244),Q=a(7250),X=a(4153),Y=a(2676),$=a(721),ee=a(1110),oe=a(1296),ae=a(7387),te=a(8217),re=a(5790),ne=a(2691),ie=a(7611),se=a(9139),ce=a(6519),de=a(7175),le=a(6024),pe=a(3313),me=a(2430),ue=a(6581),he=a(326),xe=a(632);const Ae=(0,Z.Ay)(d.A)(e=>{let{theme:o}=e;return{padding:o.spacing(3),borderRadius:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)",[o.breakpoints.down("md")]:{padding:o.spacing(2),borderRadius:"12px"},[o.breakpoints.down("sm")]:{padding:o.spacing(1.5),borderRadius:"8px",margin:o.spacing(.5)}}}),fe=(0,Z.Ay)(l.A)(e=>{let{theme:o}=e;return{"&:nth-of-type(odd)":{backgroundColor:o.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}}),be=(0,Z.Ay)(p.A)(e=>{let{theme:o,tipo:a}=e;return{backgroundColor:"teletrabajo"===a||"tele-presencial"===a?"rgba(46, 125, 50, 0.06)":"personalizado"===a?"rgba(63, 81, 181, 0.06)":"inherit",fontWeight:"descanso"===a?"normal":"bold",color:"descanso"===a?o.palette.text.secondary:o.palette.text.primary}}),ge=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"],je={personalizado:"Presencial",teletrabajo:"Teletrabajo",descanso:"Descanso",vacaciones:"Vacaciones",feriado:"Feriado",permiso:"Permiso Otorgado por Jefatura","tarde-libre":"Tarde Libre","dia-brigada":"D\xeda por Brigada"},ve=e=>{let{open:o,onClose:a,usuarioInfractor:t,usuariosSugeridos:n,tipoInfraccion:i,detalleInfraccion:s,calcularHorasTotales:c}=e;return t?(0,xe.jsxs)(L.A,{open:o,onClose:a,fullWidth:!0,maxWidth:"sm",children:[(0,xe.jsx)(B.A,{children:"Alerta de Infracci\xf3n de Reglas"}),(0,xe.jsxs)(G.A,{children:[(0,xe.jsxs)(K.A,{sx:{mb:2},children:[(0,xe.jsxs)("strong",{children:[t.nombre," ",t.apellidos]})," - ",t.departamento]}),(0,xe.jsxs)(b.A,{variant:"body1",color:"error",gutterBottom:!0,children:[(0,xe.jsx)("strong",{children:"Problema detectado:"})," ",s]}),n.length>0?(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(b.A,{variant:"body1",sx:{mt:3,mb:2},children:(0,xe.jsx)("strong",{children:"Sugerencias de colaboradores alternativos:"})}),(0,xe.jsx)(E.A,{sx:{bgcolor:"background.paper"},children:n.map((e,o)=>(0,xe.jsxs)(r.Fragment,{children:[(0,xe.jsxs)(V.Ay,{alignItems:"flex-start",children:[(0,xe.jsx)(W.A,{children:(0,xe.jsxs)(H.A,{children:[e.nombre.charAt(0),e.apellidos.charAt(0)]})}),(0,xe.jsx)(J.A,{primary:"".concat(e.nombre," ").concat(e.apellidos),secondary:(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsxs)(b.A,{component:"span",variant:"body2",color:"text.primary",children:[e.cargo," - ",e.departamento]}),(0,xe.jsx)("br",{}),"Horas asignadas: ".concat(c(e.id).toFixed(1)," de 48 horas")]})})]}),o<n.length-1&&(0,xe.jsx)(U.A,{variant:"inset",component:"li"})]},e.id))})]}):(0,xe.jsx)(b.A,{variant:"body1",sx:{mt:3,color:"warning.main"},children:"No se encontraron colaboradores disponibles que puedan sustituir a este usuario sin infringir las reglas. Se recomienda considerar la contrataci\xf3n de personal temporal o ajustar los horarios."})]}),(0,xe.jsx)(q.A,{children:(0,xe.jsx)(h.A,{onClick:a,color:"primary",children:"Cerrar"})})]}):null},ye=()=>{const e=(0,m.A)(),o=(0,u.A)(e.breakpoints.down("md")),[a,d]=(0,r.useState)(!0),[L,B]=(0,r.useState)([]),[G,K]=(0,r.useState)({}),[U,q]=(0,r.useState)((0,Q.A)(new Date,{weekStartsOn:1})),[Z,he]=(0,r.useState)(""),[ye,_e]=(0,r.useState)(null),[Se,Oe]=(0,r.useState)({}),[De,Fe]=(0,r.useState)(null),[Ce,Me]=(0,r.useState)((0,X.A)(new Date)),[Te,Re]=(0,r.useState)((new Date).getMonth()),[Ne,ke]=(0,r.useState)(!1),[Pe,ze]=(0,r.useState)(!1),[Ee,Ve]=(0,r.useState)(null),[We,He]=(0,r.useState)([]),[Je,Le]=(0,r.useState)(""),[Be,Ge]=(0,r.useState)(""),Ke=(e=>{const o=(0,X.A)(e),a=(0,Y.A)(e);return"".concat(o,"-").concat(a)})(U),Ue=i.j2.currentUser?L.find(e=>e.id===i.j2.currentUser.uid):null,qe="Administrador"===(null===Ue||void 0===Ue?void 0:Ue.rol);(0,r.useEffect)(()=>{(async()=>{try{d(!0);if(!i.j2.currentUser)return;const e=(0,n.KR)(i.OO,"usuarios"),o=await(0,n.Jt)(e);if(o.exists()){const e=o.val(),a=Object.entries(e).map(e=>{let[o,a]=e;return(0,t.A)({id:o},a)});B(a)}const a=(0,n.KR)(i.OO,"horarios_registros"),r=await(0,n.Jt)(a);if(r.exists()){const e=r.val();K(e)}}catch(e){console.error("Error al cargar datos:",e),s.oR.error("Error al cargar datos: "+e.message)}finally{d(!1)}})()},[]);const Ze=()=>{const e=new Date(Ce,Te+1,0).getDate(),o=new Date(Ce,Te,1).getDay(),a=0===o?7:o,t=[];for(let r=1;r<=e;r++)t.push(r);return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsxs)(h.A,{variant:"outlined",startIcon:(0,xe.jsx)(ne.A,{}),onClick:e=>{Fe(e.currentTarget),ke(!0)},fullWidth:!0,children:["Semana ",(0,Y.A)(U)," - ",(0,X.A)(U)]}),(0,xe.jsx)(x.Ay,{open:Ne,anchorEl:De,onClose:()=>{Fe(null),ke(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},sx:{"& .MuiPopover-paper":{position:"fixed !important",top:"50% !important",left:"50% !important",transform:"translate(-50%, -50%) !important",maxWidth:"90vw",maxHeight:"80vh",zIndex:9999}},children:(0,xe.jsxs)(A.A,{sx:{p:2,width:280},children:[(0,xe.jsxs)(A.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,xe.jsx)(f.A,{onClick:()=>{0===Te?(Re(11),Me(Ce-1)):Re(Te-1)},size:"small",children:(0,xe.jsx)(ie.A,{fontSize:"small"})}),(0,xe.jsx)(b.A,{variant:"subtitle1",children:(0,oe.A)(new Date(Ce,Te,1),"MMMM yyyy",{locale:te.A})}),(0,xe.jsx)(f.A,{onClick:()=>{11===Te?(Re(0),Me(Ce+1)):Re(Te+1)},size:"small",children:(0,xe.jsx)(se.A,{fontSize:"small"})})]}),(0,xe.jsxs)(g.Ay,{container:!0,spacing:1,children:[["L","M","X","J","V","S","D"].map((e,o)=>(0,xe.jsx)(g.Ay,{item:!0,xs:12/7,children:(0,xe.jsx)(b.A,{variant:"caption",align:"center",sx:{display:"block"},children:e})},o)),Array(a-1).fill(null).map((e,o)=>(0,xe.jsx)(g.Ay,{item:!0,xs:12/7},"empty-".concat(o))),t.map(e=>(0,xe.jsx)(g.Ay,{item:!0,xs:12/7,children:(0,xe.jsx)(h.A,{variant:"text",sx:{minWidth:0,width:"100%",borderRadius:"50%"},onClick:()=>(e=>{const o=new Date(Ce,Te,e),a=(0,Q.A)(o,{weekStartsOn:1});q(a),ke(!1),Fe(null)})(e),children:e})},e))]})]})})]})},Qe=L.filter(e=>(!Z||e.departamento===Z)&&(!ye||e.id===ye.id));(0,r.useEffect)(()=>{try{localStorage.setItem("usuarios_export",JSON.stringify(Qe)),localStorage.setItem("horariosRegistros_export",JSON.stringify(G)),localStorage.setItem("semanaSeleccionada_export",U.toISOString())}catch(e){}},[Qe,G,U]);const Xe=(e,o)=>{if(!e||!e[o])return{texto:"Sin horario",tipo:null};const a=e[o];if(!a)return{texto:"Sin horario",tipo:null};if("descanso"===a.tipo)return{texto:"Descanso",tipo:"descanso"};const t=je[a.tipo]||a.tipo;if("tele-presencial"===a.tipo){const e=a.horaInicioTele||"",o=a.horaFinTele||"",r=a.horaInicioPres||"",n=a.horaFinPres||"",i=Number.isFinite(a.horasTele)?a.horasTele:a.horasTele?Number(a.horasTele):0,s=Number.isFinite(a.horasPres)?a.horasPres:a.horasPres?Number(a.horasPres):0,c=Number.isFinite(a.horas)?a.horas:i+s,d=[];e&&o?d.push("Teletrabajo: ".concat(e," - ").concat(o," (").concat(i.toFixed(1),"h)")):i>0&&d.push("Teletrabajo: ".concat(i.toFixed(1),"h")),r&&n?d.push("Presencial: ".concat(r," - ").concat(n," (").concat(s.toFixed(1),"h)")):s>0&&d.push("Presencial: ".concat(s.toFixed(1),"h"));const l=d.length>0?d.join(" / "):"Teletrabajo & Presencial";return{texto:"".concat(t,": ").concat(l," (Total: ").concat(Number(c||0).toFixed(1),"h)"),tipo:a.tipo}}const r=a.horaInicio||"",n=a.horaFin||"",i=Number.isFinite(a.horas)?a.horas:a.horas?Number(a.horas):0;return r&&n?{texto:"".concat(t,": ").concat(r," - ").concat(n," (").concat(i.toFixed(1),"h)"),tipo:a.tipo}:i>0?{texto:"".concat(t,": ").concat(i.toFixed(1),"h"),tipo:a.tipo}:{texto:t,tipo:a.tipo}},Ye=e=>{const o=(G[Ke]||{})[e];return o?Object.values(o).reduce((e,o)=>{if(!o||"descanso"===o.tipo)return e;if(Number.isFinite(o.horas))return e+(o.horas||0);if("tele-presencial"===o.tipo){return e+(Number.isFinite(o.horasTele)?o.horasTele:o.horasTele?Number(o.horasTele):0)+(Number.isFinite(o.horasPres)?o.horasPres:o.horasPres?Number(o.horasPres):0)}return e+(o.horas||0)},0):0},$e=e=>{const o=(G[Ke]||{})[e];if(!o)return{tieneInfraccion:!1};const a=[];for(let t=1;t<=7;t++){const e=o["dia".concat(t)];e&&"descanso"!==e.tipo&&"vacaciones"!==e.tipo&&"feriado"!==e.tipo&&"permiso"!==e.tipo&&e.horaInicio&&e.horaFin&&a.push({dia:t,horaInicio:e.horaInicio,horaFin:e.horaFin,tipo:e.tipo})}for(let t=0;t<a.length-1;t++){const e=a[t],o=a[t+1];if(o.dia===e.dia+1){const[a,t]=e.horaFin.split(":").map(Number),[r,n]=o.horaInicio.split(":").map(Number),i=(1440-(60*a+t)+(60*r+n))/60;if(i<12)return{tieneInfraccion:!0,tipo:"descanso",detalle:"Solo hay ".concat(i.toFixed(1)," horas de descanso entre el turno del ").concat(ge[e.dia-1]," (termina ").concat(e.horaFin,") y el ").concat(ge[o.dia-1]," (inicia ").concat(o.horaInicio,")")}}}return{tieneInfraccion:!1}},eo=e=>{const o=Qe.find(o=>o.id===e),a=(0,c.bW)((null===o||void 0===o?void 0:o.tipoContrato)||"Operativo"),t=Ye(e);if(t>a)return{tieneInfraccion:!0,tipo:"horas",detalle:"El colaborador excede el l\xedmite de ".concat(a," horas semanales seg\xfan su contrato ").concat((null===o||void 0===o?void 0:o.tipoContrato)||"Operativo"," (").concat(t.toFixed(1)," horas asignadas)")};const r=$e(e);return r.tieneInfraccion?r:{tieneInfraccion:!1}},oo=e=>{const o=eo(e.id);if(o.tieneInfraccion){Ve(e),Le(o.tipo),Ge(o.detalle);const a=(e=>{if(!e)return[];const o=L.filter(o=>o.id!==e.id&&o.departamento===e.departamento).filter(e=>{const o=Ye(e.id),a=$e(e.id);return o<(0,c.bW)(e.tipoContrato||"Operativo")-8&&!a.tieneInfraccion});if(0===o.length)return L.filter(o=>"Practicantes/Crosstraining"===o.departamento&&o.departamentosAutorizados&&Array.isArray(o.departamentosAutorizados)&&o.departamentosAutorizados.includes(e.departamento)).filter(e=>{const o=Ye(e.id),a=$e(e.id);return o<(0,c.bW)(e.tipoContrato||"Operativo")-8&&!a.tieneInfraccion});return o})(e);He(a),ze(!0)}};return a?(0,xe.jsx)(A.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:(0,xe.jsx)(j.A,{})}):(0,xe.jsxs)(v.A,{maxWidth:"lg",sx:{mt:{xs:2,md:4},mb:{xs:2,md:4},px:{xs:1,sm:2,md:3}},children:[(0,xe.jsx)(b.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"var(--primary-color)",textAlign:{xs:"center",md:"left"},mb:{xs:2,md:3},fontSize:{xs:"1.5rem",md:"2.125rem"}},children:"Consulta de Horarios"}),qe&&(0,xe.jsxs)(A.A,{sx:{display:"flex",gap:1,mb:2,justifyContent:{xs:"center",md:"flex-end"}},children:[(0,xe.jsx)(h.A,{variant:"outlined",startIcon:(0,xe.jsx)(pe.A,{}),onClick:()=>Ie(),size:o?"small":"medium",children:"Exportar a Excel"}),(0,xe.jsx)(h.A,{variant:"contained",color:"primary",startIcon:(0,xe.jsx)(me.A,{}),onClick:()=>we(),size:o?"small":"medium",children:"Exportar a PDF"})]}),(0,xe.jsxs)(Ae,{elevation:3,sx:{mb:{xs:2,md:4},p:{xs:1.5,sm:2,md:3}},children:[(0,xe.jsxs)(g.Ay,{container:!0,spacing:{xs:2,md:3},alignItems:"center",sx:{mb:{xs:3,md:4}},children:[(0,xe.jsx)(g.Ay,{item:!0,xs:12,md:4,children:(0,xe.jsx)(y.A,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:"center",sx:{width:"100%"},children:(0,xe.jsxs)(y.A,{direction:"row",spacing:1,alignItems:"center",sx:{justifyContent:"center"},children:[(0,xe.jsx)(f.A,{onClick:()=>{const e=(0,ee.A)(U,1);q(e)},size:"small",children:(0,xe.jsx)(ie.A,{fontSize:"small"})}),(0,xe.jsx)(Ze,{}),(0,xe.jsx)(f.A,{onClick:()=>{const e=(0,$.A)(U,1);q(e)},size:"small",children:(0,xe.jsx)(se.A,{fontSize:"small"})})]})})}),(0,xe.jsx)(g.Ay,{item:!0,xs:12,md:4,children:(0,xe.jsxs)(I.A,{fullWidth:!0,size:o?"small":"medium",children:[(0,xe.jsx)(w.A,{id:"departamento-select-label",children:"Departamento"}),(0,xe.jsxs)(_.A,{labelId:"departamento-select-label",value:Z,label:"Departamento",onChange:e=>{he(e.target.value),_e(null)},children:[(0,xe.jsx)(S.A,{value:"",children:"Todos"}),ue.A1.map(e=>(0,xe.jsx)(S.A,{value:e,children:e},e))]})]})}),(0,xe.jsx)(g.Ay,{item:!0,xs:12,md:4,children:(0,xe.jsx)(O.A,{options:L,getOptionLabel:e=>"".concat(e.nombre," ").concat(e.apellidos),renderInput:e=>(0,xe.jsx)(D.A,(0,t.A)((0,t.A)({},e),{},{label:"Buscar colaborador",size:o?"small":"medium",InputProps:(0,t.A)((0,t.A)({},e.InputProps),{},{endAdornment:(0,xe.jsxs)(xe.Fragment,{children:[e.InputProps.endAdornment,(0,xe.jsx)(re.A,{color:"action"})]})})})),value:ye,onChange:(e,o)=>{_e(o),o&&he(o.departamento)},isOptionEqualToValue:(e,o)=>e.id===(null===o||void 0===o?void 0:o.id)})})]}),(0,xe.jsxs)(b.A,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1rem",md:"1.25rem"},mb:{xs:2,md:3}},children:["Semana del ",(0,oe.A)(U,"d 'de' MMMM",{locale:te.A})," al ",(0,oe.A)((0,ae.A)(U,6),"d 'de' MMMM",{locale:te.A})]}),G[Ke]?0===Qe.length?(0,xe.jsx)(A.A,{sx:{my:4,textAlign:"center"},children:(0,xe.jsx)(b.A,{variant:"subtitle1",color:"text.secondary",children:"No se encontraron colaboradores con los filtros aplicados"})}):(0,xe.jsx)(A.A,{children:Qe.map(e=>{var a;const r=null===(a=G[Ke])||void 0===a?void 0:a[e.id],n=Ye(e.id),i=Se[e.id]||!1;return(0,xe.jsxs)(F.A,{sx:{mb:2,borderRadius:{xs:"8px",md:"12px"},overflow:"visible"},children:[(0,xe.jsx)(C.A,{avatar:(0,xe.jsx)(le.A,{}),title:(0,xe.jsxs)(b.A,{variant:o?"subtitle2":"h6",children:[e.nombre," ",e.apellidos]}),subheader:(0,xe.jsxs)(b.A,{variant:o?"caption":"body2",children:[e.cargo," - ",e.departamento]}),action:(0,xe.jsxs)(A.A,{sx:{display:"flex",alignItems:"center",flexDirection:{xs:"column",sm:"row"},gap:{xs:.5,sm:1}},children:[(0,xe.jsx)(M.A,{label:"".concat(n.toFixed(1)," horas"),color:n>48?"error":"default",size:"small",sx:{cursor:"pointer"},onClick:()=>{eo(e.id).tieneInfraccion&&oo(e)}}),$e(e.id).tieneInfraccion&&(0,xe.jsx)(M.A,{label:o?"Descanso \u2193":"Descanso insuficiente",color:"warning",size:"small",sx:{cursor:"pointer"},onClick:()=>oo(e)}),(0,xe.jsx)(f.A,{onClick:()=>{return o=e.id,void Oe(e=>(0,t.A)((0,t.A)({},e),{},{[o]:!e[o]}));var o},"aria-expanded":i,"aria-label":"mostrar m\xe1s",size:o?"small":"medium",children:i?(0,xe.jsx)(de.A,{}):(0,xe.jsx)(ce.A,{})})]}),sx:{"& .MuiCardHeader-content":{overflow:"hidden"}}}),(0,xe.jsx)(T.A,{in:i,timeout:"auto",unmountOnExit:!0,children:(0,xe.jsxs)(R.A,{sx:{p:{xs:1,md:2}},children:[(0,xe.jsx)(A.A,{sx:{display:{xs:"none",md:"block"}},children:(0,xe.jsx)(N.A,{children:(0,xe.jsxs)(k.A,{size:"small",children:[(0,xe.jsx)(P.A,{children:(0,xe.jsxs)(l.A,{children:[(0,xe.jsx)(p.A,{children:"D\xeda"}),(0,xe.jsx)(p.A,{children:"Fecha"}),(0,xe.jsx)(p.A,{children:"Horario"})]})}),(0,xe.jsx)(z.A,{children:ge.map((e,o)=>{const a="dia".concat(o+1),t=(0,oe.A)((0,ae.A)(U,o),"d MMM",{locale:te.A}),n=Xe(r,a);return(0,xe.jsxs)(fe,{children:[(0,xe.jsx)(p.A,{children:e}),(0,xe.jsx)(p.A,{children:t}),(0,xe.jsx)(be,{tipo:n.tipo,children:n.texto})]},a)})})]})})}),(0,xe.jsx)(A.A,{sx:{display:{xs:"block",md:"none"}},children:(0,xe.jsx)(E.A,{dense:!0,children:ge.map((e,o)=>{const a="dia".concat(o+1),t=(0,oe.A)((0,ae.A)(U,o),"d MMM",{locale:te.A}),n=Xe(r,a);return(0,xe.jsxs)(V.Ay,{divider:!0,children:[(0,xe.jsx)(W.A,{children:(0,xe.jsx)(H.A,{sx:{width:32,height:32,fontSize:"0.75rem",bgcolor:"teletrabajo"===n.tipo?"#2e7d32":"personalizado"===n.tipo?"primary.main":"grey.500"},children:e.slice(0,1)})}),(0,xe.jsx)(J.A,{primary:(0,xe.jsxs)(b.A,{variant:"body2",sx:{fontWeight:"medium"},children:[e," - ",t]}),secondary:(0,xe.jsx)(b.A,{variant:"caption",sx:{color:"descanso"===n.tipo?"text.secondary":"text.primary",fontWeight:"descanso"===n.tipo?"normal":"medium"},children:n.texto})})]},a)})})})]})})]},e.id)})}):(0,xe.jsx)(A.A,{sx:{my:4,textAlign:"center"},children:(0,xe.jsx)(b.A,{variant:"subtitle1",color:"text.secondary",children:"No hay registros de horarios para esta semana"})})]}),(0,xe.jsx)(ve,{open:Pe,onClose:()=>{ze(!1),Ve(null),He([]),Le(""),Ge("")},usuarioInfractor:Ee,usuariosSugeridos:We,tipoInfraccion:Je,detalleInfraccion:Be,calcularHorasTotales:Ye})]})},Ie=()=>{const e=JSON.parse(localStorage.getItem("usuarios_export"))||[],o=JSON.parse(localStorage.getItem("horariosRegistros_export"))||{},a=new Date(localStorage.getItem("semanaSeleccionada_export")||Date.now()),t="undefined"!==typeof window&&window.__usuarios_export__?window.__usuarios_export__:e,r="undefined"!==typeof window&&window.__registros_export__?window.__registros_export__:o,n="undefined"!==typeof window&&window.__semana_export__?new Date(window.__semana_export__):a,i=(()=>{const e=(0,X.A)(n),o=(0,Y.A)(n);return"".concat(e,"-").concat(o)})(),s=[],c=["Colaborador","Departamento",...ge];s.push(c),t.forEach(e=>{const o=["".concat(e.nombre," ").concat(e.apellidos),e.departamento||""];for(let a=1;a<=7;a++){const t="dia".concat(a),n=r[i]&&r[i][e.id]&&r[i][e.id][t];n?"descanso"===n.tipo?o.push("Descanso"):o.push("".concat(n.horaInicio," - ").concat(n.horaFin," (").concat((n.horas||0).toFixed(1),"h)")):o.push("Sin horario")}s.push(o)});const d=he.Wp.aoa_to_sheet(s);d["!cols"]=[{wch:30},{wch:20}].concat(new Array(7).fill({wch:24}));const l=he.Wp.book_new();he.Wp.book_append_sheet(l,d,"Semana ".concat(i)),he._h(l,"reporte_horarios_".concat(i,".xlsx"))},we=()=>{const e=JSON.parse(localStorage.getItem("usuarios_export"))||[],o=JSON.parse(localStorage.getItem("horariosRegistros_export"))||{},a=new Date(localStorage.getItem("semanaSeleccionada_export")||Date.now()),t="undefined"!==typeof window&&window.__usuarios_export__?window.__usuarios_export__:e,r="undefined"!==typeof window&&window.__registros_export__?window.__registros_export__:o,n="undefined"!==typeof window&&window.__semana_export__?new Date(window.__semana_export__):a,i={};t.forEach(e=>{const o=e.departamento||"Sin Departamento";i[o]||(i[o]=[]),i[o].push(e)});let s='<!doctype html><html><head><meta charset="utf-8"><title>Reporte de Horarios</title>';s+="<style>\n    body{font-family: Arial, sans-serif; color:#333}\n    .header{background:#00830e;color:#fff;padding:12px 16px;border-radius:6px}\n    .title{font-size:18px;margin:0}\n    table{width:100%;border-collapse:collapse;margin-top:8px;margin-bottom:16px}\n    th{background:#f0f0f0;text-align:left;padding:8px;border-bottom:1px solid #ddd}\n    td{padding:8px;border-bottom:1px solid #eee}\n    .dept{background:#f5f5f5;padding:8px;margin-top:12px;border-left:6px solid #00830e}\n  </style>",s+="</head><body>",s+='<div class="header"><h2 class="title">Reporte de Horarios - Semana desde '.concat((0,oe.A)(n,"d 'de' MMMM yyyy",{locale:te.A}),"</h2></div>"),Object.keys(i).forEach(e=>{s+='<div class="dept"><strong>'.concat(e,"</strong></div>"),s+="<table><thead><tr><th>Colaborador</th>",ge.forEach(e=>{s+="<th>".concat(e,"</th>")}),s+="</tr></thead><tbody>",i[e].forEach(e=>{s+="<tr><td>".concat(e.nombre," ").concat(e.apellidos,"</td>");const o=(()=>{const e=(0,X.A)(n),o=(0,Y.A)(n);return"".concat(e,"-").concat(o)})();for(let a=1;a<=7;a++){const t="dia".concat(a),n=r[o]&&r[o][e.id]&&r[o][e.id][t];n?"descanso"===n.tipo?s+="<td>Descanso</td>":s+="<td>".concat(n.horaInicio," - ").concat(n.horaFin," (").concat((n.horas||0).toFixed(1),"h)</td>"):s+="<td>Sin horario</td>"}s+="</tr>"}),s+="</tbody></table>"}),s+="</body></html>";const c=window.open("","_blank");c.document.open(),c.document.write(s),c.document.close(),setTimeout(()=>{c.print()},500)}}}]);
//# sourceMappingURL=979.ae080398.chunk.js.map