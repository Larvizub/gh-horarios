"use strict";(self.webpackChunkcostaricacc_horarios=self.webpackChunkcostaricacc_horarios||[]).push([[525],{6984:(e,r,o)=>{o.d(r,{FW:()=>u,MJ:()=>s,MO:()=>m,Nf:()=>l,RK:()=>a,VO:()=>c,bW:()=>n,gg:()=>i,m:()=>h,qK:()=>d});const a={OPERATIVO:"Operativo",CONFIANZA:"Confianza"},i={ADMINISTRADOR:"Administrador",MODIFICADOR:"Modificador",VISOR:"Visor"},t={[a.OPERATIVO]:48,[a.CONFIANZA]:72},n=e=>t[e]||t[a.OPERATIVO],l=e=>{const r=n(e);return"Los empleados de tipo ".concat(e," tienen un l\xedmite de ").concat(r," horas semanales.")},s=e=>"Talento Humano"===(null===e||void 0===e?void 0:e.departamento),d=e=>(null===e||void 0===e?void 0:e.rol)===i.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),c=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===e||void 0===e?void 0:e.rol)===i.ADMINISTRADOR||((null===e||void 0===e?void 0:e.rol)===i.MODIFICADOR||(null===e||void 0===e?void 0:e.rol)===i.VISOR?!r||(null===e||void 0===e?void 0:e.departamento)===(null===r||void 0===r?void 0:r.departamento):"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email))},u=e=>(null===e||void 0===e?void 0:e.rol)===i.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),h=e=>{switch(e){case i.ADMINISTRADOR:return"error";case i.MODIFICADOR:return"warning";case i.VISOR:return"info";default:return"default"}},m=e=>{switch(e){case i.ADMINISTRADOR:return"Puede realizar todos los cambios en la plataforma";case i.MODIFICADOR:return"Puede modificar horarios de su departamento";case i.VISOR:return"Solo puede ver horarios, sin modificaciones";default:return"Sin rol espec\xedfico asignado"}}},9906:(e,r,o)=>{o.r(r),o.d(r,{default:()=>ee});var a=o(6832),i=o(2660),t=o(6857),n=o(3106),l=o(4550),s=o(8359),d=o(6984),c=o(8621),u=o(3840),h=o(7767),m=o(21),A=o(4184),x=o(2735),p=o(2384),g=o(2260),v=o(6647),f=o(6121),j=o(9977),y=o(122),b=o(798),R=o(3870),z=o(1919),O=o(2729),S=o(6534),I=o(1608),w=o(349),C=o(2853),D=o(7343),k=o(4951),T=o(2250),M=o(5213),E=o(5596),N=o(976),W=o(3009),K=o(6019),P=o(5376),F=o(9686),V=o(7735),H=o(2244),q=o(489),U=o(6678),G=o(6519),J=o(4155),Z=o(632);const L=(0,H.Ay)(c.A)(e=>{let{theme:r}=e;return{padding:r.spacing(3),borderRadius:"16px",boxShadow:"0 8px 24px rgba(0,0,0,0.10)",background:"linear-gradient(135deg, #f8fafc 0%, #e3f2fd 100%)"}}),_=(0,H.Ay)(u.A)(e=>{let{theme:r}=e;return{borderRadius:"12px",boxShadow:"0 4px 16px rgba(0,0,0,0.07)",marginTop:r.spacing(2),background:"white",width:"100%",[r.breakpoints.down("md")]:{overflowX:"auto"},[r.breakpoints.up("md")]:{"& .MuiTable-root":{width:"100%",tableLayout:"fixed"}}}}),B=(0,H.Ay)(h.A)(e=>{let{theme:r}=e;return{background:"var(--primary-color)","& th":{color:"white",fontWeight:"bold",fontSize:"1rem",border:0,[r.breakpoints.down("md")]:{whiteSpace:"nowrap"},[r.breakpoints.up("md")]:{"&:nth-of-type(1)":{width:"18%"},"&:nth-of-type(2)":{width:"18%"},"&:nth-of-type(3)":{width:"12%"},"&:nth-of-type(4)":{width:"12%"},"&:nth-of-type(5)":{width:"12%"},"&:nth-of-type(6)":{width:"8%"},"&:nth-of-type(7)":{width:"15%"},"&:nth-of-type(8)":{width:"5%"}}}}}),X=(0,H.Ay)(m.A)(e=>{let{theme:r}=e;return{"&:nth-of-type(odd)":{backgroundColor:"#f6fafd"},"&:hover":{backgroundColor:"#e3f2fd",transition:"background 0.2s"},"& td":{[r.breakpoints.down("md")]:{whiteSpace:"nowrap"},[r.breakpoints.up("md")]:{"&:nth-of-type(1)":{width:"18%"},"&:nth-of-type(2)":{width:"18%"},"&:nth-of-type(3)":{width:"12%"},"&:nth-of-type(4)":{width:"12%"},"&:nth-of-type(5)":{width:"12%"},"&:nth-of-type(6)":{width:"8%"},"&:nth-of-type(7)":{width:"15%"},"&:nth-of-type(8)":{width:"5%"}}}}}),Q=(0,H.Ay)(A.A)(e=>{let{theme:r}=e;return{display:"flex",alignItems:"center"}}),Y=e=>"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||(null===e||void 0===e?void 0:e.rol)===d.gg.ADMINISTRADOR,$=["Planeaci\xf3n de Eventos","Gesti\xf3n de la Protecci\xf3n","\xc1reas & Sostenibilidad","Gastronom\xeda","Infraestructura","Financiero","Talento Humano","Calidad","Sistemas"],ee=()=>{const e=(0,x.A)(),r=(0,p.A)(e.breakpoints.down("md")),[o,c]=(0,i.useState)([]),[u,h]=(0,i.useState)(!1),[H,ee]=(0,i.useState)(null),[re,oe]=(0,i.useState)(null),[ae,ie]=(0,i.useState)(!0),[te,ne]=(0,i.useState)({}),[le,se]=(0,i.useState)([]),[de,ce]=(0,i.useState)(""),ue=(0,s.Zp)();(0,i.useEffect)(()=>{(async()=>{try{const e=n.j2.currentUser;if(!e)return void ue("/");const r=(0,t.KR)(n.OO,"usuarios/".concat(e.uid)),o=(await(0,t.Jt)(r)).val(),i=e.email||"",s=(0,a.A)((0,a.A)({},o),{},{email:(null===o||void 0===o?void 0:o.email)||i});if(oe(s),s.rol!==d.gg.ADMINISTRADOR&&"Talento Humano"!==s.departamento&&"admin@costaricacc.com"!==s.email)return l.oR.error("No tienes permisos para acceder a esta p\xe1gina"),void ue("/dashboard");const u=(0,t.KR)(n.OO,"usuarios"),h=await(0,t.Jt)(u);if(h.exists()){const e=h.val(),r=Object.entries(e).map(e=>{let[r,o]=e;return(0,a.A)((0,a.A)({id:r},o),{},{tipoContrato:o.tipoContrato||"Operativo",rol:o.rol||null})});c(r)}else c([]);s.departamento&&se([s.departamento])}catch(e){console.error("Error al cargar usuarios:",e),l.oR.error("Error al cargar usuarios: "+e.message)}finally{ie(!1)}})()},[ue]);const he=()=>{h(!1),ee(null)},me=e=>{const{value:r,checked:o}=e.target;se(o?[...le,r]:le.filter(e=>e!==r))};return ae||!re?(0,Z.jsx)(g.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:(0,Z.jsx)(A.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:(0,Z.jsx)(v.A,{children:"Cargando..."})})}):(0,Z.jsxs)(g.A,{maxWidth:!!r&&"lg",sx:(0,a.A)({mt:4,mb:4},!r&&{maxWidth:"98vw",px:2}),children:[(0,Z.jsx)(v.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"var(--primary-color)"},children:"Gesti\xf3n de Personal"}),(0,Z.jsxs)(L,{elevation:3,children:[(0,Z.jsxs)(A.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,Z.jsx)(v.A,{variant:"h6",sx:{color:"var(--primary-color)",fontWeight:"bold"},children:"Listado de Usuarios Registrados"}),(Ae=re,(0,d.qK)(Ae)&&(0,Z.jsx)(f.A,{variant:"contained",color:"primary",onClick:()=>{ue("/registro")},sx:{borderRadius:2,fontWeight:"bold",boxShadow:"0 2px 8px rgba(0,0,0,0.07)"},children:"Agregar Usuario"}))]}),(0,Z.jsx)(_,{children:(0,Z.jsxs)(j.A,{children:[(0,Z.jsx)(B,{children:(0,Z.jsxs)(m.A,{children:[(0,Z.jsx)(y.A,{children:"Nombre"}),(0,Z.jsx)(y.A,{children:"Email"}),(0,Z.jsx)(y.A,{children:"Departamento"}),(0,Z.jsx)(y.A,{children:"Cargo"}),(0,Z.jsx)(y.A,{children:"Tipo de Contrato"}),(0,Z.jsx)(y.A,{children:"Rol"}),(0,Z.jsx)(y.A,{children:"Departamentos Autorizados"}),(0,Z.jsx)(y.A,{align:"right",children:"Acciones"})]})}),(0,Z.jsx)(b.A,{children:o.map(e=>{var r,i,s;return(0,Z.jsxs)(X,{children:[(0,Z.jsx)(y.A,{children:(0,Z.jsxs)(Q,{children:[(0,Z.jsxs)(R.A,{sx:{mr:2,bgcolor:"var(--secondary-color)",width:36,height:36,fontSize:"1rem"},children:[null===(r=e.nombre)||void 0===r?void 0:r.charAt(0),null===(i=e.apellidos)||void 0===i?void 0:i.charAt(0)]}),(0,Z.jsx)(A.A,{children:(0,Z.jsxs)(v.A,{variant:"subtitle2",sx:{fontWeight:500},children:[e.nombre," ",e.apellidos]})})]})}),(0,Z.jsx)(y.A,{children:(0,Z.jsx)(v.A,{variant:"body2",children:e.email})}),(0,Z.jsx)(y.A,{children:(0,Z.jsx)(z.A,{label:e.departamento,color:"Talento Humano"===e.departamento?"secondary":"Calidad"===e.departamento?"warning":"default",size:"small",sx:{fontWeight:500}})}),(0,Z.jsx)(y.A,{children:(0,Z.jsx)(v.A,{variant:"body2",children:e.cargo})}),(0,Z.jsx)(y.A,{children:(0,d.MJ)(re)?(0,Z.jsx)(O.A,{size:"small",sx:{minWidth:120,width:"100%"},children:(0,Z.jsxs)(S.A,{value:e.tipoContrato||"Operativo",onChange:r=>(async(e,r)=>{if((0,d.MJ)(re))try{await(0,t.yo)((0,t.KR)(n.OO,"usuarios/".concat(e)),{tipoContrato:r}),c(o.map(o=>o.id===e?(0,a.A)((0,a.A)({},o),{},{tipoContrato:r}):o)),l.oR.success("Tipo de contrato actualizado a ".concat(r))}catch(i){console.error("Error al actualizar tipo de contrato:",i),l.oR.error("Error al actualizar tipo de contrato: "+i.message)}else l.oR.error("Solo personal de Talento Humano puede modificar el tipo de contrato")})(e.id,r.target.value),sx:{bgcolor:"white","& .MuiSelect-select":{py:.5,fontSize:"0.875rem"}},children:[(0,Z.jsx)(I.A,{value:d.RK.OPERATIVO,children:(0,Z.jsxs)(A.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,Z.jsx)(z.A,{label:"Operativo",color:"info",size:"small",sx:{fontSize:"0.75rem"}}),(0,Z.jsx)(v.A,{variant:"caption",children:"(48h)"})]})}),(0,Z.jsx)(I.A,{value:d.RK.CONFIANZA,children:(0,Z.jsxs)(A.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,Z.jsx)(z.A,{label:"Confianza",color:"success",size:"small",sx:{fontSize:"0.75rem"}}),(0,Z.jsx)(v.A,{variant:"caption",children:"(72h)"})]})})]})}):(0,Z.jsx)(w.A,{title:(0,d.Nf)(e.tipoContrato||"Operativo"),children:(0,Z.jsx)(z.A,{label:e.tipoContrato||"No definido",color:"Confianza"===e.tipoContrato?"success":"Operativo"===e.tipoContrato?"info":"default",size:"small",sx:{fontWeight:500,cursor:"help"}})})}),(0,Z.jsx)(y.A,{children:(0,d.qK)(re)?(0,Z.jsx)(O.A,{size:"small",sx:{minWidth:120,width:"100%"},children:(0,Z.jsxs)(S.A,{value:e.rol||"Sin rol",onChange:r=>(async(e,r)=>{if((0,d.qK)(re))try{const i="Sin rol"===r?{rol:null}:{rol:r};await(0,t.yo)((0,t.KR)(n.OO,"usuarios/".concat(e)),i),c(o.map(o=>o.id===e?(0,a.A)((0,a.A)({},o),{},{rol:"Sin rol"===r?null:r}):o)),l.oR.success("Rol actualizado ".concat("Sin rol"===r?"removido":"a "+r))}catch(i){console.error("Error al actualizar rol:",i),l.oR.error("Error al actualizar rol: "+i.message)}else l.oR.error("No tienes permisos para asignar roles")})(e.id,r.target.value),sx:{bgcolor:"white","& .MuiSelect-select":{py:.5,fontSize:"0.875rem"}},children:[(0,Z.jsx)(I.A,{value:"Sin rol",children:(0,Z.jsx)(A.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,Z.jsx)(z.A,{label:"Sin rol",color:"default",size:"small",sx:{fontSize:"0.75rem"}})})}),(0,Z.jsx)(I.A,{value:d.gg.ADMINISTRADOR,children:(0,Z.jsx)(A.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,Z.jsx)(z.A,{label:"Administrador",color:"error",size:"small",sx:{fontSize:"0.75rem"}})})}),(0,Z.jsx)(I.A,{value:d.gg.MODIFICADOR,children:(0,Z.jsx)(A.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,Z.jsx)(z.A,{label:"Modificador",color:"warning",size:"small",sx:{fontSize:"0.75rem"}})})}),(0,Z.jsx)(I.A,{value:d.gg.VISOR,children:(0,Z.jsx)(A.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,Z.jsx)(z.A,{label:"Visor",color:"info",size:"small",sx:{fontSize:"0.75rem"}})})})]})}):(0,Z.jsx)(w.A,{title:(0,d.MO)(e.rol),children:(0,Z.jsx)(z.A,{label:e.rol||"Sin rol",color:(0,d.m)(e.rol),size:"small",sx:{fontWeight:500,cursor:"help"}})})}),(0,Z.jsx)(y.A,{children:"Practicantes/Crosstraining"===e.departamento?(0,d.qK)(re)?(0,Z.jsxs)(A.A,{children:[(0,Z.jsx)(f.A,{variant:"outlined",size:"small",startIcon:(0,Z.jsx)(J.A,{}),onClick:()=>{return r=e.id,void ne(e=>(0,a.A)((0,a.A)({},e),{},{[r]:!e[r]}));var r},sx:{mb:1,fontSize:"0.75rem"},children:"Autorizar Departamentos"}),te[e.id]&&(0,Z.jsx)(A.A,{sx:{mt:1,maxWidth:200},children:(0,Z.jsx)(C.A,{children:$.map(r=>{var i;return(0,Z.jsx)(D.A,{control:(0,Z.jsx)(k.A,{checked:(null===(i=e.departamentosAutorizados)||void 0===i?void 0:i.includes(r))||!1,onChange:i=>(async(e,r,i)=>{if((0,d.qK)(re))try{const s=o.find(r=>r.id===e);if(!s||"Practicantes/Crosstraining"!==s.departamento)return void l.oR.error("Solo usuarios de Practicantes/Crosstraining pueden tener departamentos autorizados");const d=s.departamentosAutorizados||[];let u;u=i?d.includes(r)?d:[...d,r]:d.filter(e=>e!==r),await(0,t.yo)((0,t.KR)(n.OO,"usuarios/".concat(e)),{departamentosAutorizados:u}),c(o.map(r=>r.id===e?(0,a.A)((0,a.A)({},r),{},{departamentosAutorizados:u}):r)),l.oR.success("Autorizaci\xf3n para ".concat(r," ").concat(i?"agregada":"removida"))}catch(s){console.error("Error al actualizar departamentos autorizados:",s),l.oR.error("Error al actualizar autorizaciones: "+s.message)}else l.oR.error("No tienes permisos para modificar autorizaciones")})(e.id,r,i.target.checked),size:"small"}),label:(0,Z.jsx)(v.A,{variant:"caption",sx:{fontSize:"0.7rem"},children:r}),sx:{margin:0,height:28}},r)})})})]}):(0,Z.jsx)(A.A,{children:(null===(s=e.departamentosAutorizados)||void 0===s?void 0:s.length)>0?e.departamentosAutorizados.map(e=>(0,Z.jsx)(z.A,{label:e,size:"small",color:"primary",variant:"outlined",sx:{mr:.5,mb:.5,fontSize:"0.7rem"}},e)):(0,Z.jsx)(v.A,{variant:"caption",color:"text.secondary",children:"Sin autorizaciones"})}):(0,Z.jsx)(v.A,{variant:"caption",color:"text.secondary",children:"Solo para Practicantes"})}),(0,Z.jsxs)(y.A,{align:"right",children:[(0,Z.jsx)(w.A,{title:"Editar Usuario",children:(0,Z.jsx)(T.A,{onClick:()=>(e=>{ue("/configuracion?userId=".concat(e.id))})(e),color:"primary",size:"small",children:(0,Z.jsx)(U.A,{})})}),Y(re)&&(0,Z.jsx)(w.A,{title:"Eliminar Usuario",children:(0,Z.jsx)(T.A,{onClick:()=>(e=>{ee(e),h(!0)})(e),color:"error",size:"small",children:(0,Z.jsx)(q.A,{})})})]})]},e.id)})})]})}),(null===re||void 0===re?void 0:re.rol)===d.gg.ADMINISTRADOR&&(0,Z.jsxs)(A.A,{sx:{mt:4},children:[(0,Z.jsx)(v.A,{variant:"h6",sx:{color:"var(--primary-color)",fontWeight:"bold",mb:2},children:"Gesti\xf3n de Departamentos Autorizados"}),(0,Z.jsxs)(M.A,{children:[(0,Z.jsx)(E.A,{expandIcon:(0,Z.jsx)(G.A,{}),children:(0,Z.jsx)(v.A,{children:"Departamentos Autorizados"})}),(0,Z.jsxs)(N.A,{children:[(0,Z.jsx)(C.A,{children:$.map(e=>(0,Z.jsx)(D.A,{control:(0,Z.jsx)(k.A,{checked:le.includes(e),onChange:me,value:e,color:"primary"}),label:e},e))}),(0,Z.jsxs)(A.A,{sx:{display:"flex",alignItems:"center",mt:2},children:[(0,Z.jsx)(O.A,{size:"small",sx:{minWidth:120,flexGrow:1,mr:1},children:(0,Z.jsxs)(S.A,{value:de,onChange:e=>ce(e.target.value),displayEmpty:!0,sx:{bgcolor:"white","& .MuiSelect-select":{py:.5,fontSize:"0.875rem"}},children:[(0,Z.jsx)(I.A,{value:"",children:(0,Z.jsx)("em",{children:"Agregar nuevo departamento"})}),$.map(e=>(0,Z.jsx)(I.A,{value:e,children:e},e))]})}),(0,Z.jsx)(f.A,{variant:"contained",color:"primary",onClick:async()=>{if(de&&null!==re&&void 0!==re&&re.id)try{await(0,t.yo)((0,t.KR)(n.OO,"usuarios/".concat(re.id)),{departamentosAutorizados:[...le,de]}),se([...le,de]),ce(""),l.oR.success("Departamento agregado correctamente")}catch(e){console.error("Error al agregar departamento:",e),l.oR.error("Error al agregar departamento: "+e.message)}},disabled:!de,sx:{borderRadius:2,fontWeight:"bold"},children:"Agregar"})]})]})]})]})]}),(0,Z.jsxs)(W.A,{open:u,onClose:he,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,Z.jsx)(K.A,{id:"alert-dialog-title",sx:{color:"var(--error-color)"},children:"Confirmar eliminaci\xf3n"}),(0,Z.jsx)(P.A,{children:(0,Z.jsxs)(F.A,{id:"alert-dialog-description",children:["\xbfEst\xe1s seguro de que deseas eliminar al usuario ",null===H||void 0===H?void 0:H.nombre," ",null===H||void 0===H?void 0:H.apellidos,"? Esta acci\xf3n no se puede deshacer."]})}),(0,Z.jsxs)(V.A,{children:[(0,Z.jsx)(f.A,{onClick:he,color:"primary",children:"Cancelar"}),(0,Z.jsx)(f.A,{onClick:async()=>{if(H)try{await(0,t.TF)((0,t.KR)(n.OO,"usuarios/".concat(H.id))),c(o.filter(e=>e.id!==H.id)),l.oR.success("Usuario eliminado correctamente"),he()}catch(e){console.error("Error al eliminar usuario:",e),l.oR.error("Error al eliminar usuario: "+e.message)}},color:"error",autoFocus:!0,children:"Eliminar"})]})]})]});var Ae}}}]);
//# sourceMappingURL=525.55fea4c2.chunk.js.map