"use strict";(self.webpackChunkcostaricacc_horarios=self.webpackChunkcostaricacc_horarios||[]).push([[607],{6581:(a,e,o)=>{o.d(e,{A1:()=>r,Kj:()=>t,VF:()=>l,hu:()=>i,yQ:()=>n});const r=["Planeaci\xf3n de Eventos","Gesti\xf3n de la Protecci\xf3n","\xc1reas & Sostenibilidad","Gastronom\xeda","Infraestructura","Financiero","Oficina de Atenci\xf3n al Expositor","Practicantes/Crosstraining","Talento Humano","Calidad","Sistemas","Mercadeo y Ventas","Compras","Gerencia de Operaciones","Gerencia General","UDEI"],i=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"],l=["descanso","vacaciones","feriado","permiso","dia-brigada","fuera-oficina","incapacidad-enfermedad","incapacidad-accidente"],n={dia1:"Lunes",dia2:"Martes",dia3:"Mi\xe9rcoles",dia4:"Jueves",dia5:"Viernes",dia6:"S\xe1bado",dia7:"Domingo"},t={personalizado:"Presencial",teletrabajo:"Teletrabajo",cambio:"Cambio",descanso:"Descanso",vacaciones:"Vacaciones",feriado:"Feriado",permiso:"Permiso","tarde-libre":"Tarde Libre","dia-brigada":"Brigada","fuera-oficina":"Fuera de Oficina","viaje-trabajo":"Viaje de Trabajo","incapacidad-enfermedad":"Incapacidad por Enfermedad","incapacidad-accidente":"Incapacidad por Accidente","tele-presencial":"Teletrabajo & Presencial"}},6984:(a,e,o)=>{o.d(e,{FW:()=>m,MJ:()=>s,MO:()=>p,Nf:()=>t,RK:()=>r,VO:()=>c,bW:()=>n,gg:()=>i,m:()=>u,qK:()=>d});const r={OPERATIVO:"Operativo",CONFIANZA:"Confianza"},i={ADMINISTRADOR:"Administrador",MODIFICADOR:"Modificador",VISOR:"Visor"},l={[r.OPERATIVO]:48,[r.CONFIANZA]:72},n=a=>l[a]||l[r.OPERATIVO],t=a=>{const e=n(a);return"Los empleados de tipo ".concat(a," tienen un l\xedmite de ").concat(e," horas semanales.")},s=a=>"Talento Humano"===(null===a||void 0===a?void 0:a.departamento),d=a=>(null===a||void 0===a?void 0:a.rol)===i.ADMINISTRADOR||"Talento Humano"===(null===a||void 0===a?void 0:a.departamento)||"admin@costaricacc.com"===(null===a||void 0===a?void 0:a.email),c=function(a){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===a||void 0===a?void 0:a.rol)===i.ADMINISTRADOR||((null===a||void 0===a?void 0:a.rol)===i.MODIFICADOR||(null===a||void 0===a?void 0:a.rol)===i.VISOR?!e||(null===a||void 0===a?void 0:a.departamento)===(null===e||void 0===e?void 0:e.departamento):"Talento Humano"===(null===a||void 0===a?void 0:a.departamento)||"admin@costaricacc.com"===(null===a||void 0===a?void 0:a.email))},m=a=>(null===a||void 0===a?void 0:a.rol)===i.ADMINISTRADOR||"Talento Humano"===(null===a||void 0===a?void 0:a.departamento)||"admin@costaricacc.com"===(null===a||void 0===a?void 0:a.email),u=a=>{switch(a){case i.ADMINISTRADOR:return"error";case i.MODIFICADOR:return"warning";case i.VISOR:return"info";default:return"default"}},p=a=>{switch(a){case i.ADMINISTRADOR:return"Puede realizar todos los cambios en la plataforma";case i.MODIFICADOR:return"Puede modificar horarios de su departamento";case i.VISOR:return"Solo puede ver horarios, sin modificaciones";default:return"Sin rol espec\xedfico asignado"}}},8607:(a,e,o)=>{o.r(e),o.d(e,{default:()=>J});var r=o(6832),i=o(2660),l=o(6857),n=o(2076),t=o(3106),s=o(8359),d=o(4550),c=o(6984),m=o(8621),u=o(4184),p=o(5515),A=o(2260),x=o(6647),v=o(4159),h=o(5857),b=o(6347),j=o(7237),g=o(2757),f=o(2729),C=o(4909),y=o(6534),O=o(1608),I=o(6121),R=o(9147),S=o(3009),w=o(6019),D=o(5376),P=o(9686),M=o(7735),T=o(2244),E=o(9043),W=o(6961),V=o(6024),z=o(2256),N=o(6581),F=o(632);const k=(0,T.Ay)(m.A)(a=>{let{theme:e}=a;return{padding:e.spacing(3),borderRadius:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)"}}),H=[{value:null,label:"Sin rol"},{value:c.gg.ADMINISTRADOR,label:"Administrador"},{value:c.gg.MODIFICADOR,label:"Modificador"},{value:c.gg.VISOR,label:"Visor"}],J=()=>{const[a,e]=(0,i.useState)(!0),[o,m]=(0,i.useState)(0),[T,J]=(0,i.useState)(null),[K,B]=(0,i.useState)(null),[G,L]=(0,i.useState)(!1),[U,q]=(0,i.useState)([]),[Z,_]=(0,i.useState)(null),[Q,X]=(0,i.useState)({nombre:"",apellidos:"",email:"",cargo:"",departamento:"",tipoContrato:"",rol:""}),[Y,$]=(0,i.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[aa,ea]=(0,i.useState)(!1),[oa,ra]=(0,i.useState)(""),[ia,la]=(0,i.useState)(null),[na,ta]=(0,i.useState)(""),sa=(0,s.Zp)(),da=(0,s.zy)(),ca=new URLSearchParams(da.search).get("userId");(0,i.useEffect)(()=>{(async()=>{try{e(!0);const a=t.j2.currentUser;if(!a)return void sa("/");J(a);const o=(0,l.KR)(t.OO,"usuarios/".concat(a.uid)),i=(await(0,l.Jt)(o)).val();if(B(i),L((null===i||void 0===i?void 0:i.rol)===c.gg.ADMINISTRADOR||"Talento Humano"===(null===i||void 0===i?void 0:i.departamento)||"admin@costaricacc.com"===(null===i||void 0===i?void 0:i.email)),(null===i||void 0===i?void 0:i.rol)===c.gg.ADMINISTRADOR||"Talento Humano"===(null===i||void 0===i?void 0:i.departamento)||"admin@costaricacc.com"===(null===i||void 0===i?void 0:i.email)){const a=(0,l.KR)(t.OO,"usuarios"),e=await(0,l.Jt)(a);if(e.exists()){const a=e.val(),o=Object.entries(a).map(a=>{let[e,o]=a;return(0,r.A)((0,r.A)({id:e},o),{},{tipoContrato:o.tipoContrato||"Operativo"})});if(q(o),ca){const a=o.find(a=>a.id===ca);a&&(_(a),X({nombre:a.nombre||"",apellidos:a.apellidos||"",email:a.email||"",cargo:a.cargo||"",departamento:a.departamento||"",tipoContrato:a.tipoContrato||"Operativo",rol:a.rol||null}),m(2))}}}ca||X({nombre:(null===i||void 0===i?void 0:i.nombre)||"",apellidos:(null===i||void 0===i?void 0:i.apellidos)||"",email:(null===i||void 0===i?void 0:i.email)||"",cargo:(null===i||void 0===i?void 0:i.cargo)||"",departamento:(null===i||void 0===i?void 0:i.departamento)||"",tipoContrato:(null===i||void 0===i?void 0:i.tipoContrato)||"Operativo",rol:(null===i||void 0===i?void 0:i.rol)||null})}catch(na){console.error("Error al cargar datos:",na),d.oR.error("Error al cargar datos: "+na.message)}finally{e(!1)}})()},[sa,ca,null===T||void 0===T?void 0:T.uid]);const ma=a=>{const{name:e,value:o}=a.target;if(e&&void 0!==o){const a="rol"===e&&"Sin rol"===o?null:o;X(o=>(0,r.A)((0,r.A)({},o),{},{[e]:a}))}},ua=a=>{const{name:e,value:o}=a.target;$((0,r.A)((0,r.A)({},Y),{},{[e]:o}))},pa=async()=>{try{e(!0),ta("");const a=ca||(Z?Z.id:T.uid),o=(0,l.KR)(t.OO,"usuarios/".concat(a)),i=(0,r.A)({nombre:Q.nombre,apellidos:Q.apellidos,cargo:Q.cargo,departamento:Q.departamento},(0,c.qK)(K)&&{rol:Q.rol});if((0,c.MJ)(K)&&(i.tipoContrato=Q.tipoContrato),await(0,l.yo)(o,i),Q.email!==(Z?Z.email:K.email)){if(a===T.uid)return la("email"),void ea(!0);G&&await(0,l.yo)(o,{email:Q.email})}d.oR.success("Perfil actualizado correctamente"),a===T.uid?B((0,r.A)((0,r.A)({},K),Q)):Z&&(q(U.map(a=>a.id===Z.id?(0,r.A)((0,r.A)({},a),Q):a)),_((0,r.A)((0,r.A)({},Z),Q)))}catch(na){console.error("Error al actualizar perfil:",na),ta("Error al actualizar perfil: "+na.message),d.oR.error("Error al actualizar perfil: "+na.message)}finally{e(!1)}};return a&&!K?(0,F.jsx)(u.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:(0,F.jsx)(p.A,{})}):(0,F.jsxs)(A.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,F.jsx)(x.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"var(--primary-color)"},children:"Configuraci\xf3n"}),(0,F.jsxs)(k,{sx:{mt:3},children:[(0,F.jsxs)(v.A,{value:o,onChange:(a,e)=>{m(e),2!==e&&K&&(_(null),X({nombre:K.nombre||"",apellidos:K.apellidos||"",email:K.email||"",cargo:K.cargo||"",departamento:K.departamento||"",tipoContrato:K.tipoContrato||"Operativo",rol:K.rol||null}),sa("/configuracion"))},variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider",mb:3},children:[(0,F.jsx)(h.A,{icon:(0,F.jsx)(V.A,{}),label:"Perfil",sx:{"&.Mui-selected":{color:"var(--primary-color)"}}}),(0,F.jsx)(h.A,{icon:(0,F.jsx)(W.A,{}),label:"Contrase\xf1a",sx:{"&.Mui-selected":{color:"var(--primary-color)"}}}),G&&(0,F.jsx)(h.A,{icon:(0,F.jsx)(z.A,{}),label:"Administraci\xf3n",sx:{"&.Mui-selected":{color:"var(--primary-color)"}}})]}),na&&(0,F.jsx)(b.A,{severity:"error",sx:{mb:3},children:na}),0===o&&(0,F.jsxs)(u.A,{children:[(0,F.jsx)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"var(--primary-color)"},children:"Informaci\xf3n Personal"}),(0,F.jsxs)(j.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Nombre",name:"nombre",value:Q.nombre,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Apellidos",name:"apellidos",value:Q.apellidos,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Correo Electr\xf3nico",name:"email",type:"email",value:Q.email,InputProps:{readOnly:!0},disabled:!0,helperText:"El correo electr\xf3nico no puede ser modificado",margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Cargo",name:"cargo",value:Q.cargo,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsxs)(f.A,{fullWidth:!0,margin:"normal",children:[(0,F.jsx)(C.A,{id:"departamento-label",children:"Departamento"}),(0,F.jsx)(y.A,{labelId:"departamento-label",name:"departamento",value:Q.departamento,onChange:ma,label:"Departamento",children:N.A1.map(a=>(0,F.jsx)(O.A,{value:a,children:a},a))})]})}),(0,F.jsxs)(j.Ay,{item:!0,xs:12,children:[(0,F.jsxs)(f.A,{fullWidth:!0,margin:"normal",children:[(0,F.jsx)(C.A,{id:"tipo-contrato-label",children:"Tipo de Contrato"}),(0,F.jsxs)(y.A,{labelId:"tipo-contrato-label",name:"tipoContrato",value:Q.tipoContrato,onChange:ma,label:"Tipo de Contrato",disabled:!(0,c.MJ)(K),children:[(0,F.jsx)(O.A,{value:"Operativo",children:"Operativo (48 horas semanales)"}),(0,F.jsx)(O.A,{value:"Confianza",children:"Confianza (72 horas semanales)"})]})]}),!(0,c.MJ)(K)&&(0,F.jsx)(x.A,{variant:"caption",color:"textSecondary",sx:{mt:1,display:"block"},children:"Solo Talento Humano puede modificar este campo"})]}),(0,F.jsx)(j.Ay,{item:!0,xs:12,children:(0,F.jsx)(I.A,{variant:"contained",color:"primary",startIcon:(0,F.jsx)(E.A,{}),onClick:pa,disabled:a,sx:{mt:2,borderRadius:"8px"},children:a?(0,F.jsx)(p.A,{size:24}):"Guardar Cambios"})})]})]}),1===o&&(0,F.jsxs)(u.A,{children:[(0,F.jsx)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"var(--primary-color)"},children:"Cambiar Contrase\xf1a"}),(0,F.jsxs)(j.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(j.Ay,{item:!0,xs:12,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Contrase\xf1a Actual",name:"currentPassword",type:"password",value:Y.currentPassword,onChange:ua,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Nueva Contrase\xf1a",name:"newPassword",type:"password",value:Y.newPassword,onChange:ua,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Confirmar Nueva Contrase\xf1a",name:"confirmPassword",type:"password",value:Y.confirmPassword,onChange:ua,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,children:(0,F.jsx)(I.A,{variant:"contained",color:"primary",startIcon:(0,F.jsx)(W.A,{}),onClick:async()=>{const{newPassword:a,confirmPassword:o}=Y;if(a===o)if(a.length<6)ta("La contrase\xf1a debe tener al menos 6 caracteres");else try{e(!0),ta(""),la("password"),ea(!0)}catch(na){console.error("Error al cambiar contrase\xf1a:",na),ta("Error al cambiar contrase\xf1a: "+na.message),d.oR.error("Error al cambiar contrase\xf1a: "+na.message)}finally{e(!1)}else ta("Las contrase\xf1as no coinciden")},disabled:a,sx:{mt:2,borderRadius:"8px"},children:a?(0,F.jsx)(p.A,{size:24}):"Cambiar Contrase\xf1a"})})]})]}),2===o&&G&&(0,F.jsxs)(u.A,{children:[(0,F.jsx)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"var(--primary-color)"},children:"Administraci\xf3n de Usuarios"}),(0,F.jsxs)(f.A,{fullWidth:!0,margin:"normal",sx:{mb:3},children:[(0,F.jsx)(C.A,{id:"usuario-select-label",children:"Seleccionar Usuario"}),(0,F.jsx)(y.A,{labelId:"usuario-select-label",value:Z?Z.id:"",onChange:a=>{const e=a.target.value,o=U.find(a=>a.id===e);_(o),X({nombre:o.nombre||"",apellidos:o.apellidos||"",email:o.email||"",cargo:o.cargo||"",departamento:o.departamento||"",tipoContrato:o.tipoContrato||"Operativo",rol:o.rol||null})},label:"Seleccionar Usuario",children:U.map(a=>(0,F.jsxs)(O.A,{value:a.id,children:[a.nombre," ",a.apellidos," - ",a.email]},a.id))})]}),Z&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(R.A,{sx:{my:2}}),(0,F.jsxs)(x.A,{variant:"subtitle1",gutterBottom:!0,children:["Editando a: ",Z.nombre," ",Z.apellidos]}),(0,F.jsxs)(j.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Nombre",name:"nombre",value:Q.nombre,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Apellidos",name:"apellidos",value:Q.apellidos,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Correo Electr\xf3nico",name:"email",type:"email",value:Q.email,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsx)(g.A,{fullWidth:!0,label:"Cargo",name:"cargo",value:Q.cargo,onChange:ma,margin:"normal",variant:"outlined"})}),(0,F.jsx)(j.Ay,{item:!0,xs:12,sm:6,children:(0,F.jsxs)(f.A,{fullWidth:!0,margin:"normal",children:[(0,F.jsx)(C.A,{id:"departamento-label",children:"Departamento"}),(0,F.jsx)(y.A,{labelId:"departamento-label",name:"departamento",value:Q.departamento,onChange:ma,label:"Departamento",children:N.A1.map(a=>(0,F.jsx)(O.A,{value:a,children:a},a))})]})}),(0,F.jsxs)(j.Ay,{item:!0,xs:12,sm:6,children:[(0,F.jsxs)(f.A,{fullWidth:!0,margin:"normal",children:[(0,F.jsx)(C.A,{id:"tipo-contrato-admin-label",children:"Tipo de Contrato"}),(0,F.jsxs)(y.A,{labelId:"tipo-contrato-admin-label",name:"tipoContrato",value:Q.tipoContrato,onChange:ma,label:"Tipo de Contrato",disabled:!(0,c.MJ)(K),children:[(0,F.jsx)(O.A,{value:"Operativo",children:"Operativo (48 horas semanales)"}),(0,F.jsx)(O.A,{value:"Confianza",children:"Confianza (72 horas semanales)"})]})]}),!(0,c.MJ)(K)&&(0,F.jsx)(x.A,{variant:"caption",color:"textSecondary",sx:{mt:1,display:"block"},children:"Solo Talento Humano puede modificar este campo"})]}),(0,F.jsxs)(j.Ay,{item:!0,xs:12,sm:6,children:[(0,F.jsxs)(f.A,{fullWidth:!0,margin:"normal",children:[(0,F.jsx)(C.A,{id:"rol-label",children:"Rol"}),(0,F.jsx)(y.A,{labelId:"rol-label",name:"rol",value:Q.rol||"Sin rol",onChange:ma,label:"Rol",disabled:!(0,c.qK)(K),children:H.map(a=>(0,F.jsx)(O.A,{value:a.value||"Sin rol",children:a.label},a.value||"Sin rol"))})]}),!(0,c.qK)(K)&&(0,F.jsx)(x.A,{variant:"caption",color:"textSecondary",sx:{mt:1,display:"block"},children:"Solo Administradores y Talento Humano pueden modificar roles"})]}),(0,F.jsx)(j.Ay,{item:!0,xs:12,children:(0,F.jsx)(I.A,{variant:"contained",color:"primary",startIcon:(0,F.jsx)(E.A,{}),onClick:pa,disabled:a,sx:{mt:2,borderRadius:"8px"},children:a?(0,F.jsx)(p.A,{size:24}):"Guardar Cambios"})})]})]})]})]}),(0,F.jsxs)(S.A,{open:aa,onClose:()=>ea(!1),children:[(0,F.jsx)(w.A,{children:"Verificaci\xf3n de seguridad"}),(0,F.jsxs)(D.A,{children:[(0,F.jsx)(P.A,{children:"Para continuar, por favor ingresa tu contrase\xf1a actual para verificar tu identidad."}),(0,F.jsx)(g.A,{autoFocus:!0,margin:"dense",label:"Contrase\xf1a actual",type:"password",fullWidth:!0,variant:"outlined",value:oa,onChange:a=>ra(a.target.value)})]}),(0,F.jsxs)(M.A,{children:[(0,F.jsx)(I.A,{onClick:()=>ea(!1),color:"primary",children:"Cancelar"}),(0,F.jsx)(I.A,{onClick:async()=>{try{e(!0);const a=n.IX.credential(T.email,oa);await(0,n.kZ)(T,a),"email"===ia?(await(0,n.Ww)(T,Q.email),await(0,l.yo)((0,l.KR)(t.OO,"usuarios/".concat(T.uid)),{email:Q.email}),d.oR.success("Email actualizado correctamente")):"password"===ia&&(await(0,n.f3)(T,Y.newPassword),d.oR.success("Contrase\xf1a actualizada correctamente"),$({currentPassword:"",newPassword:"",confirmPassword:""})),ea(!1),ra(""),la(null)}catch(na){console.error("Error en la reautenticaci\xf3n:",na),ta("Error en la reautenticaci\xf3n: "+na.message),d.oR.error("Error en la reautenticaci\xf3n: "+na.message)}finally{e(!1)}},color:"primary",disabled:a,children:a?(0,F.jsx)(p.A,{size:24}):"Verificar"})]})]})]})}}}]);
//# sourceMappingURL=607.9ab2ac65.chunk.js.map