"use strict";(self.webpackChunkcostaricacc_horarios=self.webpackChunkcostaricacc_horarios||[]).push([[283],{6581:(e,a,o)=>{o.d(a,{A1:()=>s,Kj:()=>n,VF:()=>i,hu:()=>r,yQ:()=>t});const s=["Planeaci\xf3n de Eventos","Gesti\xf3n de la Protecci\xf3n","\xc1reas & Sostenibilidad","Gastronom\xeda","Infraestructura","Financiero","Oficina de Atenci\xf3n al Expositor","Practicantes/Crosstraining","Talento Humano","Calidad","Sistemas","Mercadeo y Ventas","Compras","Gerencia de Operaciones","Gerencia General","UDEI"],r=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"],i=["descanso","vacaciones","feriado","permiso","dia-brigada","fuera-oficina","incapacidad-enfermedad","incapacidad-accidente"],t={dia1:"Lunes",dia2:"Martes",dia3:"Mi\xe9rcoles",dia4:"Jueves",dia5:"Viernes",dia6:"S\xe1bado",dia7:"Domingo"},n={personalizado:"Presencial",teletrabajo:"Teletrabajo",cambio:"Cambio",descanso:"Descanso",vacaciones:"Vacaciones",feriado:"Feriado",permiso:"Permiso","tarde-libre":"Tarde Libre","dia-brigada":"Brigada","fuera-oficina":"Fuera de Oficina","viaje-trabajo":"Viaje de Trabajo","incapacidad-enfermedad":"Incapacidad por Enfermedad","incapacidad-accidente":"Incapacidad por Accidente","tele-presencial":"Teletrabajo & Presencial"}},6984:(e,a,o)=>{o.d(a,{FW:()=>x,MJ:()=>c,MO:()=>m,Nf:()=>n,RK:()=>s,VO:()=>d,bW:()=>t,gg:()=>r,m:()=>h,qK:()=>l});const s={OPERATIVO:"Operativo",CONFIANZA:"Confianza"},r={ADMINISTRADOR:"Administrador",MODIFICADOR:"Modificador",VISOR:"Visor"},i={[s.OPERATIVO]:48,[s.CONFIANZA]:72},t=e=>i[e]||i[s.OPERATIVO],n=e=>{const a=t(e);return"Los empleados de tipo ".concat(e," tienen un l\xedmite de ").concat(a," horas semanales.")},c=e=>"Talento Humano"===(null===e||void 0===e?void 0:e.departamento),l=e=>(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),d=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||((null===e||void 0===e?void 0:e.rol)===r.MODIFICADOR||(null===e||void 0===e?void 0:e.rol)===r.VISOR?!a||(null===e||void 0===e?void 0:e.departamento)===(null===a||void 0===a?void 0:a.departamento):"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email))},x=e=>(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),h=e=>{switch(e){case r.ADMINISTRADOR:return"error";case r.MODIFICADOR:return"warning";case r.VISOR:return"info";default:return"default"}},m=e=>{switch(e){case r.ADMINISTRADOR:return"Puede realizar todos los cambios en la plataforma";case r.MODIFICADOR:return"Puede modificar horarios de su departamento";case r.VISOR:return"Solo puede ver horarios, sin modificaciones";default:return"Sin rol espec\xedfico asignado"}}},9283:(e,a,o)=>{o.r(a),o.d(a,{default:()=>q});var s=o(6832),r=o(2660),i=o(6857),t=o(3106),n=o(8359),c=o(6984),l=o(4184),d=o(5515),x=o(2260),h=o(6647),m=o(7237),p=o(8621),u=o(9147),b=o(2184),A=o(2768),j=o(279),f=o(3870),v=o(3672),y=o(8629),g=o(780),O=o(7858),R=o(4155),S=o(8164),I=o(3164),D=o(5089),T=o(187),C=o(7037),w=o(6455),F=o(5619),M=o(4454),N=o(8377),k=o(1112),W=o(3568),P=o(7203),V=o(436),E=o(4201),K=o(4153),H=o(2676),J=o(7250),U=o(1110),B=o(1296),z=o(8217),L=o(6581),G=o(632);const _={presencial:"#3f51b5",teletrabajo:"#2e7d32",cambio:"#f57c00",descanso:"#9e9e9e",vacaciones:"#ff9800",feriado:"#f44336",permiso:"#9c27b0","tarde-libre":"#607d8b"},Z=["#3f51b5","#2e7d32","#f57c00","#ff9800","#9e9e9e","#f44336","#9c27b0","#607d8b"],q=()=>{var e;const[a,o]=(0,r.useState)(null),[q,Q]=(0,r.useState)(!0),[X,Y]=(0,r.useState)(0),[$,ee]=(0,r.useState)(40),[ae,oe]=(0,r.useState)({semanaActual:{},ultimasSemanas:[],distribucionTipos:[],rendimientoSemanal:[]}),[se,re]=(0,r.useState)([]),[ie,te]=(0,r.useState)([]),ne=(0,n.Zp)(),ce=(0,r.useCallback)(e=>{const a=(0,K.A)(e),o=(0,H.A)(e);return"".concat(a,"-").concat(o)},[]),le=(0,r.useCallback)(async e=>{try{const a=(0,J.A)(new Date,{weekStartsOn:1}),o={semanaActual:{},ultimasSemanas:[],distribucionTipos:[],rendimientoSemanal:[]},r=[];for(let e=0;e<8;e++){const o=(0,U.A)(a,e),s=ce(o);r.push({fecha:o,claveSemana:s})}const n=r.map(async a=>{let{fecha:o,claveSemana:s}=a;const r=(0,i.KR)(t.OO,"horarios_registros/".concat(s,"/").concat(e)),n=await(0,i.Jt)(r);return{fecha:o,claveSemana:s,horarios:n.exists()?n.val():{}}}),c=await Promise.all(n),l=c[0];if(l.horarios){const e={};let a=0;Object.values(l.horarios).forEach(o=>{o&&o.tipo&&(e[o.tipo]=(e[o.tipo]||0)+(o.horas||0),["descanso","vacaciones","feriado","permiso","tarde-libre"].includes(o.tipo)||(a+=o.horas||0))}),o.semanaActual={tipos:e,horasTotales:a}}const d={},x=[];return c.forEach(e=>{let{fecha:a,horarios:o}=e,r=0;const i={};Object.values(o).forEach(e=>{e&&e.tipo&&(d[e.tipo]=(d[e.tipo]||0)+1,i[e.tipo]=(i[e.tipo]||0)+(e.horas||0),["descanso","vacaciones","feriado","permiso","tarde-libre"].includes(e.tipo)||(r+=e.horas||0))}),x.push((0,s.A)({semana:(0,B.A)(a,"dd/MM",{locale:z.A}),horas:r},i))}),o.distribucionTipos=Object.entries(d).map(e=>{let[a,o]=e;return{name:a.charAt(0).toUpperCase()+a.slice(1),value:o,color:_[a]||Z[Object.keys(d).indexOf(a)%Z.length]}}),o.rendimientoSemanal=x.reverse(),o}catch(a){return console.error("Error al procesar estad\xedsticas:",a),{semanaActual:{},ultimasSemanas:[],distribucionTipos:[],rendimientoSemanal:[]}}},[ce]);return(0,r.useEffect)(()=>{(async()=>{try{const e=t.j2.currentUser;if(!e)return void ne("/");const a=(0,i.KR)(t.OO,"usuarios/".concat(e.uid)),r=(0,i.KR)(t.OO,"horas_extras"),[n,l]=await Promise.all([(0,i.Jt)(a),(0,i.Jt)(r)]);if(n.exists()){const a=n.val();o(a);const s=(l.exists()?l.val():{})[e.uid]||0;Y(s);const r=(0,c.bW)((null===a||void 0===a?void 0:a.tipoContrato)||"Operativo"),i=Math.max(.8*r,30);ee(Math.max(r-s,i));const t=await le(e.uid);oe(t)}else console.log("No se encontraron datos del usuario");const d=(0,i.KR)(t.OO,"usuarios"),x=await(0,i.Jt)(d),h=x.exists()?Object.entries(x.val()).map(e=>{let[a,o]=e;return(0,s.A)({id:a},o)}):[],m=new Date,p=ce(m),u=0===m.getDay()?7:m.getDay(),b=(0,i.KR)(t.OO,"horarios_registros/".concat(p)),A=await(0,i.Jt)(b),j=A.exists()?A.val():{},f=h.filter(e=>{const a=(j[e.id]||{})["dia".concat(u)];return a&&L.VF.includes(a.tipo)}),v=h.filter(e=>{const a=(j[e.id]||{})["dia".concat(u)];return a&&"teletrabajo"===a.tipo});re(f),te(v)}catch(e){console.error("Error al cargar datos:",e)}finally{Q(!1)}})()},[ne,le,ce]),q?(0,G.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:(0,G.jsx)(d.A,{})}):(0,G.jsxs)(x.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,G.jsx)(h.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"var(--primary-color)"},children:"Dashboard"}),(0,G.jsxs)(h.A,{variant:"subtitle1",gutterBottom:!0,sx:{mb:4,color:"var(--text-secondary)"},children:["Bienvenido, ",null===a||void 0===a?void 0:a.nombre," ",null===a||void 0===a?void 0:a.apellidos]}),(0,G.jsxs)(m.Ay,{container:!0,spacing:4,children:[(0,G.jsx)(m.Ay,{item:!0,xs:12,children:(0,G.jsxs)(p.A,{sx:{p:3,display:"flex",flexDirection:"column",borderRadius:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)",mb:3},children:[(0,G.jsx)(h.A,{variant:"h6",gutterBottom:!0,sx:{color:"var(--primary-color)"},children:"Informaci\xf3n de Departamento"}),(0,G.jsx)(u.A,{sx:{mb:2}}),(0,G.jsxs)(l.A,{sx:{mb:2},children:[(0,G.jsxs)(h.A,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Departamento: ",(0,G.jsx)("span",{style:{color:"var(--primary-color)"},children:null===a||void 0===a?void 0:a.departamento})]}),(0,G.jsxs)(h.A,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Cargo: ",(0,G.jsx)("span",{style:{color:"var(--primary-color)"},children:null===a||void 0===a?void 0:a.cargo})]}),X>0&&(0,G.jsxs)(l.A,{sx:{mt:2,p:2,bgcolor:"#fff9c4",borderRadius:"8px"},children:[(0,G.jsxs)(h.A,{variant:"subtitle1",sx:{fontWeight:"bold",color:"#f57c00"},children:["Horas extras acumuladas: ",X.toFixed(1),"h"]}),(0,G.jsxs)(h.A,{variant:"body2",children:["Horas disponibles para la pr\xf3xima semana: ",(0,G.jsxs)("strong",{children:[$.toFixed(1),"h"]})," (de las ",(0,c.bW)((null===a||void 0===a?void 0:a.tipoContrato)||"Operativo"),"h seg\xfan tu contrato ",(null===a||void 0===a?void 0:a.tipoContrato)||"Operativo",")"]}),(0,G.jsx)(h.A,{variant:"caption",sx:{display:"block",mt:1,color:"text.secondary"},children:"Las horas extras se restar\xe1n autom\xe1ticamente de tu asignaci\xf3n para la pr\xf3xima semana seg\xfan las horas de tu tipo de contrato."})]})]}),(0,G.jsx)(h.A,{variant:"body2",color:"text.secondary",children:"Accede a los m\xf3dulos del sistema utilizando el men\xfa de navegaci\xf3n superior."})]})}),(0,G.jsx)(m.Ay,{item:!0,xs:12,children:(0,G.jsxs)(b.A,{sx:{mb:3,borderRadius:"16px",boxShadow:"0 8px 24px rgba(0,0,0,0.1)"},children:[(0,G.jsx)(A.A,{avatar:(0,G.jsx)(R.A,{color:"primary"}),title:"Usuarios Fuera de Oficina hoy",titleTypographyProps:{variant:"h6",sx:{color:"var(--primary-color)"}},sx:{bgcolor:"#f5f5f5",pb:0}}),(0,G.jsx)(j.A,{sx:{pt:1},children:se.length>0?(0,G.jsx)(m.Ay,{container:!0,spacing:2,children:se.map(e=>(0,G.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,G.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",p:1,bgcolor:"#f9f9f9",borderRadius:"8px"},children:[(0,G.jsx)(f.A,{sx:{bgcolor:"var(--primary-color)",mr:2},children:e.nombre.charAt(0)}),(0,G.jsxs)(l.A,{sx:{textAlign:"left"},children:[(0,G.jsx)(h.A,{variant:"body1",sx:{fontWeight:"bold"},children:"".concat(e.nombre," ").concat(e.apellidos)}),(0,G.jsx)(h.A,{variant:"body2",color:"text.secondary",children:e.departamento})]})]})},e.id))}):(0,G.jsx)(h.A,{variant:"body2",color:"text.secondary",children:"Ning\xfan usuario est\xe1 fuera de oficina hoy."})})]})}),(0,G.jsx)(m.Ay,{item:!0,xs:12,children:(0,G.jsxs)(b.A,{sx:{mb:3,borderRadius:"16px",boxShadow:"0 8px 24px rgba(0,0,0,0.1)"},children:[(0,G.jsx)(A.A,{avatar:(0,G.jsx)(S.A,{color:"primary"}),title:"Usuarios en Teletrabajo hoy",titleTypographyProps:{variant:"h6",sx:{color:"var(--primary-color)"}},sx:{bgcolor:"#f5f5f5",pb:0}}),(0,G.jsx)(j.A,{sx:{pt:1},children:ie.length>0?(0,G.jsx)(m.Ay,{container:!0,spacing:2,children:ie.map(e=>(0,G.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,G.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",p:1,bgcolor:"#f9f9f9",borderRadius:"8px"},children:[(0,G.jsx)(f.A,{sx:{bgcolor:"var(--primary-color)",mr:2},children:e.nombre.charAt(0)}),(0,G.jsxs)(l.A,{sx:{textAlign:"left"},children:[(0,G.jsx)(h.A,{variant:"body1",sx:{fontWeight:"bold"},children:"".concat(e.nombre," ").concat(e.apellidos)}),(0,G.jsx)(h.A,{variant:"body2",color:"text.secondary",children:e.departamento})]})]})},e.id))}):(0,G.jsx)(h.A,{variant:"body2",color:"text.secondary",children:"Ning\xfan usuario est\xe1 en teletrabajo hoy."})})]})}),(0,G.jsx)(m.Ay,{item:!0,xs:12,children:(0,G.jsxs)(p.A,{sx:{p:3,borderRadius:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.1)",mb:3},children:[(0,G.jsxs)(h.A,{variant:"h5",gutterBottom:!0,sx:{color:"var(--primary-color)",mb:3,display:"flex",alignItems:"center"},children:[(0,G.jsx)(y.A,{sx:{mr:1}}),"Estad\xedsticas de Rendimiento"]}),(0,G.jsxs)(m.Ay,{container:!0,spacing:3,children:[(0,G.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,G.jsxs)(b.A,{sx:{height:"400px",borderRadius:"12px"},children:[(0,G.jsx)(A.A,{title:"Distribuci\xf3n de Asignaciones",avatar:(0,G.jsx)(g.A,{}),sx:{bgcolor:"#f5f5f5"}}),(0,G.jsx)(j.A,{sx:{height:"300px"},children:ae.distribucionTipos.length>0?(0,G.jsx)(I.u,{width:"100%",height:"100%",children:(0,G.jsxs)(D.r,{children:[(0,G.jsx)(T.F,{data:ae.distribucionTipos,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:a,percent:o}=e;return"".concat(a," ").concat((100*o).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:ae.distribucionTipos.map((e,a)=>(0,G.jsx)(C.f,{fill:e.color},"cell-".concat(a)))}),(0,G.jsx)(w.m,{})]})}):(0,G.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,G.jsx)(h.A,{color:"text.secondary",children:"No hay datos disponibles"})})})]})}),(0,G.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,G.jsxs)(b.A,{sx:{height:"400px",borderRadius:"12px"},children:[(0,G.jsx)(A.A,{title:"Horas Trabajadas por Semana",avatar:(0,G.jsx)(O.A,{}),sx:{bgcolor:"#f5f5f5"}}),(0,G.jsx)(j.A,{sx:{height:"300px"},children:ae.rendimientoSemanal.length>0?(0,G.jsx)(I.u,{width:"100%",height:"100%",children:(0,G.jsxs)(F.E,{data:ae.rendimientoSemanal,children:[(0,G.jsx)(M.d,{strokeDasharray:"3 3"}),(0,G.jsx)(N.W,{dataKey:"semana"}),(0,G.jsx)(k.h,{}),(0,G.jsx)(w.m,{formatter:(e,a)=>["".concat(null===e||void 0===e?void 0:e.toFixed(1),"h"),"horas"===a?"Horas Totales":a.charAt(0).toUpperCase()+a.slice(1)]}),(0,G.jsx)(W.s,{}),(0,G.jsx)(P.y,{dataKey:"horas",fill:"#3f51b5",name:"Horas Totales"})]})}):(0,G.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,G.jsx)(h.A,{color:"text.secondary",children:"No hay datos disponibles"})})})]})}),(0,G.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,G.jsxs)(b.A,{sx:{height:"400px",borderRadius:"12px"},children:[(0,G.jsx)(A.A,{title:"Tendencia de Horas por Tipo",avatar:(0,G.jsx)(R.A,{}),sx:{bgcolor:"#f5f5f5"}}),(0,G.jsx)(j.A,{sx:{height:"300px"},children:ae.rendimientoSemanal.length>0?(0,G.jsx)(I.u,{width:"100%",height:"100%",children:(0,G.jsxs)(V.b,{data:ae.rendimientoSemanal,children:[(0,G.jsx)(M.d,{strokeDasharray:"3 3"}),(0,G.jsx)(N.W,{dataKey:"semana"}),(0,G.jsx)(k.h,{}),(0,G.jsx)(w.m,{formatter:(e,a)=>["".concat(null===e||void 0===e?void 0:e.toFixed(1),"h"),a.charAt(0).toUpperCase()+a.slice(1)]}),(0,G.jsx)(W.s,{}),(0,G.jsx)(E.N,{type:"monotone",dataKey:"personalizado",stroke:_.presencial,name:"Presencial",strokeWidth:2}),(0,G.jsx)(E.N,{type:"monotone",dataKey:"teletrabajo",stroke:_.teletrabajo,name:"Teletrabajo",strokeWidth:2}),(0,G.jsx)(E.N,{type:"monotone",dataKey:"cambio",stroke:_.cambio,name:"Cambio",strokeWidth:2})]})}):(0,G.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,G.jsx)(h.A,{color:"text.secondary",children:"No hay datos disponibles"})})})]})}),(0,G.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,G.jsxs)(b.A,{sx:{height:"400px",borderRadius:"12px"},children:[(0,G.jsx)(A.A,{title:"Resumen Semana Actual",avatar:(0,G.jsx)(v.A,{}),sx:{bgcolor:"#f5f5f5"}}),(0,G.jsx)(j.A,{children:ae.semanaActual.tipos&&Object.keys(ae.semanaActual.tipos).length>0?(0,G.jsxs)(l.A,{sx:{textAlign:"left"},children:[(0,G.jsxs)(h.A,{variant:"h4",sx:{color:"#3f51b5",mb:2,textAlign:"center"},children:[(null===(e=ae.semanaActual.horasTotales)||void 0===e?void 0:e.toFixed(1))||"0"," horas"]}),(0,G.jsx)(u.A,{sx:{mb:2}}),(0,G.jsx)(h.A,{variant:"h6",gutterBottom:!0,children:"Distribuci\xf3n por tipo:"}),Object.entries(ae.semanaActual.tipos).map(e=>{let[a,o]=e;return(0,G.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,G.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,G.jsx)(l.A,{sx:{width:16,height:16,bgcolor:_[a]||"#9e9e9e",borderRadius:"50%",mr:1}}),(0,G.jsx)(h.A,{variant:"body2",children:a.charAt(0).toUpperCase()+a.slice(1)})]}),(0,G.jsxs)(h.A,{variant:"body2",sx:{fontWeight:"bold"},children:["number"===typeof o?o.toFixed(1):o,"h"]})]},a)}),(0,G.jsx)(l.A,{sx:{mt:2,p:2,bgcolor:"#f5f5f5",borderRadius:"8px"},children:(0,G.jsxs)(h.A,{variant:"caption",color:"text.secondary",children:["Progreso: ",((ae.semanaActual.horasTotales||0)/(0,c.bW)((null===a||void 0===a?void 0:a.tipoContrato)||"Operativo")*100).toFixed(1),"% de tu jornada semanal"]})})]}):(0,G.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"200px"},children:[(0,G.jsx)(R.A,{sx:{fontSize:60,color:"text.secondary",mb:2}}),(0,G.jsx)(h.A,{color:"text.secondary",textAlign:"center",children:"No hay asignaciones para esta semana"})]})})]})})]})]})})]})]})}}}]);
//# sourceMappingURL=283.1e956bdc.chunk.js.map