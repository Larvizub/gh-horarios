"use strict";(self.webpackChunkcostaricacc_horarios=self.webpackChunkcostaricacc_horarios||[]).push([[310],{637:(e,a,o)=>{o.d(a,{A:()=>n,b:()=>i});var t=o(3816),r=o(8360);function i(e){return(0,r.Ay)("MuiListItemText",e)}const n=(0,t.A)("MuiListItemText",["root","multiline","dense","inset","primary","secondary"])},1608:(e,a,o)=>{o.d(a,{A:()=>w});var t=o(9298),r=o(811),i=o(2660),n=o(464),s=o(4102),c=o(3354),l=o(2244),d=o(862),u=o(4505),m=o(9910),p=o(4270),g=o(5334),v=o(3064),h=o(3471),A=o(3949),f=o(637),b=o(3816),x=o(8360);function y(e){return(0,x.Ay)("MuiMenuItem",e)}const C=(0,b.A)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]);var I=o(632);const O=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],j=(0,l.Ay)(p.A,{shouldForwardProp:e=>(0,d.A)(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.root,o.dense&&a.dense,o.divider&&a.divider,!o.disableGutters&&a.gutters]}})(e=>{let{theme:a,ownerState:o}=e;return(0,r.A)({},a.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!o.disableGutters&&{paddingLeft:16,paddingRight:16},o.divider&&{borderBottom:"1px solid ".concat((a.vars||a).palette.divider),backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(a.vars||a).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(C.selected)]:{backgroundColor:a.vars?"rgba(".concat(a.vars.palette.primary.mainChannel," / ").concat(a.vars.palette.action.selectedOpacity,")"):(0,c.X4)(a.palette.primary.main,a.palette.action.selectedOpacity),["&.".concat(C.focusVisible)]:{backgroundColor:a.vars?"rgba(".concat(a.vars.palette.primary.mainChannel," / calc(").concat(a.vars.palette.action.selectedOpacity," + ").concat(a.vars.palette.action.focusOpacity,"))"):(0,c.X4)(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},["&.".concat(C.selected,":hover")]:{backgroundColor:a.vars?"rgba(".concat(a.vars.palette.primary.mainChannel," / calc(").concat(a.vars.palette.action.selectedOpacity," + ").concat(a.vars.palette.action.hoverOpacity,"))"):(0,c.X4)(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:a.vars?"rgba(".concat(a.vars.palette.primary.mainChannel," / ").concat(a.vars.palette.action.selectedOpacity,")"):(0,c.X4)(a.palette.primary.main,a.palette.action.selectedOpacity)}},["&.".concat(C.focusVisible)]:{backgroundColor:(a.vars||a).palette.action.focus},["&.".concat(C.disabled)]:{opacity:(a.vars||a).palette.action.disabledOpacity},["& + .".concat(h.A.root)]:{marginTop:a.spacing(1),marginBottom:a.spacing(1)},["& + .".concat(h.A.inset)]:{marginLeft:52},["& .".concat(f.A.root)]:{marginTop:0,marginBottom:0},["& .".concat(f.A.inset)]:{paddingLeft:36},["& .".concat(A.A.root)]:{minWidth:36}},!o.dense&&{[a.breakpoints.up("sm")]:{minHeight:"auto"}},o.dense&&(0,r.A)({minHeight:32,paddingTop:4,paddingBottom:4},a.typography.body2,{["& .".concat(A.A.root," svg")]:{fontSize:"1.25rem"}}))}),w=i.forwardRef(function(e,a){const o=(0,u.b)({props:e,name:"MuiMenuItem"}),{autoFocus:c=!1,component:l="li",dense:d=!1,divider:p=!1,disableGutters:h=!1,focusVisibleClassName:A,role:f="menuitem",tabIndex:b,className:x}=o,C=(0,t.A)(o,O),w=i.useContext(m.A),R=i.useMemo(()=>({dense:d||w.dense||!1,disableGutters:h}),[w.dense,d,h]),S=i.useRef(null);(0,g.A)(()=>{c&&S.current&&S.current.focus()},[c]);const D=(0,r.A)({},o,{dense:R.dense,divider:p,disableGutters:h}),T=(e=>{const{disabled:a,dense:o,divider:t,disableGutters:i,selected:n,classes:c}=e,l={root:["root",o&&"dense",a&&"disabled",!i&&"gutters",t&&"divider",n&&"selected"]},d=(0,s.A)(l,y,c);return(0,r.A)({},c,d)})(o),M=(0,v.A)(S,a);let k;return o.disabled||(k=void 0!==b?b:-1),(0,I.jsx)(m.A.Provider,{value:R,children:(0,I.jsx)(j,(0,r.A)({ref:M,role:f,tabIndex:k,component:l,focusVisibleClassName:(0,n.A)(T.focusVisible,A),className:(0,n.A)(T.root,x)},C,{ownerState:D,classes:T}))})})},3471:(e,a,o)=>{o.d(a,{A:()=>n,K:()=>i});var t=o(3816),r=o(8360);function i(e){return(0,r.Ay)("MuiDivider",e)}const n=(0,t.A)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"])},3949:(e,a,o)=>{o.d(a,{A:()=>n,f:()=>i});var t=o(3816),r=o(8360);function i(e){return(0,r.Ay)("MuiListItemIcon",e)}const n=(0,t.A)("MuiListItemIcon",["root","alignItemsFlexStart"])},6310:(e,a,o)=>{o.r(a),o.d(a,{default:()=>M});var t=o(6832),r=o(2660),i=o(3106),n=o(8359),s=o(4550),c=o(8621),l=o(6121),d=o(2260),u=o(4184),m=o(6647),p=o(7237),g=o(2757),v=o(2729),h=o(4909),A=o(6534),f=o(1608),b=o(5515),x=o(2244),y=o(6468),C=o(8338),I=o(6857),O=o(6984),j=o(6581),w=o(632);const R=(0,x.Ay)(c.A)(e=>{let{theme:a}=e;return{padding:a.spacing(4),display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"}}),S=(0,x.Ay)("img")({width:"200px",marginBottom:"24px"}),D=(0,x.Ay)(l.A)(e=>{let{theme:a}=e;return{marginTop:a.spacing(3),marginBottom:a.spacing(2),paddingTop:a.spacing(1.5),paddingBottom:a.spacing(1.5),borderRadius:"8px",transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.25)"}}}),T=[{value:null,label:"Sin rol"},{value:O.gg.ADMINISTRADOR,label:"Administrador"},{value:O.gg.MODIFICADOR,label:"Modificador"},{value:O.gg.VISOR,label:"Visor"}],M=()=>{const[e,a]=(0,r.useState)(!1),[o,c]=(0,r.useState)(null),[x,M]=(0,r.useState)({nombre:"",apellidos:"",email:"",cargo:"",departamento:"",tipoContrato:"Operativo",rol:O.gg.VISOR,password:"",confirmPassword:""}),k=(0,n.Zp)();r.useEffect(()=>{(async()=>{try{const e=i.j2.currentUser;if(e){const a=(0,I.KR)(i.OO,"usuarios/".concat(e.uid)),o=await(0,I.Jt)(a);if(o.exists()){const a=o.val();c((0,t.A)((0,t.A)({},a),{},{email:e.email}))}}}catch(e){console.error("Error al cargar usuario actual:",e)}})()},[]);const E=e=>{const{name:a,value:o}=e.target;M("tipoContrato"===a?e=>(0,t.A)((0,t.A)({},e),{},{tipoContrato:o,rol:"Confianza"===o?O.gg.MODIFICADOR:O.gg.VISOR}):e=>(0,t.A)((0,t.A)({},e),{},{[a]:o}))};return(0,w.jsx)(d.A,{component:"main",maxWidth:"md",children:(0,w.jsx)(u.A,{sx:{marginTop:4,marginBottom:4,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,w.jsxs)(R,{elevation:6,children:[(0,w.jsx)(S,{src:"/costa-rica-logo.png",alt:"Costa Rica Centro de Convenciones",onError:e=>{e.target.style.display="none"}}),(0,w.jsx)(m.A,{component:"h1",variant:"h4",sx:{mb:3,fontWeight:"bold",color:"primary.main"},children:"Registro de Personal"}),(0,w.jsx)(u.A,{component:"form",onSubmit:async e=>{e.preventDefault(),a(!0);let{nombre:o,apellidos:t,email:r,cargo:n,departamento:c,tipoContrato:l,rol:d,password:u,confirmPassword:m}=x;if(!o||!t||!r||!n||!c||!u||!m)return s.oR.error("Por favor completa todos los campos obligatorios"),void a(!1);if(u!==m)return s.oR.error("Las contrase\xf1as no coinciden"),void a(!1);if(u.length<6)return s.oR.error("La contrase\xf1a debe tener al menos 6 caracteres"),void a(!1);try{const e=(0,I.KR)(i.OO,"usuarios"),m=await(0,I.Jt)(e);let A=!1;if(m.exists()){const e=m.val();for(const a of Object.values(e))if(a&&a.email&&a.email.toLowerCase()===r.toLowerCase()){A=!0;break}}if(A)return s.oR.error("Ya existe un usuario con este correo electr\xf3nico"),void a(!1);const f="AIzaSyAlNOPMmS3leEXTg054lD7KDcj2Q24cz_4",b="https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=".concat(f);console.log("Enviando solicitud a Firebase Auth...");const x=await fetch(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:u,returnSecureToken:!0})}),y=await x.json();if(!x.ok){var p;let e="Error al crear usuario en Firebase";if(null!==(p=y.error)&&void 0!==p&&p.message)switch(y.error.message){case"EMAIL_EXISTS":e="Ya existe una cuenta con este correo electr\xf3nico";break;case"INVALID_EMAIL":e="El formato del correo electr\xf3nico no es v\xe1lido";break;case"WEAK_PASSWORD":e="La contrase\xf1a es muy d\xe9bil. Debe tener al menos 6 caracteres";break;default:e=y.error.message}throw new Error(e)}const C=y.localId;if(!C)throw new Error("No se pudo obtener el ID del usuario creado");console.log("Usuario creado en Auth, guardando datos en Database...");try{const e="https://horarios-costaricacc-default-rtdb.firebaseio.com";let a=!1;try{(await fetch("".concat(e,"/usuarios/").concat(C,".json"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:o,apellidos:t,email:r,cargo:n,departamento:c,tipoContrato:l,rol:d||null,createdAt:(new Date).toISOString(),debeCambiarPassword:!0})})).ok&&(a=!0,console.log("Datos de usuario guardados exitosamente sin token"))}catch(v){console.log("Escritura sin token fall\xf3, intentando con token temporal...")}if(!a){const a=await fetch("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=".concat(f),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:u,returnSecureToken:!0})});if(!a.ok){var g;const e=await a.json();throw new Error("Error en autenticaci\xf3n temporal: ".concat((null===(g=e.error)||void 0===g?void 0:g.message)||"Error desconocido"))}const i=(await a.json()).idToken,s=await fetch("".concat(e,"/usuarios/").concat(C,".json?auth=").concat(i),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:o,apellidos:t,email:r,cargo:n,departamento:c,tipoContrato:l,rol:d||null,createdAt:(new Date).toISOString(),debeCambiarPassword:!0})});if(!s.ok){const e=await s.json();throw new Error("No se pudieron guardar los datos del usuario: ".concat(e.error||s.statusText))}console.log("Datos de usuario guardados exitosamente usando autenticaci\xf3n temporal")}}catch(h){throw console.error("Error al guardar datos del usuario:",h),new Error("Error al guardar datos del usuario: ".concat(h.message))}s.oR.success("Usuario registrado exitosamente. El usuario puede iniciar sesi\xf3n ahora."),M({nombre:"",apellidos:"",email:"",cargo:"",departamento:"",tipoContrato:"Operativo",rol:null,password:"",confirmPassword:""}),i.j2.currentUser?k("/personal"):(s.oR.success("Usuario registrado exitosamente. Ahora puedes iniciar sesi\xf3n."),k("/"))}catch(v){console.error("Error al registrar usuario:",v.message),s.oR.error("Error al registrar usuario: "+v.message)}finally{a(!1)}},sx:{width:"100%"},children:(0,w.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,w.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,w.jsx)(g.A,{name:"nombre",required:!0,fullWidth:!0,label:"Nombre",value:x.nombre,onChange:E,autoFocus:!0})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,w.jsx)(g.A,{name:"apellidos",required:!0,fullWidth:!0,label:"Apellidos",value:x.apellidos,onChange:E})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,children:(0,w.jsx)(g.A,{name:"email",required:!0,fullWidth:!0,label:"Correo Electr\xf3nico",type:"email",value:x.email,onChange:E})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,w.jsx)(g.A,{name:"cargo",required:!0,fullWidth:!0,label:"Cargo",value:x.cargo,onChange:E})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,w.jsxs)(v.A,{fullWidth:!0,required:!0,children:[(0,w.jsx)(h.A,{children:"Departamento"}),(0,w.jsx)(A.A,{name:"departamento",value:x.departamento,onChange:E,label:"Departamento",children:j.A1.map(e=>(0,w.jsx)(f.A,{value:e,children:e},e))})]})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,children:(0,w.jsxs)(v.A,{fullWidth:!0,children:[(0,w.jsx)(h.A,{children:"Tipo de Contrato"}),(0,w.jsxs)(A.A,{name:"tipoContrato",value:x.tipoContrato,onChange:E,label:"Tipo de Contrato",children:[(0,w.jsx)(f.A,{value:"Operativo",children:"Operativo"}),(0,w.jsx)(f.A,{value:"Confianza",children:"Confianza"})]})]})}),o&&(0,O.qK)(o)&&(0,w.jsx)(p.Ay,{item:!0,xs:12,children:(0,w.jsxs)(v.A,{fullWidth:!0,children:[(0,w.jsx)(h.A,{children:"Rol en el Sistema"}),(0,w.jsx)(A.A,{name:"rol",value:x.rol||"",onChange:E,label:"Rol en el Sistema",children:T.map(e=>(0,w.jsx)(f.A,{value:e.value||"",children:e.label},e.value||"sin-rol"))})]})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,w.jsx)(g.A,{name:"password",required:!0,fullWidth:!0,label:"Contrase\xf1a",type:"password",value:x.password,onChange:E,helperText:"M\xednimo 6 caracteres"})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,w.jsx)(g.A,{name:"confirmPassword",required:!0,fullWidth:!0,label:"Confirmar Contrase\xf1a",type:"password",value:x.confirmPassword,onChange:E})}),(0,w.jsx)(p.Ay,{item:!0,xs:12,children:(0,w.jsxs)(u.A,{sx:{display:"flex",gap:2,justifyContent:"center",mt:3,flexDirection:{xs:"column",sm:"row"},alignItems:"center"},children:[(0,w.jsx)(l.A,{onClick:()=>{i.j2.currentUser?k("/personal"):k("/")},variant:"outlined",startIcon:(0,w.jsx)(C.A,{}),disabled:e,sx:{minWidth:{xs:"100%",sm:"140px"},borderRadius:"8px",textTransform:"none",fontWeight:"bold"},children:"Volver"}),(0,w.jsx)(D,{type:"submit",variant:"contained",disabled:e,startIcon:e?(0,w.jsx)(b.A,{size:20}):(0,w.jsx)(y.A,{}),sx:{minWidth:{xs:"100%",sm:"200px"},textTransform:"none",fontWeight:"bold"},children:e?"Registrando...":"Registrar Usuario"})]})})]})})]})})})}},6468:(e,a,o)=>{var t=o(8641);a.A=void 0;var r=t(o(7845)),i=o(632);a.A=(0,r.default)((0,i.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},6581:(e,a,o)=>{o.d(a,{A1:()=>t,Kj:()=>s,VF:()=>i,hu:()=>r,yQ:()=>n});const t=["Planeaci\xf3n de Eventos","Gesti\xf3n de la Protecci\xf3n","\xc1reas & Sostenibilidad","Gastronom\xeda","Infraestructura","Financiero","Oficina de Atenci\xf3n al Expositor","Practicantes/Crosstraining","Talento Humano","Calidad","Sistemas","Mercadeo y Ventas","Compras","Gerencia de Operaciones","Gerencia General","UDEI"],r=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"],i=["descanso","vacaciones","feriado","permiso","dia-brigada","fuera-oficina","incapacidad-enfermedad","incapacidad-accidente"],n={dia1:"Lunes",dia2:"Martes",dia3:"Mi\xe9rcoles",dia4:"Jueves",dia5:"Viernes",dia6:"S\xe1bado",dia7:"Domingo"},s={personalizado:"Presencial",teletrabajo:"Teletrabajo",cambio:"Cambio",descanso:"Descanso",vacaciones:"Vacaciones",feriado:"Feriado",permiso:"Permiso","tarde-libre":"Tarde Libre","dia-brigada":"Brigada","fuera-oficina":"Fuera de Oficina","viaje-trabajo":"Viaje de Trabajo","incapacidad-enfermedad":"Incapacidad por Enfermedad","incapacidad-accidente":"Incapacidad por Accidente","tele-presencial":"Teletrabajo & Presencial"}},6984:(e,a,o)=>{o.d(a,{FW:()=>u,MJ:()=>c,MO:()=>p,Nf:()=>s,RK:()=>t,VO:()=>d,bW:()=>n,gg:()=>r,m:()=>m,qK:()=>l});const t={OPERATIVO:"Operativo",CONFIANZA:"Confianza"},r={ADMINISTRADOR:"Administrador",MODIFICADOR:"Modificador",VISOR:"Visor"},i={[t.OPERATIVO]:48,[t.CONFIANZA]:72},n=e=>i[e]||i[t.OPERATIVO],s=e=>{const a=n(e);return"Los empleados de tipo ".concat(e," tienen un l\xedmite de ").concat(a," horas semanales.")},c=e=>"Talento Humano"===(null===e||void 0===e?void 0:e.departamento),l=e=>(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),d=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||((null===e||void 0===e?void 0:e.rol)===r.MODIFICADOR||(null===e||void 0===e?void 0:e.rol)===r.VISOR?!a||(null===e||void 0===e?void 0:e.departamento)===(null===a||void 0===a?void 0:a.departamento):"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email))},u=e=>(null===e||void 0===e?void 0:e.rol)===r.ADMINISTRADOR||"Talento Humano"===(null===e||void 0===e?void 0:e.departamento)||"admin@costaricacc.com"===(null===e||void 0===e?void 0:e.email),m=e=>{switch(e){case r.ADMINISTRADOR:return"error";case r.MODIFICADOR:return"warning";case r.VISOR:return"info";default:return"default"}},p=e=>{switch(e){case r.ADMINISTRADOR:return"Puede realizar todos los cambios en la plataforma";case r.MODIFICADOR:return"Puede modificar horarios de su departamento";case r.VISOR:return"Solo puede ver horarios, sin modificaciones";default:return"Sin rol espec\xedfico asignado"}}},8338:(e,a,o)=>{var t=o(8641);a.A=void 0;var r=t(o(7845)),i=o(632);a.A=(0,r.default)((0,i.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")}}]);
//# sourceMappingURL=310.2dedb5f5.chunk.js.map