{"version":3,"file":"static/js/979.ae080398.chunk.js","mappings":"iLAAO,MAAMA,EAAgB,CAC3B,2BACA,iCACA,4BACA,iBACA,kBACA,aACA,sCACA,6BACA,iBACA,UACA,WACA,oBACA,UACA,0BACA,mBACA,QAGWC,EAAa,CACxB,QAAS,SAAU,eAAa,SAAU,UAAW,YAAU,WAGpDC,EAAiB,CAC5B,WAAY,aAAc,UAAW,UAAW,cAAe,gBAAiB,yBAA0B,yBAI/FC,EAAc,CACzBC,KAAM,QACNC,KAAM,SACNC,KAAM,eACNC,KAAM,SACNC,KAAM,UACNC,KAAM,YACNC,KAAM,WAGKC,EAAa,CACxBC,cAAe,aACfC,YAAa,cACbC,OAAQ,SACRC,SAAU,WACVC,WAAY,aACZC,QAAS,UACTC,QAAS,UACT,cAAe,cACf,cAAe,UACf,gBAAiB,mBACjB,gBAAiB,mBACjB,yBAA0B,6BAC1B,wBAAyB,4BACzB,kBAAmB,2B,mHC/Cd,MAAMC,EAAiB,CAC5BC,UAAW,YACXC,UAAW,aAIAC,EAAQ,CACnBC,cAAe,gBACfC,YAAa,cACbC,MAAO,SAIIC,EAAyB,CACpC,CAACP,EAAeC,WAAY,GAC5B,CAACD,EAAeE,WAAY,IAQjBM,EAAuBC,GAC3BF,EAAuBE,IAAiBF,EAAuBP,EAAeC,WAmB1ES,EAAkCD,IAC7C,MAAME,EAAeH,EAAoBC,GACzC,MAAM,yBAANG,OAAgCH,EAAY,4BAAAG,OAAwBD,EAAY,sBAQrEE,EAA8BC,GACR,oBAAnB,OAAPA,QAAO,IAAPA,OAAO,EAAPA,EAASC,cAQLC,EAAqBF,IAClB,OAAPA,QAAO,IAAPA,OAAO,EAAPA,EAASG,OAAQd,EAAMC,eACG,oBAAnB,OAAPU,QAAO,IAAPA,OAAO,EAAPA,EAASC,eACU,2BAAZ,OAAPD,QAAO,IAAPA,OAAO,EAAPA,EAASI,OAqCLC,EAAmB,SAACL,GAAqC,IAA5BM,EAAeC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KAE1D,OAAW,OAAPP,QAAO,IAAPA,OAAO,EAAPA,EAASG,OAAQd,EAAMC,iBAKhB,OAAPU,QAAO,IAAPA,OAAO,EAAPA,EAASG,OAAQd,EAAME,cAAsB,OAAPS,QAAO,IAAPA,OAAO,EAAPA,EAASG,OAAQd,EAAMG,OAC1Dc,IACS,OAAPN,QAAO,IAAPA,OAAO,EAAPA,EAASC,iBAAgC,OAAfK,QAAe,IAAfA,OAAe,EAAfA,EAAiBL,cAInB,oBAAnB,OAAPD,QAAO,IAAPA,OAAO,EAAPA,EAASC,eACU,2BAAZ,OAAPD,QAAO,IAAPA,OAAO,EAAPA,EAASI,OAClB,EAOaM,EAAwBV,IACrB,OAAPA,QAAO,IAAPA,OAAO,EAAPA,EAASG,OAAQd,EAAMC,eACG,oBAAnB,OAAPU,QAAO,IAAPA,OAAO,EAAPA,EAASC,eACU,2BAAZ,OAAPD,QAAO,IAAPA,OAAO,EAAPA,EAASI,OAQLO,EAAmBR,IAC9B,OAAQA,GACN,KAAKd,EAAMC,cACT,MAAO,QACT,KAAKD,EAAME,YACT,MAAO,UACT,KAAKF,EAAMG,MACT,MAAO,OACT,QACE,MAAO,YASAoB,EAAyBT,IACpC,OAAQA,GACN,KAAKd,EAAMC,cACT,MAAO,oDACT,KAAKD,EAAME,YACT,MAAO,8CACT,KAAKF,EAAMG,MACT,MAAO,8CACT,QACE,MAAO,kC,ytBCzGb,MAAMqB,IAAcC,EAAAA,EAAAA,IAAOC,EAAAA,EAAPD,CAAcE,IAAA,IAAC,MAAEC,GAAOD,EAAA,MAAM,CAChDE,QAASD,EAAME,QAAQ,GACvBC,aAAc,OACdC,UAAW,gCACX,CAACJ,EAAMK,YAAYC,KAAK,OAAQ,CAC9BL,QAASD,EAAME,QAAQ,GACvBC,aAAc,QAEhB,CAACH,EAAMK,YAAYC,KAAK,OAAQ,CAC9BL,QAASD,EAAME,QAAQ,KACvBC,aAAc,MACdI,OAAQP,EAAME,QAAQ,QAIpBM,IAAiBX,EAAAA,EAAAA,IAAOY,EAAAA,EAAPZ,CAAiBa,IAAA,IAAC,MAAEV,GAAOU,EAAA,MAAM,CACtD,qBAAsB,CACpBC,gBAAiBX,EAAMY,QAAQC,OAAOC,OAExC,mCAAoC,CAClCC,OAAQ,MAINC,IAAWnB,EAAAA,EAAAA,IAAOoB,EAAAA,EAAPpB,CAAkBqB,IAAA,IAAC,MAAElB,EAAK,KAAEmB,GAAMD,EAAA,MAAM,CACvDP,gBAA0B,gBAATQ,GAAmC,oBAATA,EACvC,0BACU,kBAATA,EAA2B,0BAA4B,UAC5DC,WAAqB,aAATD,EAAsB,SAAW,OAC7CE,MAAgB,aAATF,EAAsBnB,EAAMY,QAAQU,KAAKC,UAAYvB,EAAMY,QAAQU,KAAKE,WAG3EzE,GAAa,CAAC,QAAS,SAAU,eAAa,SAAU,UAAW,YAAU,WAE7EU,GAAa,CACjBC,cAAe,aACfC,YAAa,cACbE,SAAU,WACVC,WAAY,aACZC,QAAS,UACTC,QAAS,gCACT,cAAe,cACf,cAAe,sBAs0BXyD,GAAmBC,IAQlB,IARmB,KACxBC,EAAI,QACJC,EAAO,iBACPC,EAAgB,kBAChBC,EAAiB,eACjBC,EAAc,kBACdC,EAAiB,qBACjBC,GACDP,EACC,OAAKG,GAGHK,EAAAA,GAAAA,MAACC,EAAAA,EAAM,CACLR,KAAMA,EACNC,QAASA,EACTQ,WAAS,EACTC,SAAS,KAAIC,SAAA,EAEbC,EAAAA,GAAAA,KAACC,EAAAA,EAAW,CAAAF,SAAC,uCAGbJ,EAAAA,GAAAA,MAACO,EAAAA,EAAa,CAAAH,SAAA,EACZJ,EAAAA,GAAAA,MAACQ,EAAAA,EAAiB,CAACC,GAAI,CAAEC,GAAI,GAAIN,SAAA,EAC/BJ,EAAAA,GAAAA,MAAA,UAAAI,SAAA,CAAST,EAAiBgB,OAAO,IAAEhB,EAAiBiB,aAAmB,MAAIjB,EAAiB7C,iBAG9FkD,EAAAA,GAAAA,MAACa,EAAAA,EAAU,CAACC,QAAQ,QAAQ3B,MAAM,QAAQ4B,cAAY,EAAAX,SAAA,EACpDC,EAAAA,GAAAA,KAAA,UAAAD,SAAQ,wBAA4B,IAAEN,KAGvCF,EAAkBvC,OAAS,GAC1B2C,EAAAA,GAAAA,MAAAgB,GAAAA,SAAA,CAAAZ,SAAA,EACEC,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CAACC,QAAQ,QAAQL,GAAI,CAAEQ,GAAI,EAAGP,GAAI,GAAIN,UAC/CC,EAAAA,GAAAA,KAAA,UAAAD,SAAQ,kDAGVC,EAAAA,GAAAA,KAACa,EAAAA,EAAI,CAACT,GAAI,CAAEU,QAAS,oBAAqBf,SACvCR,EAAkBwB,IAAI,CAACvE,EAASwE,KAC/BrB,EAAAA,GAAAA,MAACsB,EAAAA,SAAc,CAAAlB,SAAA,EACbJ,EAAAA,GAAAA,MAACuB,EAAAA,GAAQ,CAACC,WAAW,aAAYpB,SAAA,EAC/BC,EAAAA,GAAAA,KAACoB,EAAAA,EAAc,CAAArB,UACbJ,EAAAA,GAAAA,MAAC0B,EAAAA,EAAM,CAAAtB,SAAA,CAAEvD,EAAQ8D,OAAOgB,OAAO,GAAI9E,EAAQ+D,UAAUe,OAAO,SAE9DtB,EAAAA,GAAAA,KAACuB,EAAAA,EAAY,CACXtC,QAAO,GAAA3C,OAAKE,EAAQ8D,OAAM,KAAAhE,OAAIE,EAAQ+D,WACtCvB,WACEW,EAAAA,GAAAA,MAAAgB,GAAAA,SAAA,CAAAZ,SAAA,EACEJ,EAAAA,GAAAA,MAACa,EAAAA,EAAU,CACTgB,UAAU,OACVf,QAAQ,QACR3B,MAAM,eAAciB,SAAA,CAEnBvD,EAAQiF,MAAM,MAAIjF,EAAQC,iBAE7BuD,EAAAA,GAAAA,KAAA,SAAM,oBAAA1D,OACeoD,EAAqBlD,EAAQkF,IAAIC,QAAQ,GAAE,wBAKvEX,EAAQzB,EAAkBvC,OAAS,IAAKgD,EAAAA,GAAAA,KAAC4B,EAAAA,EAAO,CAACnB,QAAQ,QAAQe,UAAU,SAtBzDhF,EAAQkF,WA4BnC1B,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CAACC,QAAQ,QAAQL,GAAI,CAAEQ,GAAI,EAAG9B,MAAO,gBAAiBiB,SAAC,2MAMtEC,EAAAA,GAAAA,KAAC6B,EAAAA,EAAa,CAAA9B,UACZC,EAAAA,GAAAA,KAAC8B,EAAAA,EAAM,CAACC,QAAS1C,EAASP,MAAM,UAASiB,SAAC,gBAhElB,MAwEhC,GAp5ByBiC,KACvB,MAAMvE,GAAQwE,EAAAA,EAAAA,KACRC,GAAWC,EAAAA,EAAAA,GAAc1E,EAAMK,YAAYC,KAAK,QAE/CqE,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAUC,IAAeF,EAAAA,EAAAA,UAAS,KAClCG,EAAmBC,IAAwBJ,EAAAA,EAAAA,UAAS,CAAC,IACrDK,EAAoBC,IAAyBN,EAAAA,EAAAA,WAASO,EAAAA,EAAAA,GAAY,IAAIC,KAAQ,CAAEC,aAAc,MAC9FC,EAA0BC,KAA+BX,EAAAA,EAAAA,UAAS,KAClEY,GAAyBC,KAA8Bb,EAAAA,EAAAA,UAAS,OAChEc,GAAsBC,KAA2Bf,EAAAA,EAAAA,UAAS,CAAC,IAC3DgB,GAAUC,KAAejB,EAAAA,EAAAA,UAAS,OAClCkB,GAAcC,KAAmBnB,EAAAA,EAAAA,WAASoB,EAAAA,EAAAA,GAAQ,IAAIZ,QACtDa,GAAeC,KAAoBtB,EAAAA,EAAAA,WAAS,IAAIQ,MAAOe,aACvDC,GAAgBC,KAAqBzB,EAAAA,EAAAA,WAAS,IAG9C0B,GAAsBC,KAA2B3B,EAAAA,EAAAA,WAAS,IAC1DhD,GAAkB4E,KAAuB5B,EAAAA,EAAAA,UAAS,OAClD/C,GAAmB4E,KAAwB7B,EAAAA,EAAAA,UAAS,KACpD9C,GAAgB4E,KAAqB9B,EAAAA,EAAAA,UAAS,KAC9C7C,GAAmB4E,KAAwB/B,EAAAA,EAAAA,UAAS,IAUrDgC,GAPsBC,KAC1B,MAAMC,GAAOd,EAAAA,EAAAA,GAAQa,GACfE,GAAOC,EAAAA,EAAAA,GAAWH,GACxB,MAAM,GAANjI,OAAUkI,EAAI,KAAAlI,OAAImI,IAIFE,CAAmBhC,GAG/BiC,GAAgBC,EAAAA,GAAKC,YAAcvC,EAASwC,KAAKC,GAAKA,EAAEtD,KAAOmD,EAAAA,GAAKC,YAAYG,KAAO,KACvFC,GAAyC,mBAAV,OAAbN,SAAa,IAAbA,QAAa,EAAbA,GAAejI,MAwBvCwI,EAAAA,EAAAA,WAAU,KACYC,WAClB,IACE/C,GAAW,GAEX,IADawC,EAAAA,GAAKC,YACP,OAGX,MAAMO,GAAcC,EAAAA,EAAAA,IAAIC,EAAAA,GAAU,YAC5BC,QAAyBC,EAAAA,EAAAA,IAAIJ,GACnC,GAAIG,EAAiBE,SAAU,CAC7B,MAAMC,EAAeH,EAAiBI,MAChCC,EAAgBC,OAAOC,QAAQJ,GAAc5E,IAAIiF,IAAA,IAAEtE,EAAIuE,GAAKD,EAAA,OAAAE,EAAAA,EAAAA,GAAA,CAChExE,MACGuE,KAELzD,EAAYqD,EACd,CAGA,MAAMM,GAAeb,EAAAA,EAAAA,IAAIC,EAAAA,GAAU,sBAC7Ba,QAA0BX,EAAAA,EAAAA,IAAIU,GAEpC,GAAIC,EAAkBV,SAAU,CAC9B,MAAMW,EAAYD,EAAkBR,MACpClD,EAAqB2D,EACvB,CACF,CAAE,MAAOC,GACPC,QAAQD,MAAM,yBAA0BA,GACxCE,EAAAA,GAAMF,MAAM,0BAA4BA,EAAMG,QAChD,CAAC,QACCpE,GAAW,EACb,GAGFqE,IACC,IAGH,MAAMC,GAAqBA,KACzB,MAWMC,EAAc,IAAI9D,KAAKU,GAAcG,GAAgB,EAAG,GAAGkD,UAC3DC,EAAkB,IAAIhE,KAAKU,GAAcG,GAAe,GAAGoD,SAC3DC,EAAuC,IAApBF,EAAwB,EAAIA,EAE/CG,EAAO,GACb,IAAK,IAAIC,EAAI,EAAGA,GAAKN,EAAaM,IAChCD,EAAKE,KAAKD,GAqBZ,OACEvH,EAAAA,GAAAA,MAAAgB,GAAAA,SAAA,CAAAZ,SAAA,EACEJ,EAAAA,GAAAA,MAACmC,EAAAA,EAAM,CACLrB,QAAQ,WACR2G,WAAWpH,EAAAA,GAAAA,KAACqH,GAAAA,EAAiB,IAC7BtF,QA3CkBuF,IACtB/D,GAAY+D,EAAMC,eAClBxD,IAAkB,IA0CdlE,WAAS,EAAAE,SAAA,CACV,WACS2E,EAAAA,EAAAA,GAAW/B,GAAoB,OAAIe,EAAAA,EAAAA,GAAQf,OAGrD3C,EAAAA,GAAAA,KAACwH,EAAAA,GAAO,CACNpI,KAAM0E,GACNR,SAAUA,GACVjE,QA/CkBoI,KACtBlE,GAAY,MACZQ,IAAkB,IA8Cd2D,aAAc,CACZC,SAAU,SACVC,WAAY,UAEdC,gBAAiB,CACfF,SAAU,MACVC,WAAY,UAEdxH,GAAI,CACF,sBAAuB,CACrB0H,SAAU,mBACVC,IAAK,iBACLC,KAAM,iBACNC,UAAW,mCACXnI,SAAU,OACVoI,UAAW,OACXC,OAAQ,OAEVpI,UAEFJ,EAAAA,GAAAA,MAACyI,EAAAA,EAAG,CAAChI,GAAI,CAAEiI,EAAG,EAAGC,MAAO,KAAMvI,SAAA,EAC5BJ,EAAAA,GAAAA,MAACyI,EAAAA,EAAG,CAAChI,GAAI,CAAEmI,QAAS,OAAQC,eAAgB,gBAAiBrH,WAAY,SAAUd,GAAI,GAAIN,SAAA,EACzFC,EAAAA,GAAAA,KAACyI,EAAAA,EAAU,CAAC1G,QAvDE2G,KACA,IAAlB/E,IACFC,GAAiB,IACjBH,GAAgBD,GAAe,IAE/BI,GAAiBD,GAAgB,IAkDWgF,KAAK,QAAO5I,UAChDC,EAAAA,GAAAA,KAAC4I,GAAAA,EAAmB,CAACC,SAAS,aAEhC7I,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CAACC,QAAQ,YAAWV,UAC5B+I,EAAAA,GAAAA,GAAO,IAAIhG,KAAKU,GAAcG,GAAe,GAAI,YAAa,CAAEoF,OAAQC,GAAAA,OAE3EhJ,EAAAA,GAAAA,KAACyI,EAAAA,EAAU,CAAC1G,QApDEkH,KACA,KAAlBtF,IACFC,GAAiB,GACjBH,GAAgBD,GAAe,IAE/BI,GAAiBD,GAAgB,IA+CWgF,KAAK,QAAO5I,UAChDC,EAAAA,GAAAA,KAACkJ,GAAAA,EAAmB,CAACL,SAAS,gBAIlClJ,EAAAA,GAAAA,MAACwJ,EAAAA,GAAI,CAACC,WAAS,EAACzL,QAAS,EAAEoC,SAAA,CACxB,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAKgB,IAAI,CAACsI,EAAKrI,KAC7ChB,EAAAA,GAAAA,KAACmJ,EAAAA,GAAI,CAACG,MAAI,EAAaC,GAAI,GAAG,EAAExJ,UAC9BC,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CAACC,QAAQ,UAAU+I,MAAM,SAASpJ,GAAI,CAAEmI,QAAS,SAAUxI,SACnEsJ,KAFWrI,IAOjByI,MAAMzC,EAAmB,GAAG0C,KAAK,MAAM3I,IAAI,CAAC4I,EAAG3I,KAC9ChB,EAAAA,GAAAA,KAACmJ,EAAAA,GAAI,CAACG,MAAI,EAAwBC,GAAI,GAAG,GAAE,SAAAjN,OAAlB0E,KAG1BiG,EAAKlG,IAAIsI,IACRrJ,EAAAA,GAAAA,KAACmJ,EAAAA,GAAI,CAACG,MAAI,EAAWC,GAAI,GAAG,EAAExJ,UAC5BC,EAAAA,GAAAA,KAAC8B,EAAAA,EAAM,CACLrB,QAAQ,OACRL,GAAI,CACFwJ,SAAU,EACVtB,MAAO,OACP1K,aAAc,OAEhBmE,QAASA,IA7JDsH,KACxB,MAAMQ,EAAU,IAAI/G,KAAKU,GAAcG,GAAe0F,GAChDS,GAAYjH,EAAAA,EAAAA,GAAYgH,EAAS,CAAE9G,aAAc,IACvDH,EAAsBkH,GACtB/F,IAAkB,GAClBR,GAAY,OAwJmBwG,CAAiBV,GAAKtJ,SAEpCsJ,KAVWA,gBAsBxBW,GAAoBzH,EAAS0H,OAAOzN,KAEpCwG,GAA4BxG,EAAQC,eAAiBuG,MAKrDE,IACK1G,EAAQkF,KAAOwB,GAAwBxB,MAOlDyD,EAAAA,EAAAA,WAAU,KACR,IACE+E,aAAaC,QAAQ,kBAAmBC,KAAKC,UAAUL,KACvDE,aAAaC,QAAQ,2BAA4BC,KAAKC,UAAU5H,IAChEyH,aAAaC,QAAQ,4BAA6BxH,EAAmB2H,cACvE,CAAE,MAAOC,GACP,GAED,CAACP,GAAmBvH,EAAmBE,IAG1C,MAAM6H,GAAmBA,CAACC,EAAgBC,KACxC,IAAKD,IAAmBA,EAAeC,GACrC,MAAO,CAAEC,MAAO,cAAe/L,KAAM,MAGvC,MAAMgM,EAAQH,EAAeC,GAE7B,IAAKE,EACH,MAAO,CAAED,MAAO,cAAe/L,KAAM,MAGvC,GAAmB,aAAfgM,EAAMhM,KACR,MAAO,CAAE+L,MAAO,WAAY/L,KAAM,YAGpC,MAAMiM,EAAY3P,GAAW0P,EAAMhM,OAASgM,EAAMhM,KAGlD,GAAmB,oBAAfgM,EAAMhM,KAA4B,CACpC,MAAMkM,EAAaF,EAAMG,gBAAkB,GACrCC,EAAUJ,EAAMK,aAAe,GAC/BC,EAAaN,EAAMO,gBAAkB,GACrCC,EAAUR,EAAMS,aAAe,GAE/BC,EAAYC,OAAOC,SAASZ,EAAMU,WAAaV,EAAMU,UAAaV,EAAMU,UAAYC,OAAOX,EAAMU,WAAa,EAC9GG,EAAYF,OAAOC,SAASZ,EAAMa,WAAab,EAAMa,UAAab,EAAMa,UAAYF,OAAOX,EAAMa,WAAa,EAC9GC,EAAQH,OAAOC,SAASZ,EAAMe,OAASf,EAAMe,MAASL,EAAYG,EAElEG,EAAS,GACXd,GAAcE,EAChBY,EAAOzE,KAAK,gBAAD7K,OAAiBwO,EAAU,OAAAxO,OAAM0O,EAAO,MAAA1O,OAAKgP,EAAU3J,QAAQ,GAAE,OACnE2J,EAAY,GACrBM,EAAOzE,KAAK,gBAAD7K,OAAiBgP,EAAU3J,QAAQ,GAAE,MAG9CuJ,GAAcE,EAChBQ,EAAOzE,KAAK,eAAD7K,OAAgB4O,EAAU,OAAA5O,OAAM8O,EAAO,MAAA9O,OAAKmP,EAAU9J,QAAQ,GAAE,OAClE8J,EAAY,GACrBG,EAAOzE,KAAK,eAAD7K,OAAgBmP,EAAU9J,QAAQ,GAAE,MAGjD,MAAMkK,EAAcD,EAAO5O,OAAS,EAAI4O,EAAOE,KAAK,OAAS,2BAC7D,MAAO,CACLnB,MAAM,GAADrO,OAAKuO,EAAS,MAAAvO,OAAKuP,EAAW,aAAAvP,OAAYiP,OAAOG,GAAS,GAAG/J,QAAQ,GAAE,MAC5E/C,KAAMgM,EAAMhM,KAEhB,CAGA,MAAMmN,EAAanB,EAAMmB,YAAc,GACjCC,EAAUpB,EAAMoB,SAAW,GAC3BL,EAAQJ,OAAOC,SAASZ,EAAMe,OAASf,EAAMe,MAASf,EAAMe,MAAQJ,OAAOX,EAAMe,OAAS,EAEhG,OAAII,GAAcC,EACT,CACLrB,MAAM,GAADrO,OAAKuO,EAAS,MAAAvO,OAAKyP,EAAU,OAAAzP,OAAM0P,EAAO,MAAA1P,OAAKqP,EAAMhK,QAAQ,GAAE,MACpE/C,KAAMgM,EAAMhM,MAKZ+M,EAAQ,EACH,CACLhB,MAAM,GAADrO,OAAKuO,EAAS,MAAAvO,OAAKqP,EAAMhK,QAAQ,GAAE,KACxC/C,KAAMgM,EAAMhM,MAIT,CACL+L,MAAOE,EACPjM,KAAMgM,EAAMhM,OAaVc,GAAwBuM,IAC5B,MACMC,GADiBzJ,EAAkB6B,KAAc,CAAC,GACjB2H,GAEvC,OAAKC,EAEEpG,OAAOqG,OAAOD,GAAiBE,OAAO,CAACV,EAAOd,KACnD,IAAKA,GAAwB,aAAfA,EAAMhM,KAAqB,OAAO8M,EAGhD,GAAIH,OAAOC,SAASZ,EAAMe,OACxB,OAAOD,GAASd,EAAMe,OAAS,GAIjC,GAAmB,oBAAff,EAAMhM,KAA4B,CAGpC,OAAO8M,GAFWH,OAAOC,SAASZ,EAAMU,WAAaV,EAAMU,UAAaV,EAAMU,UAAYC,OAAOX,EAAMU,WAAa,IAClGC,OAAOC,SAASZ,EAAMa,WAAab,EAAMa,UAAab,EAAMa,UAAYF,OAAOX,EAAMa,WAAa,EAEtH,CAGA,OAAOC,GAASd,EAAMe,OAAS,IAC9B,GAnB0B,GAuBzBU,GAAgCJ,IACpC,MACMC,GADiBzJ,EAAkB6B,KAAc,CAAC,GACjB2H,GAEvC,IAAKC,EAAiB,MAAO,CAAEI,iBAAiB,GAEhD,MAAMC,EAAkB,GAGxB,IAAK,IAAIrF,EAAI,EAAGA,GAAK,EAAGA,IAAK,CAC3B,MACM0D,EAAQsB,EADF,MAAA5P,OAAS4K,IAGjB0D,GAAwB,aAAfA,EAAMhM,MACA,eAAfgM,EAAMhM,MAAwC,YAAfgM,EAAMhM,MACtB,YAAfgM,EAAMhM,MAAsBgM,EAAMmB,YAAcnB,EAAMoB,SACxDO,EAAgBpF,KAAK,CACnBqF,IAAKtF,EACL6E,WAAYnB,EAAMmB,WAClBC,QAASpB,EAAMoB,QACfpN,KAAMgM,EAAMhM,MAGlB,CAGA,IAAK,IAAIsI,EAAI,EAAGA,EAAIqF,EAAgBvP,OAAS,EAAGkK,IAAK,CACnD,MAAMuF,EAAcF,EAAgBrF,GAC9BwF,EAAiBH,EAAgBrF,EAAI,GAG3C,GAAIwF,EAAeF,MAAQC,EAAYD,IAAM,EAAG,CAC9C,MAAOG,EAAeC,GAAgBH,EAAYT,QAAQa,MAAM,KAAK9L,IAAIwK,SAClEuB,EAAqBC,GAAsBL,EAAeX,WAAWc,MAAM,KAAK9L,IAAIwK,QAUrFyB,GAFkB,MALmB,GAAhBL,EAAqBC,IACO,GAAtBE,EAA2BC,IAMb,GAE/C,GAAIC,EAAkB,GACpB,MAAO,CACLV,iBAAiB,EACjB1N,KAAM,WACNqO,QAAQ,YAAD3Q,OAAc0Q,EAAgBrL,QAAQ,GAAE,0CAAArF,OAAyC9B,GAAWiS,EAAYD,IAAM,GAAE,cAAAlQ,OAAamQ,EAAYT,QAAO,WAAA1P,OAAU9B,GAAWkS,EAAeF,IAAM,GAAE,aAAAlQ,OAAYoQ,EAAeX,WAAU,KAG9O,CACF,CAEA,MAAO,CAAEO,iBAAiB,IAItBY,GAAyBjB,IAE7B,MAAMzP,EAAUwN,GAAkBjF,KAAKC,GAAKA,EAAEtD,KAAOuK,GAC/C5P,GAAeH,EAAAA,EAAAA,KAA2B,OAAPM,QAAO,IAAPA,OAAO,EAAPA,EAASL,eAAgB,aAG5DgR,EAAezN,GAAqBuM,GAC1C,GAAIkB,EAAe9Q,EACjB,MAAO,CACLiQ,iBAAiB,EACjB1N,KAAM,QACNqO,QAAQ,yCAAD3Q,OAAwCD,EAAY,0CAAAC,QAA6C,OAAPE,QAAO,IAAPA,OAAO,EAAPA,EAASL,eAAgB,YAAW,MAAAG,OAAK6Q,EAAaxL,QAAQ,GAAE,sBAKrK,MAAMyL,EAAoBf,GAA6BJ,GACvD,OAAImB,EAAkBd,gBACbc,EAGF,CAAEd,iBAAiB,IA0CtBe,GAAyB7Q,IAC7B,MAAM8Q,EAAaJ,GAAsB1Q,EAAQkF,IAEjD,GAAI4L,EAAWhB,gBAAiB,CAC9BpI,GAAoB1H,GACpB4H,GAAkBkJ,EAAW1O,MAC7ByF,GAAqBiJ,EAAWL,SAEhC,MAAMM,EA9C0BjO,KAClC,IAAKA,EAAkB,MAAO,GAS9B,MAAMkO,EAN0BjL,EAAS0H,OAAOjF,GAC9CA,EAAEtD,KAAOpC,EAAiBoC,IAC1BsD,EAAEvI,eAAiB6C,EAAiB7C,cAIYwN,OAAOjF,IACvD,MAAMmI,EAAezN,GAAqBsF,EAAEtD,IACtC0L,EAAoBf,GAA6BrH,EAAEtD,IAEzD,OAAOyL,GADcjR,EAAAA,EAAAA,IAAoB8I,EAAE7I,cAAgB,aACrB,IAAOiR,EAAkBd,kBAIjE,GAA+B,IAA3BkB,EAAgBxQ,OAQlB,OAPqBuF,EAAS0H,OAAOjF,GAChB,+BAAnBA,EAAEvI,cACFuI,EAAEyI,0BACFhE,MAAMiE,QAAQ1I,EAAEyI,2BAChBzI,EAAEyI,yBAAyBE,SAASrO,EAAiB7C,eAGnCwN,OAAOjF,IACzB,MAAMmI,EAAezN,GAAqBsF,EAAEtD,IACtC0L,EAAoBf,GAA6BrH,EAAEtD,IAEzD,OAAOyL,GADcjR,EAAAA,EAAAA,IAAoB8I,EAAE7I,cAAgB,aACrB,IAAOiR,EAAkBd,kBAInE,OAAOkB,GAYeI,CAA2BpR,GAC/C2H,GAAqBoJ,GAErBtJ,IAAwB,EAC1B,GAYF,OAAI7B,GAEApC,EAAAA,GAAAA,KAACoI,EAAAA,EAAG,CAAChI,GAAI,CAAEmI,QAAS,OAAQC,eAAgB,SAAUrH,WAAY,SAAU0M,OAAQ,QAAS9N,UAC3FC,EAAAA,GAAAA,KAAC8N,EAAAA,EAAgB,OAMrBnO,EAAAA,GAAAA,MAACoO,EAAAA,EAAS,CAACjO,SAAS,KAAKM,GAAI,CAC3BQ,GAAI,CAAE2I,GAAI,EAAGyE,GAAI,GACjB3N,GAAI,CAAEkJ,GAAI,EAAGyE,GAAI,GACjBC,GAAI,CAAE1E,GAAI,EAAG2E,GAAI,EAAGF,GAAI,IACxBjO,SAAA,EACAC,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CACTC,QAAQ,KACRe,UAAU,KACVd,cAAY,EACZN,GAAI,CACFvB,WAAY,OACZC,MAAO,uBACPqP,UAAW,CAAE5E,GAAI,SAAUyE,GAAI,QAC/B3N,GAAI,CAAEkJ,GAAI,EAAGyE,GAAI,GACjBnF,SAAU,CAAEU,GAAI,SAAUyE,GAAI,aAC9BjO,SACH,yBAIAmF,KACCvF,EAAAA,GAAAA,MAACyI,EAAAA,EAAG,CAAChI,GAAI,CAAEmI,QAAS,OAAQ6F,IAAK,EAAG/N,GAAI,EAAGmI,eAAgB,CAAEe,GAAI,SAAUyE,GAAI,aAAejO,SAAA,EAC5FC,EAAAA,GAAAA,KAAC8B,EAAAA,EAAM,CACLrB,QAAQ,WACR2G,WAAWpH,EAAAA,GAAAA,KAACqO,GAAAA,EAAU,IACtBtM,QAASA,IAAMuM,KACf3F,KAAMzG,EAAW,QAAU,SAASnC,SACrC,sBAGDC,EAAAA,GAAAA,KAAC8B,EAAAA,EAAM,CACLrB,QAAQ,YACR3B,MAAM,UACNsI,WAAWpH,EAAAA,GAAAA,KAACuO,GAAAA,EAAgB,IAC5BxM,QAASA,IAAMyM,KACf7F,KAAMzG,EAAW,QAAU,SAASnC,SACrC,uBAMLJ,EAAAA,GAAAA,MAACtC,GAAW,CAACoR,UAAW,EAAGrO,GAAI,CAAEC,GAAI,CAAEkJ,GAAI,EAAGyE,GAAI,GAAK3F,EAAG,CAAEkB,GAAI,IAAK2E,GAAI,EAAGF,GAAI,IAAMjO,SAAA,EAEpFJ,EAAAA,GAAAA,MAACwJ,EAAAA,GAAI,CAACC,WAAS,EAACzL,QAAS,CAAE4L,GAAI,EAAGyE,GAAI,GAAK7M,WAAW,SAASf,GAAI,CAAEC,GAAI,CAAEkJ,GAAI,EAAGyE,GAAI,IAAMjO,SAAA,EAC1FC,EAAAA,GAAAA,KAACmJ,EAAAA,GAAI,CAACG,MAAI,EAACC,GAAI,GAAIyE,GAAI,EAAEjO,UACvBC,EAAAA,GAAAA,KAAC0O,EAAAA,EAAK,CACJC,UAAW,CAAEpF,GAAI,SAAU2E,GAAI,OAC/BvQ,QAAS,EACTwD,WAAW,SACXf,GAAI,CAAEkI,MAAO,QAASvI,UAEtBJ,EAAAA,GAAAA,MAAC+O,EAAAA,EAAK,CAACC,UAAU,MAAMhR,QAAS,EAAGwD,WAAW,SAASf,GAAI,CAAEoI,eAAgB,UAAWzI,SAAA,EACtFC,EAAAA,GAAAA,KAACyI,EAAAA,EAAU,CAAC1G,QAzgBD6M,KACvB,MAAMC,GAAcC,EAAAA,GAAAA,GAASnM,EAAoB,GACjDC,EAAsBiM,IAugB6BlG,KAAK,QAAO5I,UACjDC,EAAAA,GAAAA,KAAC4I,GAAAA,EAAmB,CAACC,SAAS,aAGhC7I,EAAAA,GAAAA,KAAC2G,GAAkB,KAEnB3G,EAAAA,GAAAA,KAACyI,EAAAA,EAAU,CAAC1G,QArhBJgN,KACpB,MAAMF,GAAcG,EAAAA,EAAAA,GAASrM,EAAoB,GACjDC,EAAsBiM,IAmhB0BlG,KAAK,QAAO5I,UAC9CC,EAAAA,GAAAA,KAACkJ,GAAAA,EAAmB,CAACL,SAAS,oBAMtC7I,EAAAA,GAAAA,KAACmJ,EAAAA,GAAI,CAACG,MAAI,EAACC,GAAI,GAAIyE,GAAI,EAAEjO,UACvBJ,EAAAA,GAAAA,MAACsP,EAAAA,EAAW,CAACpP,WAAS,EAAC8I,KAAMzG,EAAW,QAAU,SAASnC,SAAA,EACzDC,EAAAA,GAAAA,KAACkP,EAAAA,EAAU,CAACxN,GAAG,4BAA2B3B,SAAC,kBAC3CJ,EAAAA,GAAAA,MAACwP,EAAAA,EAAM,CACLC,QAAQ,4BACRC,MAAOrM,EACPsM,MAAM,eACNC,SAAWhF,IACTtH,GAA4BsH,EAAEiF,OAAOH,OACrClM,GAA2B,OAC3BpD,SAAA,EAEFC,EAAAA,GAAAA,KAACyP,EAAAA,EAAQ,CAACJ,MAAM,GAAEtP,SAAC,UAClBxF,GAAAA,GAAcwG,IAAK2O,IAClB1P,EAAAA,GAAAA,KAACyP,EAAAA,EAAQ,CAAaJ,MAAOK,EAAM3P,SAAE2P,GAAtBA,aAMvB1P,EAAAA,GAAAA,KAACmJ,EAAAA,GAAI,CAACG,MAAI,EAACC,GAAI,GAAIyE,GAAI,EAAEjO,UACvBC,EAAAA,GAAAA,KAAC2P,EAAAA,EAAY,CACXC,QAASrN,EACTsN,eAAiBC,GAAM,GAAAxT,OAAQwT,EAAOxP,OAAM,KAAAhE,OAAIwT,EAAOvP,WACvDwP,YAAcC,IACZhQ,EAAAA,GAAAA,KAACiQ,EAAAA,GAAS/J,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACJ8J,GAAM,IACVV,MAAM,qBACN3G,KAAMzG,EAAW,QAAU,SAC3BgO,YAAUhK,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACL8J,EAAOE,YAAU,IACpBC,cACExQ,EAAAA,GAAAA,MAAAgB,GAAAA,SAAA,CAAAZ,SAAA,CACGiQ,EAAOE,WAAWC,cACnBnQ,EAAAA,GAAAA,KAACoQ,GAAAA,EAAU,CAACtR,MAAM,mBAM5BuQ,MAAOnM,GACPqM,SAAUA,CAACjI,EAAO+I,KAChBlN,GAA2BkN,GACvBA,GACFpN,GAA4BoN,EAAS5T,eAGzC6T,qBAAsBA,CAACR,EAAQT,IAAUS,EAAOpO,MAAY,OAAL2N,QAAK,IAALA,OAAK,EAALA,EAAO3N,YAKpD/B,EAAAA,GAAAA,MAACa,EAAAA,EAAU,CACTC,QAAQ,KACRC,cAAY,EACZN,GAAI,CACFyI,SAAU,CAAEU,GAAI,OAAQyE,GAAI,WAC5B3N,GAAI,CAAEkJ,GAAI,EAAGyE,GAAI,IACjBjO,SAAA,CACH,eACa+I,EAAAA,GAAAA,GAAOnG,EAAoB,cAAe,CAAEoG,OAAQC,GAAAA,IAAM,QAAKF,EAAAA,GAAAA,IAAOyH,EAAAA,GAAAA,GAAQ5N,EAAoB,GAAI,cAAe,CAAEoG,OAAQC,GAAAA,OAI3JvG,EAAkB6B,IAMa,IAA7B0F,GAAkBhN,QACpBgD,EAAAA,GAAAA,KAACoI,EAAAA,EAAG,CAAChI,GAAI,CAAEoQ,GAAI,EAAGrC,UAAW,UAAWpO,UACtCC,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CAACC,QAAQ,YAAY3B,MAAM,iBAAgBiB,SAAC,iEAKzDC,EAAAA,GAAAA,KAACoI,EAAAA,EAAG,CAAArI,SACDiK,GAAkBjJ,IAAIvE,IAAY,IAADiU,EAChC,MAAMvE,EAA8C,QAA/BuE,EAAGhO,EAAkB6B,WAAU,IAAAmM,OAAA,EAA5BA,EAA+BjU,EAAQkF,IACzDyL,EAAezN,GAAqBlD,EAAQkF,IAC5CgP,EAAYtN,GAAqB5G,EAAQkF,MAAO,EAEtD,OACE/B,EAAAA,GAAAA,MAACgR,EAAAA,EAAI,CAAkBvQ,GAAI,CACzBC,GAAI,EACJzC,aAAc,CAAE2L,GAAI,MAAOyE,GAAI,QAC/B4C,SAAU,WACV7Q,SAAA,EACAC,EAAAA,GAAAA,KAAC6Q,EAAAA,EAAU,CACTC,QAAQ9Q,EAAAA,GAAAA,KAAC+Q,GAAAA,EAAU,IACnBC,OACErR,EAAAA,GAAAA,MAACa,EAAAA,EAAU,CAACC,QAASyB,EAAW,YAAc,KAAKnC,SAAA,CAChDvD,EAAQ8D,OAAO,IAAE9D,EAAQ+D,aAG9B0Q,WACEtR,EAAAA,GAAAA,MAACa,EAAAA,EAAU,CAACC,QAASyB,EAAW,UAAY,QAAQnC,SAAA,CACjDvD,EAAQiF,MAAM,MAAIjF,EAAQC,gBAG/B6B,QACEqB,EAAAA,GAAAA,MAACyI,EAAAA,EAAG,CAAChI,GAAI,CACPmI,QAAS,OACTpH,WAAY,SACZ+P,cAAe,CAAE3H,GAAI,SAAU2E,GAAI,OACnCE,IAAK,CAAE7E,GAAI,GAAK2E,GAAI,IACpBnO,SAAA,EACAC,EAAAA,GAAAA,KAACmR,EAAAA,EAAI,CACH7B,MAAK,GAAAhT,OAAK6Q,EAAaxL,QAAQ,GAAE,UACjC7C,MAAOqO,EAAe,GAAK,QAAU,UACrCxE,KAAK,QACLvI,GAAI,CAAEgR,OAAQ,WACdrP,QAASA,KACYmL,GAAsB1Q,EAAQkF,IAClC4K,iBACbe,GAAsB7Q,MAI3B6P,GAA6B7P,EAAQkF,IAAI4K,kBACxCtM,EAAAA,GAAAA,KAACmR,EAAAA,EAAI,CACH7B,MAAOpN,EAAW,kBAAe,wBACjCpD,MAAM,UACN6J,KAAK,QACLvI,GAAI,CAAEgR,OAAQ,WACdrP,QAASA,IAAMsL,GAAsB7Q,MAGzCwD,EAAAA,GAAAA,KAACyI,EAAAA,EAAU,CACT1G,QAASA,KAAMsP,OAlYRpF,EAkY8BzP,EAAQkF,QAjYnE2B,GAAwBiO,IAAIpL,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACvBoL,GAAI,IACP,CAACrF,IAAaqF,EAAKrF,MAHQA,OAmYP,gBAAeyE,EACf,aAAW,iBACX/H,KAAMzG,EAAW,QAAU,SAASnC,SAEnC2Q,GAAY1Q,EAAAA,GAAAA,KAACuR,GAAAA,EAAc,KAAMvR,EAAAA,GAAAA,KAACwR,GAAAA,EAAc,SAIvDpR,GAAI,CACF,2BAA4B,CAC1BwQ,SAAU,cAIhB5Q,EAAAA,GAAAA,KAACyR,EAAAA,EAAQ,CAACC,GAAIhB,EAAWiB,QAAQ,OAAOC,eAAa,EAAA7R,UACnDJ,EAAAA,GAAAA,MAACkS,EAAAA,EAAW,CAACzR,GAAI,CAAEiI,EAAG,CAAEkB,GAAI,EAAGyE,GAAI,IAAMjO,SAAA,EACvCC,EAAAA,GAAAA,KAACoI,EAAAA,EAAG,CAAChI,GAAI,CACPmI,QAAS,CAAEgB,GAAI,OAAQyE,GAAI,UAC3BjO,UACAC,EAAAA,GAAAA,KAAC8R,EAAAA,EAAc,CAAA/R,UACbJ,EAAAA,GAAAA,MAACoS,EAAAA,EAAK,CAACpJ,KAAK,QAAO5I,SAAA,EACjBC,EAAAA,GAAAA,KAACgS,EAAAA,EAAS,CAAAjS,UACRJ,EAAAA,GAAAA,MAACzB,EAAAA,EAAQ,CAAA6B,SAAA,EACPC,EAAAA,GAAAA,KAACtB,EAAAA,EAAS,CAAAqB,SAAC,YACXC,EAAAA,GAAAA,KAACtB,EAAAA,EAAS,CAAAqB,SAAC,WACXC,EAAAA,GAAAA,KAACtB,EAAAA,EAAS,CAAAqB,SAAC,kBAGfC,EAAAA,GAAAA,KAACiS,EAAAA,EAAS,CAAAlS,SACPvF,GAAWuG,IAAI,CAACyL,EAAKxL,KACpB,MAAM0J,EAAM,MAAApO,OAAS0E,EAAQ,GACvBuD,GAAQuE,EAAAA,GAAAA,IAAOyH,EAAAA,GAAAA,GAAQ5N,EAAoB3B,GAAQ,QAAS,CAAE+H,OAAQC,GAAAA,IACtEkJ,EAAU1H,GAAiB0B,EAAiBxB,GAElD,OACE/K,EAAAA,GAAAA,MAAC1B,GAAc,CAAA8B,SAAA,EACbC,EAAAA,GAAAA,KAACtB,EAAAA,EAAS,CAAAqB,SAAEyM,KACZxM,EAAAA,GAAAA,KAACtB,EAAAA,EAAS,CAAAqB,SAAEwE,KACZvE,EAAAA,GAAAA,KAACvB,GAAQ,CAACG,KAAMsT,EAAQtT,KAAKmB,SAC1BmS,EAAQvH,UAJQD,eAejC1K,EAAAA,GAAAA,KAACoI,EAAAA,EAAG,CAAChI,GAAI,CACPmI,QAAS,CAAEgB,GAAI,QAASyE,GAAI,SAC5BjO,UACAC,EAAAA,GAAAA,KAACa,EAAAA,EAAI,CAACsR,OAAK,EAAApS,SACRvF,GAAWuG,IAAI,CAACyL,EAAKxL,KACpB,MAAM0J,EAAM,MAAApO,OAAS0E,EAAQ,GACvBuD,GAAQuE,EAAAA,GAAAA,IAAOyH,EAAAA,GAAAA,GAAQ5N,EAAoB3B,GAAQ,QAAS,CAAE+H,OAAQC,GAAAA,IACtEkJ,EAAU1H,GAAiB0B,EAAiBxB,GAElD,OACE/K,EAAAA,GAAAA,MAACuB,EAAAA,GAAQ,CAAckR,SAAO,EAAArS,SAAA,EAC5BC,EAAAA,GAAAA,KAACoB,EAAAA,EAAc,CAAArB,UACbC,EAAAA,GAAAA,KAACqB,EAAAA,EAAM,CACLjB,GAAI,CACFkI,MAAO,GACPuF,OAAQ,GACRhF,SAAU,UACV/H,QAA0B,gBAAjBoR,EAAQtT,KACb,UACiB,kBAAjBsT,EAAQtT,KACR,eACA,YACJmB,SAEDyM,EAAI6F,MAAM,EAAG,QAGlBrS,EAAAA,GAAAA,KAACuB,EAAAA,EAAY,CACXtC,SACEU,EAAAA,GAAAA,MAACa,EAAAA,EAAU,CAACC,QAAQ,QAAQL,GAAI,CAAEvB,WAAY,UAAWkB,SAAA,CACtDyM,EAAI,MAAIjI,KAGbvF,WACEgB,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CACTC,QAAQ,UACRL,GAAI,CACFtB,MAAwB,aAAjBoT,EAAQtT,KACX,iBACA,eACJC,WAA6B,aAAjBqT,EAAQtT,KAAsB,SAAW,UACrDmB,SAEDmS,EAAQvH,YAjCFD,gBA3GlBlO,EAAQkF,SAnBzB1B,EAAAA,GAAAA,KAACoI,EAAAA,EAAG,CAAChI,GAAI,CAAEoQ,GAAI,EAAGrC,UAAW,UAAWpO,UACtCC,EAAAA,GAAAA,KAACQ,EAAAA,EAAU,CAACC,QAAQ,YAAY3B,MAAM,iBAAgBiB,SAAC,wDAiL7DC,EAAAA,GAAAA,KAACd,GAAgB,CACfE,KAAM4E,GACN3E,QAxUyBiT,KAC7BrO,IAAwB,GACxBC,GAAoB,MACpBC,GAAqB,IACrBC,GAAkB,IAClBC,GAAqB,KAoUjB/E,iBAAkBA,GAClBC,kBAAmBA,GACnBC,eAAgBA,GAChBC,kBAAmBA,GACnBC,qBAAsBA,SA6FxB4O,GAAeA,KAEnB,MAAMiE,EAAgBnI,KAAKoI,MAAMtI,aAAauI,QAAQ,qBAAuB,GACvEC,EAAiBtI,KAAKoI,MAAMtI,aAAauI,QAAQ,8BAAgC,CAAC,EAClFE,EAAc,IAAI7P,KAAKoH,aAAauI,QAAQ,8BAAgC3P,KAAK8P,OAGjFjN,EAAkC,qBAAXkN,QAA0BA,OAAOC,oBAAuBD,OAAOC,oBAAsBP,EAC5GQ,EAAmC,qBAAXF,QAA0BA,OAAOG,qBAAwBH,OAAOG,qBAAuBN,EAC/GO,EAAgC,qBAAXJ,QAA0BA,OAAOK,kBAAqB,IAAIpQ,KAAK+P,OAAOK,mBAAqBP,EAEhHrO,EAAY,MAAS,MAAM6O,GAAIzP,EAAAA,EAAAA,GAAQuP,GAAmBG,GAAI1O,EAAAA,EAAAA,GAAWuO,GAAa,MAAM,GAAN3W,OAAU6W,EAAC,KAAA7W,OAAI8W,EAAM,EAA/F,GAGZC,EAAO,GAEPC,EAAS,CAAC,cAAe,kBAAmB9Y,IAClD6Y,EAAKlM,KAAKmM,GAEV3N,EAAa4N,QAAQvO,IACnB,MAAMwO,EAAM,CAAC,GAADlX,OAAI0I,EAAE1E,OAAM,KAAAhE,OAAI0I,EAAEzE,WAAayE,EAAEvI,cAAgB,IAC7D,IAAK,IAAIyK,EAAI,EAAGA,GAAK,EAAGA,IAAK,CAC3B,MAAMwD,EAAM,MAAApO,OAAS4K,GACf0D,EAAQmI,EAAczO,IAAcyO,EAAczO,GAAWU,EAAEtD,KAAOqR,EAAczO,GAAWU,EAAEtD,IAAIgJ,GACtGE,EACmB,aAAfA,EAAMhM,KAAqB4U,EAAIrM,KAAK,YACxCqM,EAAIrM,KAAK,GAAD7K,OAAIsO,EAAMmB,WAAU,OAAAzP,OAAMsO,EAAMoB,QAAO,MAAA1P,QAAMsO,EAAMe,OAAO,GAAGhK,QAAQ,GAAE,OAFxE6R,EAAIrM,KAAK,cAGvB,CACAkM,EAAKlM,KAAKqM,KAGZ,MAAMC,EAAKC,GAAAA,GAAWC,aAAaN,GAEnCI,EAAG,SAAW,CAAC,CAAEG,IAAK,IAAM,CAAEA,IAAK,KAAMtX,OAAO,IAAImN,MAAM,GAAGC,KAAK,CAAEkK,IAAK,MACzE,MAAMC,EAAKH,GAAAA,GAAWI,WACtBJ,GAAAA,GAAWK,kBAAkBF,EAAIJ,EAAG,UAADnX,OAAYgI,IAC/CoP,GAAAA,GAAeG,EAAG,oBAADvX,OAAsBgI,EAAS,WAI5CkK,GAAcA,KAClB,MAAM+D,EAAgBnI,KAAKoI,MAAMtI,aAAauI,QAAQ,qBAAuB,GACvEC,EAAiBtI,KAAKoI,MAAMtI,aAAauI,QAAQ,8BAAgC,CAAC,EAClFE,EAAc,IAAI7P,KAAKoH,aAAauI,QAAQ,8BAAgC3P,KAAK8P,OAEjFjN,EAAkC,qBAAXkN,QAA0BA,OAAOC,oBAAuBD,OAAOC,oBAAsBP,EAC5GQ,EAAmC,qBAAXF,QAA0BA,OAAOG,qBAAwBH,OAAOG,qBAAuBN,EAC/GO,EAAgC,qBAAXJ,QAA0BA,OAAOK,kBAAqB,IAAIpQ,KAAK+P,OAAOK,mBAAqBP,EAGhHqB,EAAS,CAAC,EAChBrO,EAAa4N,QAAQvO,IACnB,MAAMiP,EAAOjP,EAAEvI,cAAgB,mBAC1BuX,EAAOC,KAAOD,EAAOC,GAAQ,IAClCD,EAAOC,GAAM9M,KAAKnC,KAGpB,IAAIkP,EAAI,sFACRA,GAAI,mfASJA,GAAI,gBACJA,GAAI,4EAAA5X,QAAgFwM,EAAAA,GAAAA,GAAOmK,EAAY,mBAAoB,CAAElK,OAAQC,GAAAA,IAAK,eAE1IlD,OAAOqO,KAAKH,GAAQT,QAAQU,IAC1BC,GAAI,6BAAA5X,OAAiC2X,EAAI,mBAC3CC,GAAI,yCACJ1Z,GAAW+Y,QAAQa,IAAOF,GAAI,OAAA5X,OAAW8X,EAAC,WAC1CF,GAAI,uBACFF,EAAOC,GAAMV,QAAQvO,IACnBkP,GAAI,WAAA5X,OAAe0I,EAAE1E,OAAM,KAAAhE,OAAI0I,EAAEzE,UAAS,SAC1C,MAAM+D,EAAY,MAAS,MAAM6O,GAAIzP,EAAAA,EAAAA,GAAQuP,GAAmBG,GAAI1O,EAAAA,EAAAA,GAAWuO,GAAa,MAAM,GAAN3W,OAAU6W,EAAC,KAAA7W,OAAI8W,EAAM,EAA/F,GAClB,IAAK,IAAIlM,EAAE,EAAEA,GAAG,EAAEA,IAAI,CACpB,MAAMwD,EAAM,MAAApO,OAAS4K,GACf0D,EAAQmI,EAAczO,IAAcyO,EAAczO,GAAWU,EAAEtD,KAAOqR,EAAczO,GAAWU,EAAEtD,IAAIgJ,GACtGE,EACmB,aAAfA,EAAMhM,KAAqBsV,GAAI,oBACnCA,GAAI,OAAA5X,OAAWsO,EAAMmB,WAAU,OAAAzP,OAAMsO,EAAMoB,QAAO,MAAA1P,QAAMsO,EAAMe,OAAO,GAAGhK,QAAQ,GAAE,WAF3EuS,GAAI,sBAGlB,CACAA,GAAI,UAENA,GAAI,qBAGNA,GAAI,iBAEJ,MAAMd,EAAIP,OAAOzT,KAAK,GAAI,UAC1BgU,EAAEiB,SAASjV,OACXgU,EAAEiB,SAASC,MAAMJ,GACjBd,EAAEiB,SAASE,QACXC,WAAW,KAAQpB,EAAEqB,SAAY,K","sources":["utils/horariosConstants.js","utils/contratoUtils.js","components/consulta/ConsultaHorarios.js"],"sourcesContent":["export const departamentos = [\r\n  'Planeación de Eventos',\r\n  'Gestión de la Protección',\r\n  'Áreas & Sostenibilidad',\r\n  'Gastronomía',\r\n  'Infraestructura',\r\n  'Financiero',\r\n  'Oficina de Atención al Expositor',\r\n  'Practicantes/Crosstraining',\r\n  'Talento Humano',\r\n  'Calidad',\r\n  'Sistemas',\r\n  'Mercadeo y Ventas',\r\n  'Compras',\r\n  'Gerencia de Operaciones',\r\n  'Gerencia General',\r\n  'UDEI'\r\n];\r\n\r\nexport const diasSemana = [\r\n  'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'\r\n];\r\n\r\nexport const NO_SUMAN_HORAS = [\r\n  'descanso', 'vacaciones', 'feriado', 'permiso', 'dia-brigada', 'fuera-oficina', 'incapacidad-enfermedad', 'incapacidad-accidente'\r\n  // 'viaje-trabajo' NO debe estar aquí\r\n];\r\n\r\nexport const DIAS_LABELS = {\r\n  dia1: 'Lunes',\r\n  dia2: 'Martes',\r\n  dia3: 'Miércoles',\r\n  dia4: 'Jueves',\r\n  dia5: 'Viernes',\r\n  dia6: 'Sábado',\r\n  dia7: 'Domingo'\r\n};\r\n\r\nexport const TIPO_LABEL = {\r\n  personalizado: 'Presencial',\r\n  teletrabajo: 'Teletrabajo',\r\n  cambio: 'Cambio',\r\n  descanso: 'Descanso',\r\n  vacaciones: 'Vacaciones',\r\n  feriado: 'Feriado',\r\n  permiso: 'Permiso',\r\n  'tarde-libre': 'Tarde Libre',\r\n  'dia-brigada': 'Brigada',\r\n  'fuera-oficina': 'Fuera de Oficina',\r\n  'viaje-trabajo': 'Viaje de Trabajo',\r\n  'incapacidad-enfermedad': 'Incapacidad por Enfermedad',\r\n  'incapacidad-accidente': 'Incapacidad por Accidente',\r\n  'tele-presencial': 'Teletrabajo & Presencial'\r\n};","/**\r\n * Utilidades para manejo de tipos de contrato, roles y restricciones de horas\r\n */\r\n\r\n// Tipos de contrato disponibles\r\nexport const TIPOS_CONTRATO = {\r\n  OPERATIVO: 'Operativo',\r\n  CONFIANZA: 'Confianza'\r\n};\r\n\r\n// Roles disponibles en el sistema\r\nexport const ROLES = {\r\n  ADMINISTRADOR: 'Administrador',\r\n  MODIFICADOR: 'Modificador', \r\n  VISOR: 'Visor'\r\n};\r\n\r\n// Horas máximas permitidas por tipo de contrato\r\nexport const HORAS_MAXIMAS_POR_TIPO = {\r\n  [TIPOS_CONTRATO.OPERATIVO]: 48,\r\n  [TIPOS_CONTRATO.CONFIANZA]: 72\r\n};\r\n\r\n/**\r\n * Obtiene las horas máximas permitidas para un tipo de contrato\r\n * @param {string} tipoContrato - El tipo de contrato del usuario\r\n * @returns {number} Las horas máximas permitidas\r\n */\r\nexport const obtenerHorasMaximas = (tipoContrato) => {\r\n  return HORAS_MAXIMAS_POR_TIPO[tipoContrato] || HORAS_MAXIMAS_POR_TIPO[TIPOS_CONTRATO.OPERATIVO];\r\n};\r\n\r\n/**\r\n * Valida si las horas trabajadas exceden el límite para el tipo de contrato\r\n * @param {number} horasTrabajadas - Las horas trabajadas en la semana\r\n * @param {string} tipoContrato - El tipo de contrato del usuario\r\n * @returns {boolean} true si excede el límite, false en caso contrario\r\n */\r\nexport const excedeHorasMaximas = (horasTrabajadas, tipoContrato) => {\r\n  const horasMaximas = obtenerHorasMaximas(tipoContrato);\r\n  return horasTrabajadas > horasMaximas;\r\n};\r\n\r\n/**\r\n * Obtiene un mensaje descriptivo sobre las restricciones de horas\r\n * @param {string} tipoContrato - El tipo de contrato del usuario\r\n * @returns {string} Mensaje descriptivo de las restricciones\r\n */\r\nexport const obtenerMensajeRestriccionHoras = (tipoContrato) => {\r\n  const horasMaximas = obtenerHorasMaximas(tipoContrato);\r\n  return `Los empleados de tipo ${tipoContrato} tienen un límite de ${horasMaximas} horas semanales.`;\r\n};\r\n\r\n/**\r\n * Verifica si un usuario puede modificar tipos de contrato\r\n * @param {Object} usuario - El objeto usuario con sus datos\r\n * @returns {boolean} true si puede modificar tipos de contrato\r\n */\r\nexport const puedeModificarTipoContrato = (usuario) => {\r\n  return usuario?.departamento === 'Talento Humano';\r\n};\r\n\r\n/**\r\n * Verifica si un usuario puede asignar roles\r\n * @param {Object} usuario - El objeto usuario con sus datos\r\n * @returns {boolean} true si puede asignar roles\r\n */\r\nexport const puedeAsignarRoles = (usuario) => {\r\n  return usuario?.rol === ROLES.ADMINISTRADOR || \r\n         usuario?.departamento === 'Talento Humano' ||\r\n         usuario?.email === 'admin@costaricacc.com';\r\n};\r\n\r\n/**\r\n * Verifica si un usuario puede modificar horarios\r\n * @param {Object} usuario - El objeto usuario con sus datos\r\n * @param {Object} objetivoUsuario - El usuario objetivo a modificar (opcional)\r\n * @returns {boolean} true si puede modificar horarios\r\n */\r\nexport const puedeModificarHorarios = (usuario, objetivoUsuario = null) => {\r\n  // Administradores pueden modificar todo\r\n  if (usuario?.rol === ROLES.ADMINISTRADOR) {\r\n    return true;\r\n  }\r\n  \r\n  // Modificadores pueden modificar horarios de su departamento\r\n  if (usuario?.rol === ROLES.MODIFICADOR) {\r\n    if (!objetivoUsuario) return true; // Permiso general para el departamento\r\n    return usuario?.departamento === objetivoUsuario?.departamento;\r\n  }\r\n  \r\n  // Visores no pueden modificar nada\r\n  if (usuario?.rol === ROLES.VISOR) {\r\n    return false;\r\n  }\r\n  \r\n  // Usuarios sin rol específico mantienen la lógica anterior\r\n  return usuario?.departamento === 'Talento Humano' || \r\n         usuario?.email === 'admin@costaricacc.com';\r\n};\r\n\r\n/**\r\n * Verifica si un usuario puede ver horarios\r\n * @param {Object} usuario - El objeto usuario con sus datos\r\n * @param {Object} objetivoUsuario - El usuario objetivo a ver (opcional)\r\n * @returns {boolean} true si puede ver horarios\r\n */\r\nexport const puedeVerHorarios = (usuario, objetivoUsuario = null) => {\r\n  // Administradores pueden ver todo\r\n  if (usuario?.rol === ROLES.ADMINISTRADOR) {\r\n    return true;\r\n  }\r\n  \r\n  // Modificadores y Visores pueden ver horarios de su departamento\r\n  if (usuario?.rol === ROLES.MODIFICADOR || usuario?.rol === ROLES.VISOR) {\r\n    if (!objetivoUsuario) return true; // Permiso general para el departamento\r\n    return usuario?.departamento === objetivoUsuario?.departamento;\r\n  }\r\n  \r\n  // Usuarios sin rol específico mantienen la lógica anterior\r\n  return usuario?.departamento === 'Talento Humano' || \r\n         usuario?.email === 'admin@costaricacc.com';\r\n};\r\n\r\n/**\r\n * Verifica si un usuario puede acceder al módulo de personal\r\n * @param {Object} usuario - El objeto usuario con sus datos\r\n * @returns {boolean} true si puede acceder al módulo de personal\r\n */\r\nexport const puedeAccederPersonal = (usuario) => {\r\n  return usuario?.rol === ROLES.ADMINISTRADOR ||\r\n         usuario?.departamento === 'Talento Humano' ||\r\n         usuario?.email === 'admin@costaricacc.com';\r\n};\r\n\r\n/**\r\n * Obtiene el color del chip según el rol\r\n * @param {string} rol - El rol del usuario\r\n * @returns {string} El color del chip para Material-UI\r\n */\r\nexport const obtenerColorRol = (rol) => {\r\n  switch (rol) {\r\n    case ROLES.ADMINISTRADOR:\r\n      return 'error'; // Rojo para administrador\r\n    case ROLES.MODIFICADOR:\r\n      return 'warning'; // Naranja para modificador\r\n    case ROLES.VISOR:\r\n      return 'info'; // Azul para visor\r\n    default:\r\n      return 'default'; // Gris por defecto\r\n  }\r\n};\r\n\r\n/**\r\n * Obtiene una descripción del rol\r\n * @param {string} rol - El rol del usuario\r\n * @returns {string} Descripción del rol\r\n */\r\nexport const obtenerDescripcionRol = (rol) => {\r\n  switch (rol) {\r\n    case ROLES.ADMINISTRADOR:\r\n      return 'Puede realizar todos los cambios en la plataforma';\r\n    case ROLES.MODIFICADOR:\r\n      return 'Puede modificar horarios de su departamento';\r\n    case ROLES.VISOR:\r\n      return 'Solo puede ver horarios, sin modificaciones';\r\n    default:\r\n      return 'Sin rol específico asignado';\r\n  }\r\n};\r\n","import React, { useState, useEffect } from 'react';\nimport { ref, get } from 'firebase/database';\nimport { database, auth } from '../../firebase/config';\nimport { toast } from 'react-toastify';\nimport { obtenerHorasMaximas } from '../../utils/contratoUtils';\nimport {\n  Container,\n  Grid,\n  Paper,\n  Typography,\n  Box,\n  Button,\n  CircularProgress,\n  TextField,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  Chip,\n  IconButton,\n  Stack,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Card,\n  CardContent,\n  CardHeader,\n  Collapse,\n  Autocomplete,\n  Popover,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  List,\n  ListItem,\n  ListItemText,\n  ListItemAvatar,\n  Avatar,\n  Divider,\n  useMediaQuery,\n  useTheme\n} from '@mui/material';\nimport { styled } from '@mui/material/styles';\nimport { format, addDays, startOfWeek, getISOWeek, getYear, addWeeks, subWeeks } from 'date-fns';\nimport { es } from 'date-fns/locale';\nimport SearchIcon from '@mui/icons-material/Search';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport ArrowBackIosNewIcon from '@mui/icons-material/ArrowBackIosNew';\nimport ArrowForwardIosIcon from '@mui/icons-material/ArrowForwardIos';\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\nimport ExpandLessIcon from '@mui/icons-material/ExpandLess';\nimport PersonIcon from '@mui/icons-material/Person';\nimport GetAppIcon from '@mui/icons-material/GetApp';\nimport PictureAsPdfIcon from '@mui/icons-material/PictureAsPdf';\nimport { departamentos } from '../../utils/horariosConstants';\nimport * as XLSX from 'xlsx';\n\nconst StyledPaper = styled(Paper)(({ theme }) => ({\n  padding: theme.spacing(3),\n  borderRadius: '16px',\n  boxShadow: '0 8px 24px rgba(0, 0, 0, 0.1)',\n  [theme.breakpoints.down('md')]: {\n    padding: theme.spacing(2),\n    borderRadius: '12px',\n  },\n  [theme.breakpoints.down('sm')]: {\n    padding: theme.spacing(1.5),\n    borderRadius: '8px',\n    margin: theme.spacing(0.5),\n  },\n}));\n\nconst StyledTableRow = styled(TableRow)(({ theme }) => ({\n  '&:nth-of-type(odd)': {\n    backgroundColor: theme.palette.action.hover,\n  },\n  '&:last-child td, &:last-child th': {\n    border: 0,\n  },\n}));\n\nconst TimeCell = styled(TableCell)(({ theme, tipo }) => ({\n  backgroundColor: tipo === 'teletrabajo' || tipo === 'tele-presencial'\n    ? 'rgba(46, 125, 50, 0.06)'\n    : (tipo === 'personalizado' ? 'rgba(63, 81, 181, 0.06)' : 'inherit'),\n  fontWeight: tipo === 'descanso' ? 'normal' : 'bold',\n  color: tipo === 'descanso' ? theme.palette.text.secondary : theme.palette.text.primary,\n}));\n\nconst diasSemana = ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo'];\n\nconst TIPO_LABEL = {\n  personalizado: 'Presencial',\n  teletrabajo: 'Teletrabajo',\n  descanso: 'Descanso',\n  vacaciones: 'Vacaciones',\n  feriado: 'Feriado',\n  permiso: 'Permiso Otorgado por Jefatura',\n  'tarde-libre': 'Tarde Libre',\n  'dia-brigada': 'Día por Brigada'\n};\n\nconst ConsultaHorarios = () => {\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\n  \n  const [loading, setLoading] = useState(true);\n  const [usuarios, setUsuarios] = useState([]);\n  const [horariosRegistros, setHorariosRegistros] = useState({});\n  const [semanaSeleccionada, setSemanaSeleccionada] = useState(startOfWeek(new Date(), { weekStartsOn: 1 }));\n  const [departamentoSeleccionado, setDepartamentoSeleccionado] = useState('');\n  const [colaboradorSeleccionado, setColaboradorSeleccionado] = useState(null);\n  const [expandidosPorUsuario, setExpandidosPorUsuario] = useState({});\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [yearSelected, setYearSelected] = useState(getYear(new Date()));\n  const [monthSelected, setMonthSelected] = useState(new Date().getMonth());\n  const [datePickerOpen, setDatePickerOpen] = useState(false);\n  \n  // Nuevos estados para el modal de sugerencias\n  const [sugerenciasModalOpen, setSugerenciasModalOpen] = useState(false);\n  const [usuarioInfractor, setUsuarioInfractor] = useState(null);\n  const [usuariosSugeridos, setUsuariosSugeridos] = useState([]);\n  const [tipoInfraccion, setTipoInfraccion] = useState('');\n  const [detalleInfraccion, setDetalleInfraccion] = useState('');\n\n  // Función para obtener la clave del registro de la semana (año-numeroSemana)\n  const obtenerClaveSemana = (fecha) => {\n    const year = getYear(fecha);\n    const week = getISOWeek(fecha);\n    return `${year}-${week}`;\n  };\n\n  // Clave de la semana seleccionada\n  const semanaKey = obtenerClaveSemana(semanaSeleccionada);\n\n  // Usuario actual y permisos\n  const usuarioActual = auth.currentUser ? usuarios.find(u => u.id === auth.currentUser.uid) : null;\n  const esAdministrador = usuarioActual?.rol === 'Administrador';\n  \n  // Función para avanzar una semana\n  const avanzarSemana = () => {\n    const nuevaSemana = addWeeks(semanaSeleccionada, 1);\n    setSemanaSeleccionada(nuevaSemana);\n  };\n  \n  // Función para retroceder una semana\n  const retrocederSemana = () => {\n    const nuevaSemana = subWeeks(semanaSeleccionada, 1);\n    setSemanaSeleccionada(nuevaSemana);\n  };\n\n  // Función para manejar la selección de fecha\n  const handleDateSelect = (day) => {\n    const newDate = new Date(yearSelected, monthSelected, day);\n    const weekStart = startOfWeek(newDate, { weekStartsOn: 1 });\n    setSemanaSeleccionada(weekStart);\n    setDatePickerOpen(false);\n    setAnchorEl(null);\n  };\n\n  // Cargar todos los datos\n  useEffect(() => {\n    const cargarDatos = async () => {\n      try {\n        setLoading(true);\n        const user = auth.currentUser;\n        if (!user) return;\n\n        // Cargar usuarios\n        const usuariosRef = ref(database, 'usuarios');\n        const usuariosSnapshot = await get(usuariosRef);\n        if (usuariosSnapshot.exists()) {\n          const usuariosData = usuariosSnapshot.val();\n          const usuariosArray = Object.entries(usuariosData).map(([id, data]) => ({\n            id,\n            ...data\n          }));\n          setUsuarios(usuariosArray);\n        }\n\n        // Cargar registros de horarios disponibles\n        const registrosRef = ref(database, 'horarios_registros');\n        const registrosSnapshot = await get(registrosRef);\n        \n        if (registrosSnapshot.exists()) {\n          const registros = registrosSnapshot.val();\n          setHorariosRegistros(registros);\n        }\n      } catch (error) {\n        console.error('Error al cargar datos:', error);\n        toast.error('Error al cargar datos: ' + error.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    cargarDatos();\n  }, []);\n\n  // Componente personalizado para seleccionar fecha\n  const CustomDateSelector = () => {\n    const handleMenuOpen = (event) => {\n      setAnchorEl(event.currentTarget);\n      setDatePickerOpen(true);\n    };\n  \n    const handleMenuClose = () => {\n      setAnchorEl(null);\n      setDatePickerOpen(false);\n    };\n    \n    // Obtener días del mes actual\n    const daysInMonth = new Date(yearSelected, monthSelected + 1, 0).getDate();\n    const firstDayOfMonth = new Date(yearSelected, monthSelected, 1).getDay();\n    const adjustedFirstDay = firstDayOfMonth === 0 ? 7 : firstDayOfMonth;\n    \n    const days = [];\n    for (let i = 1; i <= daysInMonth; i++) {\n      days.push(i);\n    }\n    \n    const handlePrevMonth = () => {\n      if (monthSelected === 0) {\n        setMonthSelected(11);\n        setYearSelected(yearSelected - 1);\n      } else {\n        setMonthSelected(monthSelected - 1);\n      }\n    };\n    \n    const handleNextMonth = () => {\n      if (monthSelected === 11) {\n        setMonthSelected(0);\n        setYearSelected(yearSelected + 1);\n      } else {\n        setMonthSelected(monthSelected + 1);\n      }\n    };\n    \n    return (\n      <>\n        <Button \n          variant=\"outlined\" \n          startIcon={<CalendarTodayIcon />}\n          onClick={handleMenuOpen}\n          fullWidth\n        >\n          Semana {getISOWeek(semanaSeleccionada)} - {getYear(semanaSeleccionada)}\n        </Button>\n        \n        <Popover\n          open={datePickerOpen}\n          anchorEl={anchorEl}\n          onClose={handleMenuClose}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'center',\n          }}\n          transformOrigin={{\n            vertical: 'top',\n            horizontal: 'center',\n          }}\n          sx={{\n            '& .MuiPopover-paper': {\n              position: 'fixed !important',\n              top: '50% !important',\n              left: '50% !important',\n              transform: 'translate(-50%, -50%) !important',\n              maxWidth: '90vw',\n              maxHeight: '80vh',\n              zIndex: 9999,\n            }\n          }}\n        >\n          <Box sx={{ p: 2, width: 280 }}>\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n              <IconButton onClick={handlePrevMonth} size=\"small\">\n                <ArrowBackIosNewIcon fontSize=\"small\" />\n              </IconButton>\n              <Typography variant=\"subtitle1\">\n                {format(new Date(yearSelected, monthSelected, 1), 'MMMM yyyy', { locale: es })}\n              </Typography>\n              <IconButton onClick={handleNextMonth} size=\"small\">\n                <ArrowForwardIosIcon fontSize=\"small\" />\n              </IconButton>\n            </Box>\n            \n            <Grid container spacing={1}>\n              {['L', 'M', 'X', 'J', 'V', 'S', 'D'].map((day, index) => (\n                <Grid item key={index} xs={12/7}>\n                  <Typography variant=\"caption\" align=\"center\" sx={{ display: 'block' }}>\n                    {day}\n                  </Typography>\n                </Grid>\n              ))}\n              \n              {Array(adjustedFirstDay - 1).fill(null).map((_, index) => (\n                <Grid item key={`empty-${index}`} xs={12/7} />\n              ))}\n              \n              {days.map(day => (\n                <Grid item key={day} xs={12/7}>\n                  <Button \n                    variant=\"text\" \n                    sx={{ \n                      minWidth: 0, \n                      width: '100%',\n                      borderRadius: '50%'\n                    }}\n                    onClick={() => handleDateSelect(day)}\n                  >\n                    {day}\n                  </Button>\n                </Grid>\n              ))}\n            </Grid>\n          </Box>\n        </Popover>\n      </>\n    );\n  };\n\n  // Filtrar usuarios por departamento y búsqueda\n  const usuariosFiltrados = usuarios.filter(usuario => {\n    // Filtro por departamento\n    if (departamentoSeleccionado && usuario.departamento !== departamentoSeleccionado) {\n      return false;\n    }\n    \n    // Filtro por colaborador seleccionado\n    if (colaboradorSeleccionado) {\n      return usuario.id === colaboradorSeleccionado.id;\n    }\n    \n    return true;\n  });\n\n  // Guardar un snapshot en localStorage para las funciones de exportación\n  useEffect(() => {\n    try {\n      localStorage.setItem('usuarios_export', JSON.stringify(usuariosFiltrados));\n      localStorage.setItem('horariosRegistros_export', JSON.stringify(horariosRegistros));\n      localStorage.setItem('semanaSeleccionada_export', semanaSeleccionada.toISOString());\n    } catch (e) {\n      // No crítico\n    }\n  }, [usuariosFiltrados, horariosRegistros, semanaSeleccionada]);\n\n  // Función para formatear los horarios\n  const formatearHorario = (horarioUsuario, diaKey) => {\n    if (!horarioUsuario || !horarioUsuario[diaKey]) {\n      return { texto: 'Sin horario', tipo: null };\n    }\n\n    const turno = horarioUsuario[diaKey];\n\n    if (!turno) {\n      return { texto: 'Sin horario', tipo: null };\n    }\n\n    if (turno.tipo === 'descanso') {\n      return { texto: 'Descanso', tipo: 'descanso' };\n    }\n\n    const tipoTexto = TIPO_LABEL[turno.tipo] || turno.tipo;\n\n    // Nuevo manejo para tele-presencial (dos franjas: tele y presencial)\n    if (turno.tipo === 'tele-presencial') {\n      const teleInicio = turno.horaInicioTele || '';\n      const teleFin = turno.horaFinTele || '';\n      const presInicio = turno.horaInicioPres || '';\n      const presFin = turno.horaFinPres || '';\n\n      const horasTele = Number.isFinite(turno.horasTele) ? turno.horasTele : (turno.horasTele ? Number(turno.horasTele) : 0);\n      const horasPres = Number.isFinite(turno.horasPres) ? turno.horasPres : (turno.horasPres ? Number(turno.horasPres) : 0);\n      const total = Number.isFinite(turno.horas) ? turno.horas : (horasTele + horasPres);\n\n      const partes = [];\n      if (teleInicio && teleFin) {\n        partes.push(`Teletrabajo: ${teleInicio} - ${teleFin} (${horasTele.toFixed(1)}h)`);\n      } else if (horasTele > 0) {\n        partes.push(`Teletrabajo: ${horasTele.toFixed(1)}h`);\n      }\n\n      if (presInicio && presFin) {\n        partes.push(`Presencial: ${presInicio} - ${presFin} (${horasPres.toFixed(1)}h)`);\n      } else if (horasPres > 0) {\n        partes.push(`Presencial: ${horasPres.toFixed(1)}h`);\n      }\n\n      const textoPartes = partes.length > 0 ? partes.join(' / ') : 'Teletrabajo & Presencial';\n      return {\n        texto: `${tipoTexto}: ${textoPartes} (Total: ${Number(total || 0).toFixed(1)}h)`,\n        tipo: turno.tipo\n      };\n    }\n\n    // Manejo genérico para turnos con un solo bloque (incluye \"personalizado\" => Presencial)\n    const horaInicio = turno.horaInicio || '';\n    const horaFin = turno.horaFin || '';\n    const horas = Number.isFinite(turno.horas) ? turno.horas : (turno.horas ? Number(turno.horas) : 0);\n\n    if (horaInicio && horaFin) {\n      return {\n        texto: `${tipoTexto}: ${horaInicio} - ${horaFin} (${horas.toFixed(1)}h)`,\n        tipo: turno.tipo\n      };\n    }\n\n    // Fallback: mostrar la etiqueta y horas si existen\n    if (horas > 0) {\n      return {\n        texto: `${tipoTexto}: ${horas.toFixed(1)}h`,\n        tipo: turno.tipo\n      };\n    }\n\n    return {\n      texto: tipoTexto,\n      tipo: turno.tipo\n    };\n  };\n\n  // Toggle expandir/colapsar usuario\n  const toggleExpandirUsuario = (usuarioId) => {\n    setExpandidosPorUsuario(prev => ({\n      ...prev,\n      [usuarioId]: !prev[usuarioId]\n    }));\n  };\n\n  // Calcular horas totales del usuario en la semana\n  const calcularHorasTotales = (usuarioId) => {\n    const horariosSemana = horariosRegistros[semanaKey] || {};\n    const horariosUsuario = horariosSemana[usuarioId];\n\n    if (!horariosUsuario) return 0;\n\n    return Object.values(horariosUsuario).reduce((total, turno) => {\n      if (!turno || turno.tipo === 'descanso') return total;\n\n      // Si el turno tiene 'horas' explícitas, usarlo\n      if (Number.isFinite(turno.horas)) {\n        return total + (turno.horas || 0);\n      }\n\n      // Para 'tele-presencial' sumar horasTele + horasPres si están presentes\n      if (turno.tipo === 'tele-presencial') {\n        const horasTele = Number.isFinite(turno.horasTele) ? turno.horasTele : (turno.horasTele ? Number(turno.horasTele) : 0);\n        const horasPres = Number.isFinite(turno.horasPres) ? turno.horasPres : (turno.horasPres ? Number(turno.horasPres) : 0);\n        return total + horasTele + horasPres;\n      }\n\n      // Para otros tipos, intentar sumar campo 'horas' o 0\n      return total + (turno.horas || 0);\n    }, 0);\n  };\n\n  // Función para verificar si hay menos de 12 horas entre turnos\n  const verificarDescansoEntreTurnos = (usuarioId) => {\n    const horariosSemana = horariosRegistros[semanaKey] || {};\n    const horariosUsuario = horariosSemana[usuarioId];\n    \n    if (!horariosUsuario) return { tieneInfraccion: false };\n    \n    const turnosLaborales = [];\n    \n    // Recopilar todos los turnos laborales con su día correspondiente\n    for (let i = 1; i <= 7; i++) {\n      const diaKey = `dia${i}`;\n      const turno = horariosUsuario[diaKey];\n      \n      if (turno && turno.tipo !== 'descanso' && \n          turno.tipo !== 'vacaciones' && turno.tipo !== 'feriado' &&\n          turno.tipo !== 'permiso' && turno.horaInicio && turno.horaFin) {\n        turnosLaborales.push({\n          dia: i,\n          horaInicio: turno.horaInicio,\n          horaFin: turno.horaFin,\n          tipo: turno.tipo\n        });\n      }\n    }\n    \n    // Verificar descanso entre turnos consecutivos\n    for (let i = 0; i < turnosLaborales.length - 1; i++) {\n      const turnoActual = turnosLaborales[i];\n      const turnoSiguiente = turnosLaborales[i + 1];\n      \n      // Solo verificar si son días consecutivos (el siguiente día es el día actual + 1)\n      if (turnoSiguiente.dia === turnoActual.dia + 1) {\n        const [horaFinActual, minFinActual] = turnoActual.horaFin.split(':').map(Number);\n        const [horaInicioSiguiente, minInicioSiguiente] = turnoSiguiente.horaInicio.split(':').map(Number);\n        \n        // Convertir todo a minutos desde el inicio del día\n        const finActualEnMinutos = horaFinActual * 60 + minFinActual;\n        const inicioSiguienteEnMinutos = horaInicioSiguiente * 60 + minInicioSiguiente;\n        \n        // Calcular las horas de descanso: desde fin del turno hasta inicio del siguiente día\n        // Si termina a las 17:00 y empieza al día siguiente a las 7:00, hay 14 horas de descanso\n        const minutosHasta24 = (24 * 60) - finActualEnMinutos; // Minutos desde fin turno hasta medianoche\n        const descansoTotalMinutos = minutosHasta24 + inicioSiguienteEnMinutos; // Más minutos desde medianoche hasta inicio\n        const descansoEnHoras = descansoTotalMinutos / 60;\n        \n        if (descansoEnHoras < 12) {\n          return {\n            tieneInfraccion: true,\n            tipo: 'descanso',\n            detalle: `Solo hay ${descansoEnHoras.toFixed(1)} horas de descanso entre el turno del ${diasSemana[turnoActual.dia - 1]} (termina ${turnoActual.horaFin}) y el ${diasSemana[turnoSiguiente.dia - 1]} (inicia ${turnoSiguiente.horaInicio})`\n          };\n        }\n      }\n    }\n    \n    return { tieneInfraccion: false };\n  };\n  \n  // Verificar todas las posibles infracciones\n  const verificarInfracciones = (usuarioId) => {\n    // Obtener datos del usuario para saber su tipo de contrato\n    const usuario = usuariosFiltrados.find(u => u.id === usuarioId);\n    const horasMaximas = obtenerHorasMaximas(usuario?.tipoContrato || 'Operativo');\n    \n    // Verificar horas máximas según el tipo de contrato\n    const horasTotales = calcularHorasTotales(usuarioId);\n    if (horasTotales > horasMaximas) {\n      return {\n        tieneInfraccion: true,\n        tipo: 'horas',\n        detalle: `El colaborador excede el límite de ${horasMaximas} horas semanales según su contrato ${usuario?.tipoContrato || 'Operativo'} (${horasTotales.toFixed(1)} horas asignadas)`\n      };\n    }\n    \n    // Verificar descanso entre turnos (12 horas mínimo)\n    const resultadoDescanso = verificarDescansoEntreTurnos(usuarioId);\n    if (resultadoDescanso.tieneInfraccion) {\n      return resultadoDescanso;\n    }\n    \n    return { tieneInfraccion: false };\n  };\n  \n  // Buscar usuarios alternativos\n  const buscarUsuariosAlternativos = (usuarioInfractor) => {\n    if (!usuarioInfractor) return [];\n    \n    // Primero buscar en el mismo departamento\n    let usuariosMismoDepartamento = usuarios.filter(u => \n      u.id !== usuarioInfractor.id && \n      u.departamento === usuarioInfractor.departamento\n    );\n    \n    // Verificar si tienen menos de las horas máximas permitidas y respetan descanso\n    const usuariosValidos = usuariosMismoDepartamento.filter(u => {\n      const horasTotales = calcularHorasTotales(u.id);\n      const resultadoDescanso = verificarDescansoEntreTurnos(u.id);\n      const horasMaximas = obtenerHorasMaximas(u.tipoContrato || 'Operativo');\n      return horasTotales < (horasMaximas - 8) && !resultadoDescanso.tieneInfraccion; // Dejar margen de 8 horas para el nuevo turno\n    });\n    \n    // Si no hay usuarios válidos, buscar en \"Practicantes/Crosstraining\" QUE ESTÉN AUTORIZADOS\n    if (usuariosValidos.length === 0) {\n      const practicantes = usuarios.filter(u => \n        u.departamento === 'Practicantes/Crosstraining' &&\n        u.departamentosAutorizados && \n        Array.isArray(u.departamentosAutorizados) &&\n        u.departamentosAutorizados.includes(usuarioInfractor.departamento) // Verificar autorización específica\n      );\n      \n      return practicantes.filter(u => {\n        const horasTotales = calcularHorasTotales(u.id);\n        const resultadoDescanso = verificarDescansoEntreTurnos(u.id);\n        const horasMaximas = obtenerHorasMaximas(u.tipoContrato || 'Operativo');\n        return horasTotales < (horasMaximas - 8) && !resultadoDescanso.tieneInfraccion; // Dejar margen de 8 horas para el nuevo turno\n      });\n    }\n    \n    return usuariosValidos;\n  };\n  \n  // Abrir modal de sugerencias\n  const abrirModalSugerencias = (usuario) => {\n    const infraccion = verificarInfracciones(usuario.id);\n    \n    if (infraccion.tieneInfraccion) {\n      setUsuarioInfractor(usuario);\n      setTipoInfraccion(infraccion.tipo);\n      setDetalleInfraccion(infraccion.detalle);\n      \n      const sugerencias = buscarUsuariosAlternativos(usuario);\n      setUsuariosSugeridos(sugerencias);\n      \n      setSugerenciasModalOpen(true);\n    }\n  };\n  \n  // Cerrar modal de sugerencias\n  const cerrarModalSugerencias = () => {\n    setSugerenciasModalOpen(false);\n    setUsuarioInfractor(null);\n    setUsuariosSugeridos([]);\n    setTipoInfraccion('');\n    setDetalleInfraccion('');\n  };\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '80vh' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ \n      mt: { xs: 2, md: 4 }, \n      mb: { xs: 2, md: 4 },\n      px: { xs: 1, sm: 2, md: 3 }\n    }}>\n      <Typography\n        variant=\"h4\"\n        component=\"h1\"\n        gutterBottom\n        sx={{\n          fontWeight: 'bold',\n          color: 'var(--primary-color)',\n          textAlign: { xs: 'center', md: 'left' },\n          mb: { xs: 2, md: 3 },\n          fontSize: { xs: '1.5rem', md: '2.125rem' }\n        }}\n      >\n        Consulta de Horarios\n      </Typography>\n      {/* Botones de exportación visibles solo para administradores */}\n      {esAdministrador && (\n        <Box sx={{ display: 'flex', gap: 1, mb: 2, justifyContent: { xs: 'center', md: 'flex-end' } }}>\n          <Button\n            variant=\"outlined\"\n            startIcon={<GetAppIcon />}\n            onClick={() => exportToXLSX()}\n            size={isMobile ? 'small' : 'medium'}\n          >\n            Exportar a Excel\n          </Button>\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={<PictureAsPdfIcon />}\n            onClick={() => exportToPDF()}\n            size={isMobile ? 'small' : 'medium'}\n          >\n            Exportar a PDF\n          </Button>\n        </Box>\n      )}\n      \n      <StyledPaper elevation={3} sx={{ mb: { xs: 2, md: 4 }, p: { xs: 1.5, sm: 2, md: 3 } }}>\n        {/* Filtros de búsqueda */}\n        <Grid container spacing={{ xs: 2, md: 3 }} alignItems=\"center\" sx={{ mb: { xs: 3, md: 4 } }}>\n          <Grid item xs={12} md={4}>\n            <Stack \n              direction={{ xs: 'column', sm: 'row' }} \n              spacing={1} \n              alignItems=\"center\"\n              sx={{ width: '100%' }}\n            >\n              <Stack direction=\"row\" spacing={1} alignItems=\"center\" sx={{ justifyContent: 'center' }}>\n                <IconButton onClick={retrocederSemana} size=\"small\">\n                  <ArrowBackIosNewIcon fontSize=\"small\" />\n                </IconButton>\n                \n                <CustomDateSelector />\n                \n                <IconButton onClick={avanzarSemana} size=\"small\">\n                  <ArrowForwardIosIcon fontSize=\"small\" />\n                </IconButton>\n              </Stack>\n            </Stack>\n          </Grid>\n          \n          <Grid item xs={12} md={4}>\n            <FormControl fullWidth size={isMobile ? 'small' : 'medium'}>\n              <InputLabel id=\"departamento-select-label\">Departamento</InputLabel>\n              <Select\n                labelId=\"departamento-select-label\"\n                value={departamentoSeleccionado}\n                label=\"Departamento\"\n                onChange={(e) => {\n                  setDepartamentoSeleccionado(e.target.value);\n                  setColaboradorSeleccionado(null);\n                }}\n              >\n                <MenuItem value=\"\">Todos</MenuItem>\n                {departamentos.map((depto) => (\n                  <MenuItem key={depto} value={depto}>{depto}</MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          </Grid>\n          \n          <Grid item xs={12} md={4}>\n            <Autocomplete\n              options={usuarios}\n              getOptionLabel={(option) => `${option.nombre} ${option.apellidos}`}\n              renderInput={(params) => (\n                <TextField \n                  {...params} \n                  label=\"Buscar colaborador\"\n                  size={isMobile ? 'small' : 'medium'}\n                  InputProps={{\n                    ...params.InputProps,\n                    endAdornment: (\n                      <>\n                        {params.InputProps.endAdornment}\n                        <SearchIcon color=\"action\" />\n                      </>\n                    ),\n                  }}\n                />\n              )}\n              value={colaboradorSeleccionado}\n              onChange={(event, newValue) => {\n                setColaboradorSeleccionado(newValue);\n                if (newValue) {\n                  setDepartamentoSeleccionado(newValue.departamento);\n                }\n              }}\n              isOptionEqualToValue={(option, value) => option.id === value?.id}\n            />\n          </Grid>\n        </Grid>\n        \n                        <Typography \n                          variant=\"h6\" \n                          gutterBottom\n                          sx={{ \n                            fontSize: { xs: '1rem', md: '1.25rem' },\n                            mb: { xs: 2, md: 3 }\n                          }}\n                        >\n                          Semana del {format(semanaSeleccionada, \"d 'de' MMMM\", { locale: es })} al {format(addDays(semanaSeleccionada, 6), \"d 'de' MMMM\", { locale: es })}\n                        </Typography>\n        \n        {/* Lista de horarios */}\n        {!horariosRegistros[semanaKey] ? (\n          <Box sx={{ my: 4, textAlign: 'center' }}>\n            <Typography variant=\"subtitle1\" color=\"text.secondary\">\n              No hay registros de horarios para esta semana\n            </Typography>\n          </Box>\n        ) : usuariosFiltrados.length === 0 ? (\n          <Box sx={{ my: 4, textAlign: 'center' }}>\n            <Typography variant=\"subtitle1\" color=\"text.secondary\">\n              No se encontraron colaboradores con los filtros aplicados\n            </Typography>\n          </Box>\n        ) : (\n          <Box>\n            {usuariosFiltrados.map(usuario => {\n              const horariosUsuario = horariosRegistros[semanaKey]?.[usuario.id];\n              const horasTotales = calcularHorasTotales(usuario.id);\n              const expandido = expandidosPorUsuario[usuario.id] || false;\n              \n              return (\n                <Card key={usuario.id} sx={{ \n                  mb: 2, \n                  borderRadius: { xs: '8px', md: '12px' }, \n                  overflow: 'visible' \n                }}>\n                  <CardHeader\n                    avatar={<PersonIcon />}\n                    title={\n                      <Typography variant={isMobile ? 'subtitle2' : 'h6'}>\n                        {usuario.nombre} {usuario.apellidos}\n                      </Typography>\n                    }\n                    subheader={\n                      <Typography variant={isMobile ? 'caption' : 'body2'}>\n                        {usuario.cargo} - {usuario.departamento}\n                      </Typography>\n                    }\n                    action={\n                      <Box sx={{ \n                        display: 'flex', \n                        alignItems: 'center',\n                        flexDirection: { xs: 'column', sm: 'row' },\n                        gap: { xs: 0.5, sm: 1 }\n                      }}>\n                        <Chip \n                          label={`${horasTotales.toFixed(1)} horas`} \n                          color={horasTotales > 48 ? \"error\" : \"default\"}\n                          size=\"small\"\n                          sx={{ cursor: 'pointer' }}\n                          onClick={() => {\n                            const infraccion = verificarInfracciones(usuario.id);\n                            if (infraccion.tieneInfraccion) {\n                              abrirModalSugerencias(usuario);\n                            }\n                          }}\n                        />\n                        {verificarDescansoEntreTurnos(usuario.id).tieneInfraccion && (\n                          <Chip \n                            label={isMobile ? 'Descanso ↓' : 'Descanso insuficiente'}\n                            color=\"warning\"\n                            size=\"small\"\n                            sx={{ cursor: 'pointer' }}\n                            onClick={() => abrirModalSugerencias(usuario)}\n                          />\n                        )}\n                        <IconButton \n                          onClick={() => toggleExpandirUsuario(usuario.id)}\n                          aria-expanded={expandido}\n                          aria-label=\"mostrar más\"\n                          size={isMobile ? 'small' : 'medium'}\n                        >\n                          {expandido ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n                        </IconButton>\n                      </Box>\n                    }\n                    sx={{\n                      '& .MuiCardHeader-content': {\n                        overflow: 'hidden'\n                      }\n                    }}\n                  />\n                  <Collapse in={expandido} timeout=\"auto\" unmountOnExit>\n                    <CardContent sx={{ p: { xs: 1, md: 2 } }}>\n                      <Box sx={{ \n                        display: { xs: 'none', md: 'block' } \n                      }}>\n                        <TableContainer>\n                          <Table size=\"small\">\n                            <TableHead>\n                              <TableRow>\n                                <TableCell>Día</TableCell>\n                                <TableCell>Fecha</TableCell>\n                                <TableCell>Horario</TableCell>\n                              </TableRow>\n                            </TableHead>\n                            <TableBody>\n                              {diasSemana.map((dia, index) => {\n                                const diaKey = `dia${index + 1}`;\n                                const fecha = format(addDays(semanaSeleccionada, index), \"d MMM\", { locale: es });\n                                const horario = formatearHorario(horariosUsuario, diaKey);\n                                \n                                return (\n                                  <StyledTableRow key={diaKey}>\n                                    <TableCell>{dia}</TableCell>\n                                    <TableCell>{fecha}</TableCell>\n                                    <TimeCell tipo={horario.tipo}>\n                                      {horario.texto}\n                                    </TimeCell>\n                                  </StyledTableRow>\n                                );\n                              })}\n                            </TableBody>\n                          </Table>\n                        </TableContainer>\n                      </Box>\n\n                      {/* Vista móvil con lista */}\n                      <Box sx={{ \n                        display: { xs: 'block', md: 'none' } \n                      }}>\n                        <List dense>\n                          {diasSemana.map((dia, index) => {\n                            const diaKey = `dia${index + 1}`;\n                            const fecha = format(addDays(semanaSeleccionada, index), \"d MMM\", { locale: es });\n                            const horario = formatearHorario(horariosUsuario, diaKey);\n                            \n                            return (\n                              <ListItem key={diaKey} divider>\n                                <ListItemAvatar>\n                                  <Avatar \n                                    sx={{ \n                                      width: 32, \n                                      height: 32, \n                                      fontSize: '0.75rem',\n                                      bgcolor: horario.tipo === 'teletrabajo' \n                                        ? '#2e7d32' \n                                        : horario.tipo === 'personalizado' \n                                        ? 'primary.main' \n                                        : 'grey.500'\n                                    }}\n                                  >\n                                    {dia.slice(0, 1)}\n                                  </Avatar>\n                                </ListItemAvatar>\n                                <ListItemText\n                                  primary={\n                                    <Typography variant=\"body2\" sx={{ fontWeight: 'medium' }}>\n                                      {dia} - {fecha}\n                                    </Typography>\n                                  }\n                                  secondary={\n                                    <Typography \n                                      variant=\"caption\" \n                                      sx={{ \n                                        color: horario.tipo === 'descanso' \n                                          ? 'text.secondary' \n                                          : 'text.primary',\n                                        fontWeight: horario.tipo === 'descanso' ? 'normal' : 'medium'\n                                      }}\n                                    >\n                                      {horario.texto}\n                                    </Typography>\n                                  }\n                                />\n                              </ListItem>\n                            );\n                          })}\n                        </List>\n                      </Box>\n                    </CardContent>\n                  </Collapse>\n                </Card>\n              );\n            })}\n          </Box>\n        )}\n      </StyledPaper>\n      \n      {/* Modal de sugerencias */}\n      <ModalSugerencias \n        open={sugerenciasModalOpen}\n        onClose={cerrarModalSugerencias}\n        usuarioInfractor={usuarioInfractor}\n        usuariosSugeridos={usuariosSugeridos}\n        tipoInfraccion={tipoInfraccion}\n        detalleInfraccion={detalleInfraccion}\n        calcularHorasTotales={calcularHorasTotales}\n      />\n    </Container>\n  );\n};\n\n// Modal de sugerencias de usuarios alternativos\nconst ModalSugerencias = ({ \n  open, \n  onClose, \n  usuarioInfractor, \n  usuariosSugeridos, \n  tipoInfraccion, \n  detalleInfraccion,\n  calcularHorasTotales\n}) => {\n  if (!usuarioInfractor) return null;\n  \n  return (\n    <Dialog \n      open={open} \n      onClose={onClose}\n      fullWidth\n      maxWidth=\"sm\"\n    >\n      <DialogTitle>\n        Alerta de Infracción de Reglas\n      </DialogTitle>\n      <DialogContent>\n        <DialogContentText sx={{ mb: 2 }}>\n          <strong>{usuarioInfractor.nombre} {usuarioInfractor.apellidos}</strong> - {usuarioInfractor.departamento}\n        </DialogContentText>\n        \n        <Typography variant=\"body1\" color=\"error\" gutterBottom>\n          <strong>Problema detectado:</strong> {detalleInfraccion}\n        </Typography>\n        \n        {usuariosSugeridos.length > 0 ? (\n          <>\n            <Typography variant=\"body1\" sx={{ mt: 3, mb: 2 }}>\n              <strong>Sugerencias de colaboradores alternativos:</strong>\n            </Typography>\n            \n            <List sx={{ bgcolor: 'background.paper' }}>\n              {usuariosSugeridos.map((usuario, index) => (\n                <React.Fragment key={usuario.id}>\n                  <ListItem alignItems=\"flex-start\">\n                    <ListItemAvatar>\n                      <Avatar>{usuario.nombre.charAt(0)}{usuario.apellidos.charAt(0)}</Avatar>\n                    </ListItemAvatar>\n                    <ListItemText\n                      primary={`${usuario.nombre} ${usuario.apellidos}`}\n                      secondary={\n                        <>\n                          <Typography\n                            component=\"span\"\n                            variant=\"body2\"\n                            color=\"text.primary\"\n                          >\n                            {usuario.cargo} - {usuario.departamento}\n                          </Typography>\n                          <br />\n                          {`Horas asignadas: ${calcularHorasTotales(usuario.id).toFixed(1)} de 48 horas`}\n                        </>\n                      }\n                    />\n                  </ListItem>\n                  {index < usuariosSugeridos.length - 1 && <Divider variant=\"inset\" component=\"li\" />}\n                </React.Fragment>\n              ))}\n            </List>\n          </>\n        ) : (\n          <Typography variant=\"body1\" sx={{ mt: 3, color: 'warning.main' }}>\n            No se encontraron colaboradores disponibles que puedan sustituir a este usuario sin infringir las reglas.\n            Se recomienda considerar la contratación de personal temporal o ajustar los horarios.\n          </Typography>\n        )}\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\">\n          Cerrar\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ConsultaHorarios;\n\n// --- Helpers de exportación ---\n// Nota: la antigua función buildTableHtml fue eliminada porque ya no se usa (generaba un warning de ESLint).\n\nconst exportToXLSX = () => {\n  // Intenta usar snapshots en localStorage si las variables locales no están disponibles\n  const usuariosLocal = JSON.parse(localStorage.getItem('usuarios_export')) || [];\n  const registrosLocal = JSON.parse(localStorage.getItem('horariosRegistros_export')) || {};\n  const semanaLocal = new Date(localStorage.getItem('semanaSeleccionada_export') || Date.now());\n\n  // Preferir datos en memoria si estamos en el componente (window scope)\n  const usuariosData = (typeof window !== 'undefined' && window.__usuarios_export__) ? window.__usuarios_export__ : usuariosLocal;\n  const registrosData = (typeof window !== 'undefined' && window.__registros_export__) ? window.__registros_export__ : registrosLocal;\n  const semanaData = (typeof window !== 'undefined' && window.__semana_export__) ? new Date(window.__semana_export__) : semanaLocal;\n\n  const semanaKey = (() => { const y = getYear(semanaData); const w = getISOWeek(semanaData); return `${y}-${w}`; })();\n\n  // Construir filas\n  const rows = [];\n  // Usar nombres reales de días en español\n  const header = ['Colaborador', 'Departamento', ...diasSemana];\n  rows.push(header);\n\n  usuariosData.forEach(u => {\n    const row = [`${u.nombre} ${u.apellidos}`, u.departamento || ''];\n    for (let i = 1; i <= 7; i++) {\n      const diaKey = `dia${i}`;\n      const turno = registrosData[semanaKey] && registrosData[semanaKey][u.id] && registrosData[semanaKey][u.id][diaKey];\n      if (!turno) row.push('Sin horario');\n      else if (turno.tipo === 'descanso') row.push('Descanso');\n      else row.push(`${turno.horaInicio} - ${turno.horaFin} (${(turno.horas||0).toFixed(1)}h)`);\n    }\n    rows.push(row);\n  });\n\n  const ws = XLSX.utils.aoa_to_sheet(rows);\n  // Ajustes de ancho de columnas\n  ws['!cols'] = [{ wch: 30 }, { wch: 20 }].concat(new Array(7).fill({ wch: 24 }));\n  const wb = XLSX.utils.book_new();\n  XLSX.utils.book_append_sheet(wb, ws, `Semana ${semanaKey}`);\n  XLSX.writeFile(wb, `reporte_horarios_${semanaKey}.xlsx`);\n};\n\n// Actualizar exportToPDF para agrupar por departamento\nconst exportToPDF = () => {\n  const usuariosLocal = JSON.parse(localStorage.getItem('usuarios_export')) || [];\n  const registrosLocal = JSON.parse(localStorage.getItem('horariosRegistros_export')) || {};\n  const semanaLocal = new Date(localStorage.getItem('semanaSeleccionada_export') || Date.now());\n\n  const usuariosData = (typeof window !== 'undefined' && window.__usuarios_export__) ? window.__usuarios_export__ : usuariosLocal;\n  const registrosData = (typeof window !== 'undefined' && window.__registros_export__) ? window.__registros_export__ : registrosLocal;\n  const semanaData = (typeof window !== 'undefined' && window.__semana_export__) ? new Date(window.__semana_export__) : semanaLocal;\n\n  // Agrupar por departamento\n  const grupos = {};\n  usuariosData.forEach(u => {\n    const dept = u.departamento || 'Sin Departamento';\n    if (!grupos[dept]) grupos[dept] = [];\n    grupos[dept].push(u);\n  });\n\n  let html = `<!doctype html><html><head><meta charset=\"utf-8\"><title>Reporte de Horarios</title>`;\n  html += `<style>\n    body{font-family: Arial, sans-serif; color:#333}\n    .header{background:#00830e;color:#fff;padding:12px 16px;border-radius:6px}\n    .title{font-size:18px;margin:0}\n    table{width:100%;border-collapse:collapse;margin-top:8px;margin-bottom:16px}\n    th{background:#f0f0f0;text-align:left;padding:8px;border-bottom:1px solid #ddd}\n    td{padding:8px;border-bottom:1px solid #eee}\n    .dept{background:#f5f5f5;padding:8px;margin-top:12px;border-left:6px solid #00830e}\n  </style>`;\n  html += `</head><body>`;\n  html += `<div class=\"header\"><h2 class=\"title\">Reporte de Horarios - Semana desde ${format(semanaData, \"d 'de' MMMM yyyy\", { locale: es })}</h2></div>`;\n\n  Object.keys(grupos).forEach(dept => {\n    html += `<div class=\"dept\"><strong>${dept}</strong></div>`;\n  html += `<table><thead><tr><th>Colaborador</th>`;\n  diasSemana.forEach(d => { html += `<th>${d}</th>`; });\n  html += `</tr></thead><tbody>`;\n    grupos[dept].forEach(u => {\n      html += `<tr><td>${u.nombre} ${u.apellidos}</td>`;\n      const semanaKey = (() => { const y = getYear(semanaData); const w = getISOWeek(semanaData); return `${y}-${w}`; })();\n      for (let i=1;i<=7;i++){\n        const diaKey = `dia${i}`;\n        const turno = registrosData[semanaKey] && registrosData[semanaKey][u.id] && registrosData[semanaKey][u.id][diaKey];\n        if (!turno) html += `<td>Sin horario</td>`;\n        else if (turno.tipo === 'descanso') html += `<td>Descanso</td>`;\n        else html += `<td>${turno.horaInicio} - ${turno.horaFin} (${(turno.horas||0).toFixed(1)}h)</td>`;\n      }\n      html += `</tr>`;\n    });\n    html += `</tbody></table>`;\n  });\n\n  html += `</body></html>`;\n\n  const w = window.open('', '_blank');\n  w.document.open();\n  w.document.write(html);\n  w.document.close();\n  setTimeout(() => { w.print(); }, 500);\n};\n\n"],"names":["departamentos","diasSemana","NO_SUMAN_HORAS","DIAS_LABELS","dia1","dia2","dia3","dia4","dia5","dia6","dia7","TIPO_LABEL","personalizado","teletrabajo","cambio","descanso","vacaciones","feriado","permiso","TIPOS_CONTRATO","OPERATIVO","CONFIANZA","ROLES","ADMINISTRADOR","MODIFICADOR","VISOR","HORAS_MAXIMAS_POR_TIPO","obtenerHorasMaximas","tipoContrato","obtenerMensajeRestriccionHoras","horasMaximas","concat","puedeModificarTipoContrato","usuario","departamento","puedeAsignarRoles","rol","email","puedeVerHorarios","objetivoUsuario","arguments","length","undefined","puedeAccederPersonal","obtenerColorRol","obtenerDescripcionRol","StyledPaper","styled","Paper","_ref","theme","padding","spacing","borderRadius","boxShadow","breakpoints","down","margin","StyledTableRow","TableRow","_ref2","backgroundColor","palette","action","hover","border","TimeCell","TableCell","_ref3","tipo","fontWeight","color","text","secondary","primary","ModalSugerencias","_ref5","open","onClose","usuarioInfractor","usuariosSugeridos","tipoInfraccion","detalleInfraccion","calcularHorasTotales","_jsxs","Dialog","fullWidth","maxWidth","children","_jsx","DialogTitle","DialogContent","DialogContentText","sx","mb","nombre","apellidos","Typography","variant","gutterBottom","_Fragment","mt","List","bgcolor","map","index","React","ListItem","alignItems","ListItemAvatar","Avatar","charAt","ListItemText","component","cargo","id","toFixed","Divider","DialogActions","Button","onClick","ConsultaHorarios","useTheme","isMobile","useMediaQuery","loading","setLoading","useState","usuarios","setUsuarios","horariosRegistros","setHorariosRegistros","semanaSeleccionada","setSemanaSeleccionada","startOfWeek","Date","weekStartsOn","departamentoSeleccionado","setDepartamentoSeleccionado","colaboradorSeleccionado","setColaboradorSeleccionado","expandidosPorUsuario","setExpandidosPorUsuario","anchorEl","setAnchorEl","yearSelected","setYearSelected","getYear","monthSelected","setMonthSelected","getMonth","datePickerOpen","setDatePickerOpen","sugerenciasModalOpen","setSugerenciasModalOpen","setUsuarioInfractor","setUsuariosSugeridos","setTipoInfraccion","setDetalleInfraccion","semanaKey","fecha","year","week","getISOWeek","obtenerClaveSemana","usuarioActual","auth","currentUser","find","u","uid","esAdministrador","useEffect","async","usuariosRef","ref","database","usuariosSnapshot","get","exists","usuariosData","val","usuariosArray","Object","entries","_ref4","data","_objectSpread","registrosRef","registrosSnapshot","registros","error","console","toast","message","cargarDatos","CustomDateSelector","daysInMonth","getDate","firstDayOfMonth","getDay","adjustedFirstDay","days","i","push","startIcon","CalendarTodayIcon","event","currentTarget","Popover","handleMenuClose","anchorOrigin","vertical","horizontal","transformOrigin","position","top","left","transform","maxHeight","zIndex","Box","p","width","display","justifyContent","IconButton","handlePrevMonth","size","ArrowBackIosNewIcon","fontSize","format","locale","es","handleNextMonth","ArrowForwardIosIcon","Grid","container","day","item","xs","align","Array","fill","_","minWidth","newDate","weekStart","handleDateSelect","usuariosFiltrados","filter","localStorage","setItem","JSON","stringify","toISOString","e","formatearHorario","horarioUsuario","diaKey","texto","turno","tipoTexto","teleInicio","horaInicioTele","teleFin","horaFinTele","presInicio","horaInicioPres","presFin","horaFinPres","horasTele","Number","isFinite","horasPres","total","horas","partes","textoPartes","join","horaInicio","horaFin","usuarioId","horariosUsuario","values","reduce","verificarDescansoEntreTurnos","tieneInfraccion","turnosLaborales","dia","turnoActual","turnoSiguiente","horaFinActual","minFinActual","split","horaInicioSiguiente","minInicioSiguiente","descansoEnHoras","detalle","verificarInfracciones","horasTotales","resultadoDescanso","abrirModalSugerencias","infraccion","sugerencias","usuariosValidos","departamentosAutorizados","isArray","includes","buscarUsuariosAlternativos","height","CircularProgress","Container","md","px","sm","textAlign","gap","GetAppIcon","exportToXLSX","PictureAsPdfIcon","exportToPDF","elevation","Stack","direction","retrocederSemana","nuevaSemana","subWeeks","avanzarSemana","addWeeks","FormControl","InputLabel","Select","labelId","value","label","onChange","target","MenuItem","depto","Autocomplete","options","getOptionLabel","option","renderInput","params","TextField","InputProps","endAdornment","SearchIcon","newValue","isOptionEqualToValue","addDays","my","_horariosRegistros$se","expandido","Card","overflow","CardHeader","avatar","PersonIcon","title","subheader","flexDirection","Chip","cursor","toggleExpandirUsuario","prev","ExpandLessIcon","ExpandMoreIcon","Collapse","in","timeout","unmountOnExit","CardContent","TableContainer","Table","TableHead","TableBody","horario","dense","divider","slice","cerrarModalSugerencias","usuariosLocal","parse","getItem","registrosLocal","semanaLocal","now","window","__usuarios_export__","registrosData","__registros_export__","semanaData","__semana_export__","y","w","rows","header","forEach","row","ws","XLSX","aoa_to_sheet","wch","wb","book_new","book_append_sheet","grupos","dept","html","keys","d","document","write","close","setTimeout","print"],"sourceRoot":""}